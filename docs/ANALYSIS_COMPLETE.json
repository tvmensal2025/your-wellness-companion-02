{
  "project_name": "MaxNutrition - Instituto dos Sonhos",
  "total_files": 16,
  "total_lines": 9244,
  "documents": {
    "01_ESTRUTURA_PROJETO.md": {
      "path": "docs/01_ESTRUTURA_PROJETO.md",
      "exists": true,
      "lines": 442,
      "size_kb": 13.5283203125,
      "content": "# ðŸ“ Estrutura do Projeto MaxNutrition\n\n> DocumentaÃ§Ã£o gerada em: 2026-01-16\n> Ãšltima atualizaÃ§Ã£o: Manual\n\n---\n\n## ðŸ“Š VisÃ£o Geral\n\n| MÃ©trica | Valor |\n|---------|-------|\n| **Total de Arquivos** | 1,114+ |\n| **Arquivos TypeScript (.ts)** | 362 |\n| **Arquivos React (.tsx)** | 746 |\n| **Componentes React** | 742 |\n| **Hooks Customizados** | 165 |\n| **Edge Functions** | 89 |\n| **PÃ¡ginas** | 27 |\n| **Tabelas no Banco** | 130+ |\n\n---\n\n## ðŸŒ³ Ãrvore de DiretÃ³rios Principal\n\n```\nmaxnutrition/\nâ”œâ”€â”€ ðŸ“ docs/                          # DocumentaÃ§Ã£o do projeto\nâ”‚   â”œâ”€â”€ ADRs/                         # Architecture Decision Records\nâ”‚   â”œâ”€â”€ AI_SYSTEMS.md                 # Sistema de IA\nâ”‚   â”œâ”€â”€ ARCHITECTURE.md               # Arquitetura geral\nâ”‚   â”œâ”€â”€ DATABASE_SCHEMA.md            # Schema do banco\nâ”‚   â”œâ”€â”€ EDGE_FUNCTIONS_CATALOG.md     # CatÃ¡logo de funÃ§Ãµes\nâ”‚   â””â”€â”€ ... (48 arquivos)\nâ”‚\nâ”œâ”€â”€ ðŸ“ public/                        # Assets pÃºblicos\nâ”‚   â”œâ”€â”€ icons/                        # Ãcones PWA\nâ”‚   â”œâ”€â”€ manifest.json                 # PWA manifest\nâ”‚   â””â”€â”€ favicon.ico\nâ”‚\nâ”œâ”€â”€ ðŸ“ src/                           # CÃ³digo fonte principal\nâ”‚   â”œâ”€â”€ ðŸ“ assets/                    # Assets estÃ¡ticos\nâ”‚   â”œâ”€â”€ ðŸ“ components/                # Componentes React (742)\nâ”‚   â”œâ”€â”€ ðŸ“ contexts/                  # React Contexts\nâ”‚   â”œâ”€â”€ ðŸ“ hooks/                     # Hooks customizados (165)\nâ”‚   â”œâ”€â”€ ðŸ“ integrations/              # IntegraÃ§Ãµes externas\nâ”‚   â”œâ”€â”€ ðŸ“ lib/                       # UtilitÃ¡rios\nâ”‚   â”œâ”€â”€ ðŸ“ pages/                     # PÃ¡ginas da aplicaÃ§Ã£o (27)\nâ”‚   â”œâ”€â”€ ðŸ“ services/                  # ServiÃ§os\nâ”‚   â”œâ”€â”€ ðŸ“ types/                     # DefiniÃ§Ãµes TypeScript\nâ”‚   â”œâ”€â”€ ðŸ“ utils/                     # FunÃ§Ãµes utilitÃ¡rias\nâ”‚   â”œâ”€â”€ App.tsx                       # Componente raiz\nâ”‚   â”œâ”€â”€ main.tsx                      # Entry point\nâ”‚   â””â”€â”€ index.css                     # Estilos globais\nâ”‚\nâ”œâ”€â”€ ðŸ“ supabase/                      # Backend Supabase\nâ”‚   â”œâ”€â”€ ðŸ“ functions/                 # Edge Functions (89)\nâ”‚   â”œâ”€â”€ ðŸ“ migrations/                # Migrations SQL\nâ”‚   â””â”€â”€ config.toml                   # ConfiguraÃ§Ã£o Supabase\nâ”‚\nâ”œâ”€â”€ ðŸ“„ package.json                   # DependÃªncias\nâ”œâ”€â”€ ðŸ“„ vite.config.ts                 # ConfiguraÃ§Ã£o Vite\nâ”œâ”€â”€ ðŸ“„ tailwind.config.ts             # ConfiguraÃ§Ã£o Tailwind\nâ”œâ”€â”€ ðŸ“„ tsconfig.json                  # ConfiguraÃ§Ã£o TypeScript\nâ””â”€â”€ ðŸ“„ capacitor.config.ts            # ConfiguraÃ§Ã£o Capacitor (mobile)\n```\n\n---\n\n## ðŸ“ src/components/ - Componentes React\n\n```\nsrc/components/\nâ”œâ”€â”€ ðŸ“ abundance/                # Mapeamento de abundÃ¢ncia\nâ”œâ”€â”€ ðŸ“ admin/                    # Painel administrativo\nâ”‚   â”œâ”€â”€ AIConfigPanel.tsx\nâ”‚   â”œâ”€â”€ AdminDashboard.tsx\nâ”‚   â”œâ”€â”€ UserManagement.tsx\nâ”‚   â””â”€â”€ SystemHealth.tsx\nâ”‚\nâ”œâ”€â”€ ðŸ“ analysis/                 # Componentes de anÃ¡lise\nâ”œâ”€â”€ ðŸ“ branding/                 # Elementos de marca\nâ”œâ”€â”€ ðŸ“ camera-workout/           # ExercÃ­cios com cÃ¢mera\nâ”œâ”€â”€ ðŸ“ cardio/                   # Treinos cardio\nâ”œâ”€â”€ ðŸ“ challenges-v2/            # Sistema de desafios v2\nâ”œâ”€â”€ ðŸ“ character-selector/       # Seletor de personagem\nâ”œâ”€â”€ ðŸ“ charts/                   # GrÃ¡ficos e visualizaÃ§Ãµes\nâ”œâ”€â”€ ðŸ“ chat/                     # Chat genÃ©rico\nâ”œâ”€â”€ ðŸ“ common/                   # Componentes compartilhados\nâ”œâ”€â”€ ðŸ“ community/                # Funcionalidades sociais\nâ”œâ”€â”€ ðŸ“ competency/               # Sistema de competÃªncias\nâ”œâ”€â”€ ðŸ“ daily-missions/           # MissÃµes diÃ¡rias\nâ”œâ”€â”€ ðŸ“ dashboard/                # Dashboard principal\nâ”‚   â”œâ”€â”€ DashboardHeader.tsx\nâ”‚   â”œâ”€â”€ QuickActions.tsx\nâ”‚   â”œâ”€â”€ StatsCards.tsx\nâ”‚   â””â”€â”€ HealthScore.tsx\nâ”‚\nâ”œâ”€â”€ ðŸ“ dr-vital/                 # Dr. Vital (IA mÃ©dica)\nâ”‚   â”œâ”€â”€ DrVitalChat.tsx\nâ”‚   â”œâ”€â”€ ExamAnalysis.tsx\nâ”‚   â”œâ”€â”€ ExamHistory.tsx\nâ”‚   â””â”€â”€ ReportGenerator.tsx\nâ”‚\nâ”œâ”€â”€ ðŸ“ evaluation/               # AvaliaÃ§Ãµes\nâ”œâ”€â”€ ðŸ“ exercise/                 # Sistema de exercÃ­cios\nâ”‚   â”œâ”€â”€ saved-program/           # Programas salvos\nâ”‚   â”œâ”€â”€ unified-timer/           # Timer unificado\nâ”‚   â”œâ”€â”€ workout/                 # Treino ativo\nâ”‚   â”œâ”€â”€ ExerciseLibrary.tsx\nâ”‚   â””â”€â”€ ExerciseCard.tsx\nâ”‚\nâ”œâ”€â”€ ðŸ“ gamification/             # Sistema de gamificaÃ§Ã£o\nâ”‚   â”œâ”€â”€ BadgeSystem.tsx\nâ”‚   â”œâ”€â”€ LevelProgress.tsx\nâ”‚   â”œâ”€â”€ PointsDisplay.tsx\nâ”‚   â”œâ”€â”€ StreakCounter.tsx\nâ”‚   â””â”€â”€ XPBar.tsx\nâ”‚\nâ”œâ”€â”€ ðŸ“ goals/                    # Sistema de metas\nâ”œâ”€â”€ ðŸ“ google-fit/               # IntegraÃ§Ã£o Google Fit\nâ”œâ”€â”€ ðŸ“ health-feed/              # Feed de saÃºde social\nâ”œâ”€â”€ ðŸ“ meal-plan/                # Planejamento de refeiÃ§Ãµes\nâ”œâ”€â”€ ðŸ“ medical/                  # Componentes mÃ©dicos\nâ”œâ”€â”€ ðŸ“ mobile/                   # Componentes mobile-first\nâ”œâ”€â”€ ðŸ“ navigation/               # NavegaÃ§Ã£o\nâ”‚   â”œâ”€â”€ BottomNavigation.tsx\nâ”‚   â”œâ”€â”€ MobileHeader.tsx\nâ”‚   â””â”€â”€ Breadcrumbs.tsx\nâ”‚\nâ”œâ”€â”€ ðŸ“ nutrition-tracking/       # Tracking nutricional\nâ”œâ”€â”€ ðŸ“ nutrition/                # NutriÃ§Ã£o geral\nâ”œâ”€â”€ ðŸ“ onboarding/               # Fluxo de onboarding\nâ”œâ”€â”€ ðŸ“ production/               # Componentes de produÃ§Ã£o\nâ”œâ”€â”€ ðŸ“ profile/                  # Perfil do usuÃ¡rio\nâ”œâ”€â”€ ðŸ“ progress/                 # Progresso e evoluÃ§Ã£o\nâ”œâ”€â”€ ðŸ“ pwa/                      # PWA especÃ­ficos\nâ”œâ”€â”€ ðŸ“ ranking/                  # Sistema de ranking\nâ”œâ”€â”€ ðŸ“ saboteur-test/            # Teste do sabotador\nâ”œâ”€â”€ ðŸ“ session-tools/            # Ferramentas de sessÃ£o\nâ”œâ”€â”€ ðŸ“ sessions/                 # Gerenciamento de sessÃµes\nâ”œâ”€â”€ ðŸ“ settings/                 # ConfiguraÃ§Ãµes\nâ”œâ”€â”€ ðŸ“ shared/                   # Componentes compartilhados\nâ”œâ”€â”€ ðŸ“ sidebar/                  # Sidebar lateral\nâ”œâ”€â”€ ðŸ“ sofia/                    # Sofia (IA nutricionista)\nâ”‚   â”œâ”€â”€ SofiaChat.tsx\nâ”‚   â”œâ”€â”€ SofiaImageAnalysis.tsx\nâ”‚   â”œâ”€â”€ SofiaFoodHistory.tsx\nâ”‚   â””â”€â”€ SofiaSuggestions.tsx\nâ”‚\nâ”œâ”€â”€ ðŸ“ theme/                    # Tema e estilizaÃ§Ã£o\nâ”œâ”€â”€ ðŸ“ tracking/                 # Tracking geral\nâ”œâ”€â”€ ðŸ“ ui/                       # UI Base (shadcn/ui)\nâ”‚   â”œâ”€â”€ button.tsx\nâ”‚   â”œâ”€â”€ card.tsx\nâ”‚   â”œâ”€â”€ dialog.tsx\nâ”‚   â”œâ”€â”€ input.tsx\nâ”‚   â”œâ”€â”€ select.tsx\nâ”‚   â””â”€â”€ ... (50+ componentes)\nâ”‚\nâ”œâ”€â”€ ðŸ“ user-history/             # HistÃ³rico do usuÃ¡rio\nâ”œâ”€â”€ ðŸ“ user/                     # Componentes de usuÃ¡rio\nâ”œâ”€â”€ ðŸ“ weekly-report/            # RelatÃ³rio semanal\nâ”œâ”€â”€ ðŸ“ weighing/                 # Pesagem\nâ”œâ”€â”€ ðŸ“ wheel/                    # Roda de escolhas\nâ”‚\nâ””â”€â”€ ðŸ“„ [Componentes standalone]  # ~60 arquivos na raiz\n    â”œâ”€â”€ Dashboard.tsx\n    â”œâ”€â”€ AuthGuard.tsx\n    â”œâ”€â”€ OnboardingFlow.tsx\n    â””â”€â”€ ...\n```\n\n---\n\n## ðŸ“ src/hooks/ - Hooks Customizados\n\n```\nsrc/hooks/\nâ”œâ”€â”€ ðŸ“ __tests__/                # Testes de hooks\nâ”œâ”€â”€ ðŸ“ camera-workout/           # Hooks de cÃ¢mera\nâ”œâ”€â”€ ðŸ“ cardio/                   # Hooks de cardio\nâ”œâ”€â”€ ðŸ“ challenges/               # Hooks de desafios\nâ”œâ”€â”€ ðŸ“ community/                # Hooks da comunidade\nâ”œâ”€â”€ ðŸ“ core/                     # Hooks fundamentais\nâ”œâ”€â”€ ðŸ“ dr-vital/                 # Hooks do Dr. Vital\nâ”œâ”€â”€ ðŸ“ exercise/                 # Hooks de exercÃ­cios\nâ”œâ”€â”€ ðŸ“ gamification/             # Hooks de gamificaÃ§Ã£o\nâ”‚\nâ”œâ”€â”€ ðŸ“„ useAuth.ts                # AutenticaÃ§Ã£o\nâ”œâ”€â”€ ðŸ“„ useAdminMode.ts           # Modo admin\nâ”œâ”€â”€ ðŸ“„ useAdminPermissions.ts    # PermissÃµes admin\nâ”œâ”€â”€ ðŸ“„ useUserProfile.ts         # Perfil do usuÃ¡rio\nâ”œâ”€â”€ ðŸ“„ useGamificationUnified.ts # GamificaÃ§Ã£o unificada\nâ”œâ”€â”€ ðŸ“„ useRealRanking.ts         # Ranking real\nâ”œâ”€â”€ ðŸ“„ useChallenges.ts          # Desafios\nâ”œâ”€â”€ ðŸ“„ useSofiaAnalysis.ts       # AnÃ¡lise Sofia\nâ”œâ”€â”€ ðŸ“„ useNutritionData.ts       # Dados nutricionais\nâ”œâ”€â”€ ðŸ“„ useGoogleFitData.ts       # Dados Google Fit\nâ”œâ”€â”€ ðŸ“„ useTrackingData.ts        # Dados de tracking\nâ”œâ”€â”€ ðŸ“„ useDailyMissions.ts       # MissÃµes diÃ¡rias\nâ”œâ”€â”€ ðŸ“„ useExerciseProgram.ts     # Programa de exercÃ­cios\nâ”œâ”€â”€ ðŸ“„ useHealthScore.ts         # Score de saÃºde\nâ””â”€â”€ ðŸ“„ ... (130+ hooks)\n```\n\n---\n\n## ðŸ“ src/pages/ - PÃ¡ginas da AplicaÃ§Ã£o\n\n```\nsrc/pages/\nâ”œâ”€â”€ ðŸ“ admin/                    # PÃ¡ginas administrativas\nâ”‚   â”œâ”€â”€ AdminDashboardPage.tsx\nâ”‚   â”œâ”€â”€ AIConfigPage.tsx\nâ”‚   â”œâ”€â”€ SystemHealthPage.tsx\nâ”‚   â””â”€â”€ UserManagementPage.tsx\nâ”‚\nâ”œâ”€â”€ ðŸ“„ AdminPage.tsx             # Painel admin principal\nâ”œâ”€â”€ ðŸ“„ AnamnesisPage.tsx         # Anamnese\nâ”œâ”€â”€ ðŸ“„ AuthPage.tsx              # AutenticaÃ§Ã£o\nâ”œâ”€â”€ ðŸ“„ AutoLoginPage.tsx         # Login automÃ¡tico\nâ”œâ”€â”€ ðŸ“„ ChallengeDetailPage.tsx   # Detalhe de desafio\nâ”œâ”€â”€ ðŸ“„ ChallengesV2Page.tsx      # Desafios v2\nâ”œâ”€â”€ ðŸ“„ DrVitalEnhancedPage.tsx   # Dr. Vital melhorado\nâ”œâ”€â”€ ðŸ“„ GoalsPage.tsx             # Metas\nâ”œâ”€â”€ ðŸ“„ GoalsPageV2.tsx           # Metas v2\nâ”œâ”€â”€ ðŸ“„ GoogleFitCallback.tsx     # Callback OAuth\nâ”œâ”€â”€ ðŸ“„ GoogleFitPage.tsx         # Google Fit\nâ”œâ”€â”€ ðŸ“„ GoogleFitPremiumDashboard.tsx # Dashboard premium\nâ”œâ”€â”€ ðŸ“„ GoogleFitTestPage.tsx     # Teste Google Fit\nâ”œâ”€â”€ ðŸ“„ HealthFeedPage.tsx        # Feed social\nâ”œâ”€â”€ ðŸ“„ Install.tsx               # InstalaÃ§Ã£o PWA\nâ”œâ”€â”€ ðŸ“„ MissionCompletePage.tsx   # MissÃ£o completa\nâ”œâ”€â”€ ðŸ“„ NotFound.tsx              # 404\nâ”œâ”€â”€ ðŸ“„ NutritionTrackingPage.tsx # Tracking nutricional\nâ”œâ”€â”€ ðŸ“„ ProfessionalEvaluationPage.tsx # AvaliaÃ§Ã£o\nâ”œâ”€â”€ ðŸ“„ ProgressPage.tsx          # Progresso\nâ”œâ”€â”€ ðŸ“„ PublicPostPage.tsx        # Post pÃºblico\nâ”œâ”€â”€ ðŸ“„ PublicReport.tsx          # RelatÃ³rio pÃºblico\nâ”œâ”€â”€ ðŸ“„ SofiaNutricionalPage.tsx  # Sofia nutricional\nâ”œâ”€â”€ ðŸ“„ SofiaPage.tsx             # Sofia principal\nâ”œâ”€â”€ ðŸ“„ TermsPage.tsx             # Termos\nâ””â”€â”€ ðŸ“„ UserDrVitalPage.tsx       # Dr. Vital do usuÃ¡rio\n```\n\n---\n\n## ðŸ“ supabase/functions/ - Edge Functions\n\n```\nsupabase/functions/\nâ”œâ”€â”€ ðŸ“ _shared/                  # CÃ³digo compartilhado\nâ”‚   â”œâ”€â”€ cors.ts\nâ”‚   â”œâ”€â”€ supabase-client.ts\nâ”‚   â””â”€â”€ utils/\nâ”‚       â”œâ”€â”€ image-cache.ts       # Cache de imagens\nâ”‚       â””â”€â”€ ai-helpers.ts        # Helpers de IA\nâ”‚\nâ”œâ”€â”€ ðŸ“ sofia-image-analysis/     # AnÃ¡lise de imagens (YOLO+Gemini)\nâ”œâ”€â”€ ðŸ“ analyze-medical-exam/     # AnÃ¡lise de exames mÃ©dicos\nâ”œâ”€â”€ ðŸ“ dr-vital-chat/            # Chat Dr. Vital\nâ”œâ”€â”€ ðŸ“ dr-vital-enhanced/        # Dr. Vital melhorado\nâ”œâ”€â”€ ðŸ“ dr-vital-weekly-report/   # RelatÃ³rio semanal\nâ”œâ”€â”€ ðŸ“ food-analysis/            # AnÃ¡lise de alimentos\nâ”œâ”€â”€ ðŸ“ generate-meal-plan-taco/  # GeraÃ§Ã£o de cardÃ¡pio\nâ”œâ”€â”€ ðŸ“ nutrition-calc/           # CÃ¡lculo nutricional\nâ”œâ”€â”€ ðŸ“ nutrition-daily-summary/  # Resumo diÃ¡rio\nâ”‚\nâ”œâ”€â”€ ðŸ“ whatsapp-webhook-unified/ # Webhook WhatsApp\nâ”œâ”€â”€ ðŸ“ whatsapp-ai-assistant/    # Assistente WhatsApp\nâ”œâ”€â”€ ðŸ“ whatsapp-weekly-report/   # RelatÃ³rio WhatsApp\nâ”œâ”€â”€ ðŸ“ whatsapp-daily-motivation/# MotivaÃ§Ã£o diÃ¡ria\nâ”œâ”€â”€ ðŸ“ whatsapp-goal-reminders/  # Lembretes de metas\nâ”‚\nâ”œâ”€â”€ ðŸ“ google-fit-sync/          # SincronizaÃ§Ã£o Google Fit\nâ”œâ”€â”€ ðŸ“ google-fit-callback/      # Callback OAuth\nâ”œâ”€â”€ ðŸ“ google-fit-token/         # Gerenciamento de tokens\nâ”œâ”€â”€ ðŸ“ google-fit-ai-analysis/   # AnÃ¡lise IA dos dados\nâ”‚\nâ”œâ”€â”€ ðŸ“ generate-medical-pdf/     # GeraÃ§Ã£o de PDF mÃ©dico\nâ”œâ”€â”€ ðŸ“ generate-medical-report/  # RelatÃ³rio mÃ©dico\nâ”œâ”€â”€ ðŸ“ premium-medical-report/   # RelatÃ³rio premium\nâ”‚\nâ”œâ”€â”€ ðŸ“ goal-notifications/       # NotificaÃ§Ãµes de metas\nâ”œâ”€â”€ ðŸ“ send-email/               # Envio de emails\nâ”œâ”€â”€ ðŸ“ media-upload/             # Upload de mÃ­dia\nâ”‚\nâ””â”€â”€ ðŸ“ ... (60+ outras functions)\n```\n\n---\n\n## ðŸ“„ Arquivos de ConfiguraÃ§Ã£o\n\n### package.json - DependÃªncias Principais\n\n```json\n{\n  \"dependencies\": {\n    // Core\n    \"react\": \"^18.3.1\",\n    \"react-dom\": \"^18.3.1\",\n    \"react-router-dom\": \"^7.7.1\",\n    \n    // State & Data\n    \"@tanstack/react-query\": \"^5.56.2\",\n    \"@supabase/supabase-js\": \"^2.89.0\",\n    \n    // UI Components\n    \"@radix-ui/react-*\": \"^1.x\",\n    \"lucide-react\": \"^0.462.0\",\n    \"framer-motion\": \"^12.23.9\",\n    \n    // Forms\n    \"react-hook-form\": \"^7.53.0\",\n    \"@hookform/resolvers\": \"^3.9.0\",\n    \"zod\": \"^3.23.8\",\n    \n    // Charts\n    \"recharts\": \"^3.1.0\",\n    \"apexcharts\": \"^5.3.2\",\n    \"react-apexcharts\": \"^1.7.0\",\n    \n    // Mobile\n    \"@capacitor/core\": \"^8.0.0\",\n    \"@capacitor/camera\": \"^8.0.0\",\n    \"@capacitor/haptics\": \"^8.0.0\",\n    \n    // Utilities\n    \"date-fns\": \"^4.1.0\",\n    \"class-variance-authority\": \"^0.7.1\",\n    \"tailwind-merge\": \"^2.5.2\"\n  }\n}\n```\n\n### vite.config.ts\n\n```typescript\nexport default defineConfig({\n  plugins: [react()],\n  resolve: {\n    alias: {\n      \"@\": path.resolve(__dirname, \"./src\"),\n    },\n  },\n  build: {\n    rollupOptions: {\n      output: {\n        manualChunks: {\n          vendor: ['react', 'react-dom'],\n          charts: ['recharts', 'apexcharts'],\n          ui: ['@radix-ui/react-*'],\n        },\n      },\n    },\n  },\n});\n```\n\n### tailwind.config.ts\n\n```typescript\nexport default {\n  darkMode: [\"class\"],\n  content: [\"./index.html\", \"./src/**/*.{ts,tsx}\"],\n  theme: {\n    extend: {\n      colors: {\n        // Design tokens semÃ¢nticos\n        background: \"hsl(var(--background))\",\n        foreground: \"hsl(var(--foreground))\",\n        primary: \"hsl(var(--primary))\",\n        secondary: \"hsl(var(--secondary))\",\n        muted: \"hsl(var(--muted))\",\n        accent: \"hsl(var(--accent))\",\n        destructive: \"hsl(var(--destructive))\",\n      },\n    },\n  },\n  plugins: [require(\"tailwindcss-animate\")],\n};\n```\n\n---\n\n## ðŸ“Š DistribuiÃ§Ã£o de Arquivos por Tipo\n\n| Tipo | Quantidade | % do Total |\n|------|------------|------------|\n| `.tsx` (React) | 746 | 67% |\n| `.ts` (TypeScript) | 362 | 32.5% |\n| `.css` | 3 | 0.3% |\n| `.json` | 3 | 0.2% |\n\n---\n\n## ðŸ”— Relacionamentos entre DiretÃ³rios\n\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚   src/pages/    â”‚ â† PÃ¡ginas da aplicaÃ§Ã£o\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n         â”‚ importa\n         â–¼\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚ src/components/ â”‚ â† Componentes React\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n         â”‚ usa\n         â–¼\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚   src/hooks/    â”‚ â† LÃ³gica de negÃ³cio\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n         â”‚ chama\n         â–¼\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚ supabase/       â”‚ â† Backend (Edge Functions + DB)\nâ”‚ functions/      â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n---\n\n## ðŸ“ ConvenÃ§Ãµes de Nomenclatura\n\n| Tipo | ConvenÃ§Ã£o | Exemplo |\n|------|-----------|---------|\n| Componentes | PascalCase | `UserProfile.tsx` |\n| Hooks | camelCase com \"use\" | `useAuth.ts` |\n| PÃ¡ginas | PascalCase + \"Page\" | `AdminPage.tsx` |\n| Edge Functions | kebab-case | `sofia-image-analysis/` |\n| UtilitÃ¡rios | camelCase | `formatDate.ts` |\n| Tipos | PascalCase | `UserProfile` interface |\n\n---\n\n## ðŸŽ¯ PrÃ³ximos Passos\n\n- Consulte `02_DATABASE_SCHEMA.md` para detalhes do banco de dados\n- Consulte `03_COMPONENTS_CATALOG.md` para documentaÃ§Ã£o de componentes\n- Consulte `05_EDGE_FUNCTIONS.md` para APIs backend\n",
      "sections": [
        "# ðŸ“ Estrutura do Projeto MaxNutrition",
        "## ðŸ“Š VisÃ£o Geral",
        "## ðŸŒ³ Ãrvore de DiretÃ³rios Principal",
        "## ðŸ“ src/components/ - Componentes React",
        "## ðŸ“ src/hooks/ - Hooks Customizados",
        "## ðŸ“ src/pages/ - PÃ¡ginas da AplicaÃ§Ã£o",
        "## ðŸ“ supabase/functions/ - Edge Functions",
        "## ðŸ“„ Arquivos de ConfiguraÃ§Ã£o",
        "### package.json - DependÃªncias Principais",
        "### vite.config.ts",
        "### tailwind.config.ts",
        "## ðŸ“Š DistribuiÃ§Ã£o de Arquivos por Tipo",
        "## ðŸ”— Relacionamentos entre DiretÃ³rios",
        "## ðŸ“ ConvenÃ§Ãµes de Nomenclatura",
        "## ðŸŽ¯ PrÃ³ximos Passos"
      ],
      "code_blocks": 18,
      "links": []
    },
    "02_DATABASE_SCHEMA.md": {
      "path": "docs/02_DATABASE_SCHEMA.md",
      "exists": true,
      "lines": 841,
      "size_kb": 25.708984375,
      "content": "# ðŸ—„ï¸ Schema do Banco de Dados MaxNutrition\n\n> DocumentaÃ§Ã£o gerada em: 2026-01-16\n> Backend: MaxNutrition Cloud (Supabase)\n\n---\n\n## ðŸ“Š VisÃ£o Geral\n\n| MÃ©trica | Valor |\n|---------|-------|\n| **Total de Tabelas** | 130+ |\n| **FunÃ§Ãµes RPC** | 50+ |\n| **Storage Buckets** | 8 |\n| **RLS Policies** | 200+ |\n\n---\n\n## ðŸ“‘ Ãndice de Tabelas por Categoria\n\n1. [UsuÃ¡rios e Perfis](#1-usuÃ¡rios-e-perfis)\n2. [GamificaÃ§Ã£o](#2-gamificaÃ§Ã£o)\n3. [NutriÃ§Ã£o e Sofia](#3-nutriÃ§Ã£o-e-sofia)\n4. [SaÃºde e MÃ©dico](#4-saÃºde-e-mÃ©dico)\n5. [ExercÃ­cios](#5-exercÃ­cios)\n6. [Social/Comunidade](#6-socialcomunidade)\n7. [ConfiguraÃ§Ãµes e Admin](#7-configuraÃ§Ãµes-e-admin)\n8. [Cache e Logs](#8-cache-e-logs)\n9. [IntegraÃ§Ãµes Externas](#9-integraÃ§Ãµes-externas)\n\n---\n\n## 1. UsuÃ¡rios e Perfis\n\n### `profiles`\nPerfil principal do usuÃ¡rio.\n\n| Coluna | Tipo | Nullable | Default | DescriÃ§Ã£o |\n|--------|------|----------|---------|-----------|\n| `id` | uuid | NO | gen_random_uuid() | PK |\n| `user_id` | uuid | NO | - | FK â†’ auth.users |\n| `full_name` | text | YES | - | Nome completo |\n| `avatar_url` | text | YES | - | URL do avatar |\n| `gender` | text | YES | - | GÃªnero |\n| `birth_date` | date | YES | - | Data nascimento |\n| `height_cm` | numeric | YES | - | Altura em cm |\n| `weight_kg` | numeric | YES | - | Peso em kg |\n| `target_weight_kg` | numeric | YES | - | Peso alvo |\n| `activity_level` | text | YES | - | NÃ­vel atividade |\n| `dietary_preference` | text | YES | - | PreferÃªncia alimentar |\n| `health_goals` | text[] | YES | - | Metas de saÃºde |\n| `onboarding_completed` | boolean | YES | false | Onboarding feito |\n| `is_admin` | boolean | YES | false | Ã‰ admin |\n| `admin_since` | timestamptz | YES | - | Admin desde |\n| `subscription_status` | text | YES | 'free' | Status assinatura |\n| `subscription_tier` | text | YES | 'free' | Tier |\n| `created_at` | timestamptz | YES | now() | Criado em |\n| `updated_at` | timestamptz | YES | now() | Atualizado em |\n\n**RLS Policies:**\n- SELECT: UsuÃ¡rios podem ver seu prÃ³prio perfil\n- INSERT: UsuÃ¡rios autenticados podem criar perfil\n- UPDATE: UsuÃ¡rios podem atualizar prÃ³prio perfil\n\n---\n\n### `user_anamnesis`\nAnamnese completa do usuÃ¡rio.\n\n| Coluna | Tipo | Nullable | DescriÃ§Ã£o |\n|--------|------|----------|-----------|\n| `id` | uuid | NO | PK |\n| `user_id` | uuid | NO | FK â†’ profiles |\n| `medical_conditions` | text[] | YES | CondiÃ§Ãµes mÃ©dicas |\n| `allergies` | text[] | YES | Alergias |\n| `medications` | text[] | YES | Medicamentos |\n| `physical_limitations` | text[] | YES | LimitaÃ§Ãµes fÃ­sicas |\n| `sleep_quality` | text | YES | Qualidade sono |\n| `stress_level` | text | YES | NÃ­vel estresse |\n| `exercise_frequency` | text | YES | FrequÃªncia exercÃ­cio |\n| `dietary_restrictions` | text[] | YES | RestriÃ§Ãµes alimentares |\n| `goals_description` | text | YES | DescriÃ§Ã£o das metas |\n| `created_at` | timestamptz | YES | Criado em |\n| `updated_at` | timestamptz | YES | Atualizado em |\n\n---\n\n### `user_preferences`\nPreferÃªncias do usuÃ¡rio no app.\n\n| Coluna | Tipo | Nullable | DescriÃ§Ã£o |\n|--------|------|----------|-----------|\n| `id` | uuid | NO | PK |\n| `user_id` | uuid | NO | FK |\n| `notification_enabled` | boolean | YES | NotificaÃ§Ãµes ativas |\n| `dark_mode` | boolean | YES | Modo escuro |\n| `language` | text | YES | Idioma |\n| `meal_reminder_times` | jsonb | YES | HorÃ¡rios lembrete |\n| `water_reminder_interval` | integer | YES | Intervalo Ã¡gua (min) |\n| `exercise_reminder_days` | text[] | YES | Dias lembrete exercÃ­cio |\n\n---\n\n## 2. GamificaÃ§Ã£o\n\n### `user_points`\nPontos e XP do usuÃ¡rio.\n\n| Coluna | Tipo | Nullable | Default | DescriÃ§Ã£o |\n|--------|------|----------|---------|-----------|\n| `id` | uuid | NO | gen_random_uuid() | PK |\n| `user_id` | uuid | NO | - | FK |\n| `total_points` | integer | YES | 0 | Pontos totais |\n| `xp_total` | integer | YES | 0 | XP total |\n| `level` | integer | YES | 1 | NÃ­vel atual |\n| `current_streak` | integer | YES | 0 | Streak atual |\n| `longest_streak` | integer | YES | 0 | Maior streak |\n| `last_activity_date` | date | YES | - | Ãšltima atividade |\n| `weekly_points` | integer | YES | 0 | Pontos semanais |\n| `monthly_points` | integer | YES | 0 | Pontos mensais |\n| `created_at` | timestamptz | YES | now() | Criado em |\n| `updated_at` | timestamptz | YES | now() | Atualizado em |\n\n**Ãndices:**\n- `idx_user_points_user_id` (user_id)\n- `idx_user_points_total` (total_points DESC)\n\n---\n\n### `challenges`\nDefiniÃ§Ã£o de desafios.\n\n| Coluna | Tipo | Nullable | DescriÃ§Ã£o |\n|--------|------|----------|-----------|\n| `id` | uuid | NO | PK |\n| `title` | text | NO | TÃ­tulo |\n| `description` | text | YES | DescriÃ§Ã£o |\n| `challenge_type` | text | YES | Tipo do desafio |\n| `target_value` | integer | YES | Valor alvo |\n| `target_unit` | text | YES | Unidade (passos, kcal) |\n| `xp_reward` | integer | YES | XP de recompensa |\n| `points_reward` | integer | YES | Pontos de recompensa |\n| `badge_reward` | text | YES | Badge de recompensa |\n| `start_date` | date | YES | Data inÃ­cio |\n| `end_date` | date | YES | Data fim |\n| `is_active` | boolean | YES | EstÃ¡ ativo |\n| `difficulty` | text | YES | Dificuldade |\n| `icon` | text | YES | Ãcone |\n| `color` | text | YES | Cor |\n| `created_at` | timestamptz | YES | Criado em |\n\n---\n\n### `challenge_participations`\nParticipaÃ§Ã£o em desafios.\n\n| Coluna | Tipo | Nullable | DescriÃ§Ã£o |\n|--------|------|----------|-----------|\n| `id` | uuid | NO | PK |\n| `challenge_id` | uuid | NO | FK â†’ challenges |\n| `user_id` | uuid | NO | FK |\n| `progress` | integer | YES | Progresso atual |\n| `target_value` | integer | YES | Valor alvo |\n| `is_completed` | boolean | YES | Completou |\n| `completed_at` | timestamptz | YES | Completou em |\n| `points_earned` | integer | YES | Pontos ganhos |\n| `current_streak` | integer | YES | Streak no desafio |\n| `started_at` | timestamptz | YES | Iniciou em |\n| `created_at` | timestamptz | YES | Criado em |\n| `updated_at` | timestamptz | YES | Atualizado em |\n\n---\n\n### `user_achievements_v2`\nConquistas do usuÃ¡rio.\n\n| Coluna | Tipo | Nullable | DescriÃ§Ã£o |\n|--------|------|----------|-----------|\n| `id` | uuid | NO | PK |\n| `user_id` | uuid | NO | FK |\n| `achievement_id` | text | NO | ID da conquista |\n| `achievement_name` | text | YES | Nome |\n| `achievement_description` | text | YES | DescriÃ§Ã£o |\n| `achievement_icon` | text | YES | Ãcone |\n| `category` | text | YES | Categoria |\n| `rarity` | text | YES | Raridade |\n| `xp_reward` | integer | YES | XP ganho |\n| `unlocked_at` | timestamptz | YES | Desbloqueado em |\n| `created_at` | timestamptz | YES | Criado em |\n\n---\n\n### `flash_challenges`\nDesafios relÃ¢mpago (curta duraÃ§Ã£o).\n\n| Coluna | Tipo | Nullable | DescriÃ§Ã£o |\n|--------|------|----------|-----------|\n| `id` | uuid | NO | PK |\n| `title` | text | NO | TÃ­tulo |\n| `description` | text | YES | DescriÃ§Ã£o |\n| `challenge_type` | text | NO | Tipo |\n| `target_value` | integer | NO | Valor alvo |\n| `xp_reward` | integer | YES | XP |\n| `duration_hours` | integer | YES | DuraÃ§Ã£o (horas) |\n| `starts_at` | timestamptz | NO | Inicia em |\n| `ends_at` | timestamptz | NO | Termina em |\n| `is_active` | boolean | YES | Ativo |\n| `emoji` | text | YES | Emoji |\n\n---\n\n### `daily_mission_sessions`\nSessÃµes de missÃµes diÃ¡rias.\n\n| Coluna | Tipo | Nullable | DescriÃ§Ã£o |\n|--------|------|----------|-----------|\n| `id` | uuid | NO | PK |\n| `user_id` | uuid | NO | FK |\n| `session_date` | date | NO | Data da sessÃ£o |\n| `missions_completed` | integer | YES | MissÃµes completas |\n| `total_points` | integer | YES | Pontos totais |\n| `streak_days` | integer | YES | Dias de streak |\n| `completed_sections` | jsonb | YES | SeÃ§Ãµes completadas |\n| `is_completed` | boolean | YES | SessÃ£o completa |\n| `created_at` | timestamptz | YES | Criado em |\n\n---\n\n## 3. NutriÃ§Ã£o e Sofia\n\n### `food_history`\nHistÃ³rico de refeiÃ§Ãµes.\n\n| Coluna | Tipo | Nullable | DescriÃ§Ã£o |\n|--------|------|----------|-----------|\n| `id` | uuid | NO | PK |\n| `user_id` | uuid | NO | FK |\n| `meal_date` | date | NO | Data da refeiÃ§Ã£o |\n| `meal_type` | text | YES | Tipo (cafÃ©, almoÃ§o, etc) |\n| `meal_time` | time | YES | HorÃ¡rio |\n| `food_items` | jsonb | YES | Itens alimentares |\n| `total_calories` | integer | YES | Calorias totais |\n| `total_proteins` | numeric | YES | ProteÃ­nas (g) |\n| `total_carbs` | numeric | YES | Carboidratos (g) |\n| `total_fats` | numeric | YES | Gorduras (g) |\n| `total_fiber` | numeric | YES | Fibras (g) |\n| `photo_url` | text | YES | URL da foto |\n| `ai_analysis` | text | YES | AnÃ¡lise IA |\n| `confidence_score` | numeric | YES | ConfianÃ§a anÃ¡lise |\n| `user_confirmed` | boolean | YES | Confirmado usuÃ¡rio |\n| `source` | text | YES | Fonte (manual, sofia) |\n| `created_at` | timestamptz | YES | Criado em |\n| `deleted_at` | timestamptz | YES | Deletado em (soft) |\n\n---\n\n### `sofia_memory`\nMemÃ³ria da Sofia para contexto.\n\n| Coluna | Tipo | Nullable | DescriÃ§Ã£o |\n|--------|------|----------|-----------|\n| `id` | uuid | NO | PK |\n| `user_id` | uuid | NO | FK |\n| `memory_type` | text | YES | Tipo de memÃ³ria |\n| `content` | text | YES | ConteÃºdo |\n| `importance` | integer | YES | ImportÃ¢ncia (1-10) |\n| `context` | jsonb | YES | Contexto adicional |\n| `last_accessed` | timestamptz | YES | Ãšltimo acesso |\n| `access_count` | integer | YES | Contagem acessos |\n| `created_at` | timestamptz | YES | Criado em |\n\n---\n\n### `sofia_learning`\nAprendizado da Sofia sobre o usuÃ¡rio.\n\n| Coluna | Tipo | Nullable | DescriÃ§Ã£o |\n|--------|------|----------|-----------|\n| `id` | uuid | NO | PK |\n| `user_id` | uuid | NO | FK |\n| `learning_type` | text | YES | Tipo aprendizado |\n| `key` | text | YES | Chave |\n| `value` | jsonb | YES | Valor |\n| `confidence` | numeric | YES | ConfianÃ§a |\n| `source` | text | YES | Fonte |\n| `created_at` | timestamptz | YES | Criado em |\n| `updated_at` | timestamptz | YES | Atualizado em |\n\n---\n\n### `meal_plans`\nPlanos de refeiÃ§Ã£o.\n\n| Coluna | Tipo | Nullable | DescriÃ§Ã£o |\n|--------|------|----------|-----------|\n| `id` | uuid | NO | PK |\n| `user_id` | uuid | NO | FK |\n| `plan_name` | text | YES | Nome do plano |\n| `plan_type` | text | YES | Tipo (semanal, diÃ¡rio) |\n| `start_date` | date | YES | Data inÃ­cio |\n| `end_date` | date | YES | Data fim |\n| `meals` | jsonb | NO | RefeiÃ§Ãµes estruturadas |\n| `total_daily_calories` | integer | YES | Calorias diÃ¡rias |\n| `macros_target` | jsonb | YES | Metas de macros |\n| `restrictions_applied` | text[] | YES | RestriÃ§Ãµes aplicadas |\n| `is_active` | boolean | YES | Ativo |\n| `created_by` | text | YES | Criado por (sofia, manual) |\n| `created_at` | timestamptz | YES | Criado em |\n\n---\n\n### `nutrition_tracking`\nTracking diÃ¡rio de nutriÃ§Ã£o.\n\n| Coluna | Tipo | Nullable | DescriÃ§Ã£o |\n|--------|------|----------|-----------|\n| `id` | uuid | NO | PK |\n| `user_id` | uuid | NO | FK |\n| `tracking_date` | date | NO | Data |\n| `calories_consumed` | integer | YES | Calorias consumidas |\n| `calories_goal` | integer | YES | Meta calorias |\n| `protein_consumed` | numeric | YES | ProteÃ­na (g) |\n| `protein_goal` | numeric | YES | Meta proteÃ­na |\n| `carbs_consumed` | numeric | YES | Carbs (g) |\n| `carbs_goal` | numeric | YES | Meta carbs |\n| `fat_consumed` | numeric | YES | Gordura (g) |\n| `fat_goal` | numeric | YES | Meta gordura |\n| `water_ml` | integer | YES | Ãgua (ml) |\n| `water_goal` | integer | YES | Meta Ã¡gua |\n| `created_at` | timestamptz | YES | Criado em |\n| `updated_at` | timestamptz | YES | Atualizado em |\n\n---\n\n## 4. SaÃºde e MÃ©dico\n\n### `medical_exam_analyses`\nAnÃ¡lises de exames mÃ©dicos.\n\n| Coluna | Tipo | Nullable | DescriÃ§Ã£o |\n|--------|------|----------|-----------|\n| `id` | uuid | NO | PK |\n| `user_id` | uuid | NO | FK |\n| `exam_type` | text | YES | Tipo do exame |\n| `exam_date` | date | YES | Data do exame |\n| `file_url` | text | YES | URL do arquivo |\n| `file_type` | text | YES | Tipo arquivo (pdf, img) |\n| `extracted_text` | text | YES | Texto extraÃ­do (OCR) |\n| `extracted_data` | jsonb | YES | Dados estruturados |\n| `ai_interpretation` | text | YES | InterpretaÃ§Ã£o IA |\n| `health_indicators` | jsonb | YES | Indicadores de saÃºde |\n| `recommendations` | text[] | YES | RecomendaÃ§Ãµes |\n| `risk_level` | text | YES | NÃ­vel de risco |\n| `processing_status` | text | YES | Status processamento |\n| `processing_error` | text | YES | Erro se houver |\n| `created_at` | timestamptz | YES | Criado em |\n| `updated_at` | timestamptz | YES | Atualizado em |\n\n---\n\n### `google_fit_data`\nDados do Google Fit.\n\n| Coluna | Tipo | Nullable | DescriÃ§Ã£o |\n|--------|------|----------|-----------|\n| `id` | uuid | NO | PK |\n| `user_id` | uuid | NO | FK |\n| `date` | date | NO | Data |\n| `steps` | integer | YES | Passos |\n| `calories` | integer | YES | Calorias |\n| `distance_meters` | numeric | YES | DistÃ¢ncia (m) |\n| `active_minutes` | integer | YES | Minutos ativos |\n| `heart_rate_avg` | integer | YES | FC mÃ©dia |\n| `heart_rate_max` | integer | YES | FC mÃ¡xima |\n| `heart_rate_min` | integer | YES | FC mÃ­nima |\n| `sleep_hours` | numeric | YES | Horas sono |\n| `sleep_quality` | text | YES | Qualidade sono |\n| `weight_kg` | numeric | YES | Peso (kg) |\n| `body_fat_percentage` | numeric | YES | % gordura |\n| `raw_data` | jsonb | YES | Dados brutos |\n| `sync_timestamp` | timestamptz | YES | Timestamp sync |\n| `created_at` | timestamptz | YES | Criado em |\n\n**Unique Constraint:** (user_id, date)\n\n---\n\n### `health_diary`\nDiÃ¡rio de saÃºde.\n\n| Coluna | Tipo | Nullable | DescriÃ§Ã£o |\n|--------|------|----------|-----------|\n| `id` | uuid | NO | PK |\n| `user_id` | uuid | NO | FK |\n| `date` | date | NO | Data |\n| `mood_rating` | integer | YES | Humor (1-10) |\n| `energy_level` | integer | YES | Energia (1-10) |\n| `sleep_hours` | numeric | YES | Horas sono |\n| `water_intake` | integer | YES | Ãgua (ml) |\n| `exercise_minutes` | integer | YES | ExercÃ­cio (min) |\n| `notes` | text | YES | Notas |\n| `created_at` | timestamptz | NO | Criado em |\n\n---\n\n### `advanced_daily_tracking`\nTracking diÃ¡rio avanÃ§ado.\n\n| Coluna | Tipo | Nullable | DescriÃ§Ã£o |\n|--------|------|----------|-----------|\n| `id` | uuid | NO | PK |\n| `user_id` | uuid | NO | FK |\n| `tracking_date` | date | YES | Data |\n| `weight_kg` | numeric | YES | Peso |\n| `body_fat_percentage` | numeric | YES | % gordura |\n| `waist_cm` | numeric | YES | Cintura (cm) |\n| `sleep_hours` | numeric | YES | Horas sono |\n| `sleep_quality` | integer | YES | Qualidade sono |\n| `mood_rating` | integer | YES | Humor |\n| `stress_level` | integer | YES | Estresse |\n| `energy_level` | integer | YES | Energia |\n| `steps` | integer | YES | Passos |\n| `calories_consumed` | integer | YES | Calorias |\n| `water_ml` | integer | YES | Ãgua |\n| `exercise_duration_minutes` | integer | YES | ExercÃ­cio |\n| `notes` | text | YES | Notas |\n| `photo_url` | text | YES | Foto progresso |\n| `symptoms` | text[] | YES | Sintomas |\n| `medications_taken` | text[] | YES | Medicamentos |\n| `created_at` | timestamptz | YES | Criado em |\n| `updated_at` | timestamptz | YES | Atualizado em |\n\n---\n\n## 5. ExercÃ­cios\n\n### `exercises_library`\nBiblioteca de exercÃ­cios.\n\n| Coluna | Tipo | Nullable | DescriÃ§Ã£o |\n|--------|------|----------|-----------|\n| `id` | uuid | NO | PK |\n| `name` | text | NO | Nome |\n| `description` | text | YES | DescriÃ§Ã£o |\n| `muscle_group` | text | YES | Grupo muscular |\n| `location` | text | NO | Local (casa, academia) |\n| `difficulty` | text | YES | Dificuldade |\n| `equipment_needed` | text[] | YES | Equipamentos |\n| `instructions` | text[] | YES | InstruÃ§Ãµes |\n| `tips` | text | YES | Dicas |\n| `sets` | text | YES | SÃ©ries |\n| `reps` | text | YES | RepetiÃ§Ãµes |\n| `rest_time` | text | YES | Tempo descanso |\n| `youtube_url` | text | YES | URL YouTube |\n| `image_url` | text | YES | URL imagem |\n| `tags` | text[] | YES | Tags |\n| `is_active` | boolean | YES | Ativo |\n| `created_at` | timestamptz | YES | Criado em |\n\n---\n\n### `exercise_tracking`\nTracking de exercÃ­cios.\n\n| Coluna | Tipo | Nullable | DescriÃ§Ã£o |\n|--------|------|----------|-----------|\n| `id` | uuid | NO | PK |\n| `user_id` | uuid | NO | FK |\n| `date` | date | YES | Data |\n| `exercise_type` | text | YES | Tipo |\n| `duration_minutes` | integer | YES | DuraÃ§Ã£o (min) |\n| `calories_burned` | integer | YES | Calorias |\n| `distance_km` | numeric | YES | DistÃ¢ncia |\n| `steps` | integer | YES | Passos |\n| `heart_rate_avg` | integer | YES | FC mÃ©dia |\n| `notes` | text | YES | Notas |\n| `created_at` | timestamptz | YES | Criado em |\n\n---\n\n### `saved_workout_programs`\nProgramas de treino salvos.\n\n| Coluna | Tipo | Nullable | DescriÃ§Ã£o |\n|--------|------|----------|-----------|\n| `id` | uuid | NO | PK |\n| `user_id` | uuid | NO | FK |\n| `program_name` | text | YES | Nome |\n| `program_type` | text | YES | Tipo |\n| `duration_weeks` | integer | YES | DuraÃ§Ã£o (semanas) |\n| `weekly_schedule` | jsonb | YES | ProgramaÃ§Ã£o semanal |\n| `exercises` | jsonb | YES | ExercÃ­cios |\n| `is_active` | boolean | YES | Ativo |\n| `created_at` | timestamptz | YES | Criado em |\n| `updated_at` | timestamptz | YES | Atualizado em |\n\n---\n\n## 6. Social/Comunidade\n\n### `health_feed_posts`\nPosts do feed social.\n\n| Coluna | Tipo | Nullable | DescriÃ§Ã£o |\n|--------|------|----------|-----------|\n| `id` | uuid | NO | PK |\n| `user_id` | uuid | NO | FK |\n| `content` | text | YES | ConteÃºdo |\n| `post_type` | text | YES | Tipo post |\n| `media_urls` | text[] | YES | URLs mÃ­dia |\n| `tags` | text[] | YES | Tags |\n| `likes_count` | integer | YES | Likes |\n| `comments_count` | integer | YES | ComentÃ¡rios |\n| `shares_count` | integer | YES | Shares |\n| `visibility` | text | YES | Visibilidade |\n| `is_pinned` | boolean | YES | Fixado |\n| `metadata` | jsonb | YES | Metadados |\n| `created_at` | timestamptz | YES | Criado em |\n| `updated_at` | timestamptz | YES | Atualizado em |\n\n---\n\n### `health_feed_stories`\nStories do feed.\n\n| Coluna | Tipo | Nullable | DescriÃ§Ã£o |\n|--------|------|----------|-----------|\n| `id` | uuid | NO | PK |\n| `user_id` | uuid | NO | FK |\n| `media_url` | text | NO | URL mÃ­dia |\n| `media_type` | text | YES | Tipo mÃ­dia |\n| `text_content` | text | YES | Texto |\n| `background_color` | text | YES | Cor fundo |\n| `category` | text | YES | Categoria |\n| `views_count` | integer | YES | VisualizaÃ§Ãµes |\n| `expires_at` | timestamptz | YES | Expira em |\n| `created_at` | timestamptz | YES | Criado em |\n\n---\n\n### `health_feed_follows`\nSeguidores.\n\n| Coluna | Tipo | Nullable | DescriÃ§Ã£o |\n|--------|------|----------|-----------|\n| `follower_id` | uuid | NO | PK, FK |\n| `following_id` | uuid | NO | PK, FK |\n| `created_at` | timestamptz | YES | Criado em |\n\n**PK Composta:** (follower_id, following_id)\n\n---\n\n### `health_feed_reactions`\nReaÃ§Ãµes aos posts.\n\n| Coluna | Tipo | Nullable | DescriÃ§Ã£o |\n|--------|------|----------|-----------|\n| `id` | uuid | NO | PK |\n| `post_id` | uuid | NO | FK â†’ posts |\n| `user_id` | uuid | NO | FK |\n| `reaction_type` | text | YES | Tipo (like, love, etc) |\n| `created_at` | timestamptz | YES | Criado em |\n\n---\n\n## 7. ConfiguraÃ§Ãµes e Admin\n\n### `ai_configurations`\nConfiguraÃ§Ãµes de IA.\n\n| Coluna | Tipo | Nullable | DescriÃ§Ã£o |\n|--------|------|----------|-----------|\n| `id` | uuid | NO | PK |\n| `functionality` | text | NO | Funcionalidade |\n| `service` | text | NO | ServiÃ§o (gemini, openai) |\n| `model` | text | NO | Modelo |\n| `temperature` | numeric | NO | Temperatura |\n| `max_tokens` | integer | NO | Max tokens |\n| `system_prompt` | text | YES | Prompt sistema |\n| `personality` | text | YES | Personalidade |\n| `is_enabled` | boolean | YES | Ativo |\n| `priority` | integer | YES | Prioridade |\n| `created_at` | timestamptz | YES | Criado em |\n| `updated_at` | timestamptz | YES | Atualizado em |\n\n---\n\n### `admin_logs`\nLogs de aÃ§Ãµes admin.\n\n| Coluna | Tipo | Nullable | DescriÃ§Ã£o |\n|--------|------|----------|-----------|\n| `id` | uuid | NO | PK |\n| `admin_id` | uuid | YES | FK |\n| `action` | text | YES | AÃ§Ã£o |\n| `target_type` | text | YES | Tipo alvo |\n| `target_id` | text | YES | ID alvo |\n| `details` | jsonb | YES | Detalhes |\n| `ip_address` | text | YES | IP |\n| `created_at` | timestamptz | YES | Criado em |\n\n---\n\n## 8. Cache e Logs\n\n### `analysis_cache`\nCache de anÃ¡lises de IA.\n\n| Coluna | Tipo | Nullable | DescriÃ§Ã£o |\n|--------|------|----------|-----------|\n| `id` | uuid | NO | PK |\n| `image_hash` | text | NO | Hash da imagem |\n| `analysis_type` | text | NO | Tipo (food, exam) |\n| `result` | jsonb | NO | Resultado |\n| `model_used` | text | YES | Modelo usado |\n| `processing_time_ms` | integer | YES | Tempo proc. |\n| `yolo_confidence` | numeric | YES | ConfianÃ§a YOLO |\n| `hits` | integer | YES | Hits de cache |\n| `last_hit_at` | timestamptz | YES | Ãšltimo hit |\n| `created_at` | timestamptz | YES | Criado em |\n\n**Unique:** image_hash + analysis_type\n\n---\n\n### `ai_response_cache`\nCache de respostas de IA.\n\n| Coluna | Tipo | Nullable | DescriÃ§Ã£o |\n|--------|------|----------|-----------|\n| `id` | uuid | NO | PK |\n| `query_hash` | text | NO | Hash da query |\n| `query_type` | text | NO | Tipo |\n| `query_input` | text | NO | Input |\n| `response_text` | text | NO | Resposta |\n| `model_used` | text | YES | Modelo |\n| `tokens_used` | integer | YES | Tokens |\n| `ttl_hours` | integer | YES | TTL (horas) |\n| `hit_count` | integer | YES | Hits |\n| `last_hit_at` | timestamptz | YES | Ãšltimo hit |\n| `expires_at` | timestamptz | NO | Expira em |\n| `created_at` | timestamptz | NO | Criado em |\n\n---\n\n### `ai_usage_logs`\nLogs de uso de IA.\n\n| Coluna | Tipo | Nullable | DescriÃ§Ã£o |\n|--------|------|----------|-----------|\n| `id` | uuid | NO | PK |\n| `user_id` | uuid | YES | FK |\n| `provider` | text | NO | Provider (gemini, openai) |\n| `method` | text | NO | MÃ©todo |\n| `functionality` | text | YES | Funcionalidade |\n| `model_name` | text | YES | Modelo |\n| `tokens_used` | integer | YES | Tokens |\n| `estimated_cost` | numeric | YES | Custo estimado |\n| `response_time_ms` | integer | YES | Tempo resposta |\n| `success` | boolean | YES | Sucesso |\n| `error_message` | text | YES | Erro |\n| `metadata` | jsonb | YES | Metadados |\n| `created_at` | timestamptz | YES | Criado em |\n\n---\n\n## 9. IntegraÃ§Ãµes Externas\n\n### `google_fit_tokens`\nTokens OAuth do Google Fit.\n\n| Coluna | Tipo | Nullable | DescriÃ§Ã£o |\n|--------|------|----------|-----------|\n| `id` | uuid | NO | PK |\n| `user_id` | uuid | NO | FK |\n| `access_token` | text | YES | Token acesso |\n| `refresh_token` | text | YES | Token refresh |\n| `token_type` | text | YES | Tipo token |\n| `expires_at` | timestamptz | YES | Expira em |\n| `scope` | text | YES | Escopo |\n| `created_at` | timestamptz | YES | Criado em |\n| `updated_at` | timestamptz | YES | Atualizado em |\n\n---\n\n### `chat_conversations`\nConversas de chat.\n\n| Coluna | Tipo | Nullable | DescriÃ§Ã£o |\n|--------|------|----------|-----------|\n| `id` | uuid | NO | PK |\n| `user_id` | uuid | NO | FK |\n| `personality` | text | YES | Personalidade IA |\n| `title` | text | YES | TÃ­tulo |\n| `messages` | jsonb | YES | Mensagens |\n| `total_tokens` | integer | YES | Tokens totais |\n| `created_at` | timestamptz | YES | Criado em |\n| `updated_at` | timestamptz | YES | Atualizado em |\n\n---\n\n## ðŸ“Š Diagrama de Relacionamentos (ERD)\n\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚   auth.users    â”‚      â”‚     profiles     â”‚\nâ”‚   (Supabase)    â”‚â”€â”€1:1â”€â”‚                  â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                                  â”‚\n         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n         â”‚                        â”‚                        â”‚\n         â–¼                        â–¼                        â–¼\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚   user_points   â”‚      â”‚  food_history   â”‚      â”‚ google_fit_data â”‚\nâ”‚ (GamificaÃ§Ã£o)   â”‚      â”‚   (NutriÃ§Ã£o)    â”‚      â”‚    (SaÃºde)      â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n         â”‚                        â”‚\n         â–¼                        â–¼\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚   challenges    â”‚â—„â”€â”€â”€â”€â”€â”‚ challenge_      â”‚\nâ”‚   (DefiniÃ§Ã£o)   â”‚  1:N â”‚ participations  â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚health_feed_postsâ”‚â”€â”€1:Nâ”€â”‚health_feed_     â”‚â”€â”€N:1â”€â”‚    profiles     â”‚\nâ”‚    (Posts)      â”‚      â”‚  reactions      â”‚      â”‚   (UsuÃ¡rio)     â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n---\n\n## ðŸ”§ FunÃ§Ãµes RPC Principais\n\n### GamificaÃ§Ã£o\n\n```sql\n-- Calcula nÃ­vel baseado em XP\ncalculate_level(p_xp_total INTEGER) RETURNS INTEGER\n\n-- Recalcula streak do usuÃ¡rio\nrecalculate_user_streak(p_user_id UUID) RETURNS VOID\n\n-- Processa promoÃ§Ãµes de liga\nprocess_league_promotions() RETURNS VOID\n\n-- Atualiza progresso de desafio\nupdate_challenge_progress(\n  p_user_id UUID,\n  p_challenge_id UUID,\n  p_increment INTEGER\n) RETURNS VOID\n\n-- Adiciona pontos ao usuÃ¡rio\nadd_user_points(\n  p_user_id UUID,\n  p_points INTEGER,\n  p_xp INTEGER,\n  p_action TEXT\n) RETURNS VOID\n```\n\n### NutriÃ§Ã£o\n\n```sql\n-- Calcula macros do dia\ncalculate_daily_macros(\n  p_user_id UUID,\n  p_date DATE\n) RETURNS TABLE(\n  calories INTEGER,\n  protein NUMERIC,\n  carbs NUMERIC,\n  fat NUMERIC\n)\n\n-- Busca histÃ³rico de refeiÃ§Ãµes\nget_meal_history(\n  p_user_id UUID,\n  p_start_date DATE,\n  p_end_date DATE\n) RETURNS SETOF food_history\n```\n\n### SaÃºde\n\n```sql\n-- Calcula score de saÃºde\ncalculate_health_score(p_user_id UUID) RETURNS INTEGER\n\n-- Sincroniza dados Google Fit\nsync_google_fit_data(\n  p_user_id UUID,\n  p_data JSONB\n) RETURNS VOID\n```\n\n---\n\n## ðŸ” PolÃ­ticas RLS Principais\n\n### profiles\n```sql\n-- SELECT: PrÃ³prio perfil ou admin\nCREATE POLICY \"select_own_profile\" ON profiles\n  FOR SELECT USING (auth.uid() = user_id OR is_admin());\n\n-- UPDATE: Apenas prÃ³prio perfil\nCREATE POLICY \"update_own_profile\" ON profiles\n  FOR UPDATE USING (auth.uid() = user_id);\n```\n\n### food_history\n```sql\n-- SELECT: Apenas prÃ³prio histÃ³rico\nCREATE POLICY \"select_own_food\" ON food_history\n  FOR SELECT USING (auth.uid() = user_id);\n\n-- INSERT: UsuÃ¡rio autenticado\nCREATE POLICY \"insert_own_food\" ON food_history\n  FOR INSERT WITH CHECK (auth.uid() = user_id);\n```\n\n### health_feed_posts\n```sql\n-- SELECT: Posts pÃºblicos ou prÃ³prios\nCREATE POLICY \"select_posts\" ON health_feed_posts\n  FOR SELECT USING (\n    visibility = 'public' \n    OR auth.uid() = user_id\n  );\n```\n\n---\n\n## ðŸ“ PrÃ³ximos Passos\n\n- Consulte `05_EDGE_FUNCTIONS.md` para APIs que usam estas tabelas\n- Consulte `07_AI_SYSTEMS.md` para fluxo de anÃ¡lise de IA\n- Consulte `08_GAMIFICATION.md` para lÃ³gica de pontos\n",
      "sections": [
        "# ðŸ—„ï¸ Schema do Banco de Dados MaxNutrition",
        "## ðŸ“Š VisÃ£o Geral",
        "## ðŸ“‘ Ãndice de Tabelas por Categoria",
        "## 1. UsuÃ¡rios e Perfis",
        "### `profiles`",
        "### `user_anamnesis`",
        "### `user_preferences`",
        "## 2. GamificaÃ§Ã£o",
        "### `user_points`",
        "### `challenges`",
        "### `challenge_participations`",
        "### `user_achievements_v2`",
        "### `flash_challenges`",
        "### `daily_mission_sessions`",
        "## 3. NutriÃ§Ã£o e Sofia",
        "### `food_history`",
        "### `sofia_memory`",
        "### `sofia_learning`",
        "### `meal_plans`",
        "### `nutrition_tracking`",
        "## 4. SaÃºde e MÃ©dico",
        "### `medical_exam_analyses`",
        "### `google_fit_data`",
        "### `health_diary`",
        "### `advanced_daily_tracking`",
        "## 5. ExercÃ­cios",
        "### `exercises_library`",
        "### `exercise_tracking`",
        "### `saved_workout_programs`",
        "## 6. Social/Comunidade",
        "### `health_feed_posts`",
        "### `health_feed_stories`",
        "### `health_feed_follows`",
        "### `health_feed_reactions`",
        "## 7. ConfiguraÃ§Ãµes e Admin",
        "### `ai_configurations`",
        "### `admin_logs`",
        "## 8. Cache e Logs",
        "### `analysis_cache`",
        "### `ai_response_cache`",
        "### `ai_usage_logs`",
        "## 9. IntegraÃ§Ãµes Externas",
        "### `google_fit_tokens`",
        "### `chat_conversations`",
        "## ðŸ“Š Diagrama de Relacionamentos (ERD)",
        "## ðŸ”§ FunÃ§Ãµes RPC Principais",
        "### GamificaÃ§Ã£o",
        "### NutriÃ§Ã£o",
        "### SaÃºde",
        "## ðŸ” PolÃ­ticas RLS Principais",
        "### profiles",
        "### food_history",
        "### health_feed_posts",
        "## ðŸ“ PrÃ³ximos Passos"
      ],
      "code_blocks": 14,
      "links": [
        "#1-usuÃ¡rios-e-perfis",
        "#2-gamificaÃ§Ã£o",
        "#3-nutriÃ§Ã£o-e-sofia",
        "#4-saÃºde-e-mÃ©dico",
        "#5-exercÃ­cios",
        "#6-socialcomunidade",
        "#7-configuraÃ§Ãµes-e-admin",
        "#8-cache-e-logs",
        "#9-integraÃ§Ãµes-externas"
      ]
    },
    "03_COMPONENTS_CATALOG.md": {
      "path": "docs/03_COMPONENTS_CATALOG.md",
      "exists": true,
      "lines": 749,
      "size_kb": 15.0029296875,
      "content": "# ðŸ§© CatÃ¡logo de Componentes React\n\n> DocumentaÃ§Ã£o gerada em: 2026-01-16\n> Total de Componentes: 742\n\n---\n\n## ðŸ“Š VisÃ£o Geral\n\n| Categoria | Quantidade | LocalizaÃ§Ã£o |\n|-----------|------------|-------------|\n| UI Base (shadcn) | 50+ | `src/components/ui/` |\n| Sofia (IA) | 25+ | `src/components/sofia/` |\n| Dr. Vital (IA) | 15+ | `src/components/dr-vital/` |\n| GamificaÃ§Ã£o | 20+ | `src/components/gamification/` |\n| ExercÃ­cios | 30+ | `src/components/exercise/` |\n| NutriÃ§Ã£o | 25+ | `src/components/nutrition/` |\n| Dashboard | 20+ | `src/components/dashboard/` |\n| Admin | 30+ | `src/components/admin/` |\n| Comunidade | 35+ | `src/components/community/` |\n| Standalone | 60+ | `src/components/*.tsx` |\n\n---\n\n## ðŸŽ¨ UI Base (src/components/ui/)\n\nComponentes base do design system, baseados em shadcn/ui.\n\n### Button\n```typescript\n// src/components/ui/button.tsx\ninterface ButtonProps extends React.ButtonHTMLAttributes<HTMLButtonElement> {\n  variant?: 'default' | 'destructive' | 'outline' | 'secondary' | 'ghost' | 'link';\n  size?: 'default' | 'sm' | 'lg' | 'icon';\n  asChild?: boolean;\n}\n\n// Uso\n<Button variant=\"default\" size=\"lg\">\n  Salvar\n</Button>\n```\n\n### Card\n```typescript\n// src/components/ui/card.tsx\n// Card, CardHeader, CardTitle, CardDescription, CardContent, CardFooter\n\n<Card>\n  <CardHeader>\n    <CardTitle>TÃ­tulo</CardTitle>\n    <CardDescription>DescriÃ§Ã£o</CardDescription>\n  </CardHeader>\n  <CardContent>\n    ConteÃºdo\n  </CardContent>\n</Card>\n```\n\n### Dialog\n```typescript\n// src/components/ui/dialog.tsx\n// Dialog, DialogTrigger, DialogContent, DialogHeader, DialogTitle, DialogDescription\n\n<Dialog open={open} onOpenChange={setOpen}>\n  <DialogTrigger asChild>\n    <Button>Abrir</Button>\n  </DialogTrigger>\n  <DialogContent>\n    <DialogHeader>\n      <DialogTitle>TÃ­tulo</DialogTitle>\n    </DialogHeader>\n    ConteÃºdo\n  </DialogContent>\n</Dialog>\n```\n\n### Outros Componentes UI\n\n| Componente | DescriÃ§Ã£o |\n|------------|-----------|\n| `accordion.tsx` | Accordion expansÃ­vel |\n| `alert-dialog.tsx` | Dialog de confirmaÃ§Ã£o |\n| `avatar.tsx` | Avatar com fallback |\n| `badge.tsx` | Badge/Tag |\n| `calendar.tsx` | CalendÃ¡rio date picker |\n| `checkbox.tsx` | Checkbox |\n| `collapsible.tsx` | Ãrea colapsÃ¡vel |\n| `dropdown-menu.tsx` | Menu dropdown |\n| `input.tsx` | Input de texto |\n| `label.tsx` | Label de formulÃ¡rio |\n| `popover.tsx` | Popover flutuante |\n| `progress.tsx` | Barra de progresso |\n| `radio-group.tsx` | Grupo de radio |\n| `scroll-area.tsx` | Ãrea com scroll |\n| `select.tsx` | Select dropdown |\n| `separator.tsx` | Separador |\n| `sheet.tsx` | Sheet lateral |\n| `skeleton.tsx` | Skeleton loader |\n| `slider.tsx` | Slider de valor |\n| `switch.tsx` | Switch toggle |\n| `tabs.tsx` | Tabs navegaÃ§Ã£o |\n| `textarea.tsx` | Textarea multiline |\n| `toast.tsx` | Toast notification |\n| `tooltip.tsx` | Tooltip |\n\n---\n\n## ðŸ¤– Sofia - IA Nutricionista (src/components/sofia/)\n\n### SofiaChat\nChat principal com a Sofia.\n\n```typescript\ninterface SofiaChatProps {\n  onClose?: () => void;\n  initialMessage?: string;\n  embedded?: boolean;\n}\n\n// Uso\n<SofiaChat \n  embedded={true}\n  onClose={() => navigate('/dashboard')}\n/>\n```\n\n### SofiaImageAnalysis\nAnÃ¡lise de imagens de alimentos.\n\n```typescript\ninterface SofiaImageAnalysisProps {\n  imageUrl: string;\n  onAnalysisComplete: (result: FoodAnalysisResult) => void;\n  onError?: (error: string) => void;\n}\n\ninterface FoodAnalysisResult {\n  foods: FoodItem[];\n  totalCalories: number;\n  totalProtein: number;\n  totalCarbs: number;\n  totalFat: number;\n  confidence: number;\n}\n```\n\n### SofiaFoodHistory\nHistÃ³rico de anÃ¡lises de alimentos.\n\n```typescript\ninterface SofiaFoodHistoryProps {\n  userId: string;\n  dateRange?: { start: Date; end: Date };\n  onItemClick?: (item: FoodHistoryItem) => void;\n}\n```\n\n### Outros Componentes Sofia\n\n| Componente | DescriÃ§Ã£o |\n|------------|-----------|\n| `SofiaSuggestions.tsx` | SugestÃµes personalizadas |\n| `SofiaQuickActions.tsx` | AÃ§Ãµes rÃ¡pidas |\n| `SofiaMessageBubble.tsx` | Bolha de mensagem |\n| `SofiaTypingIndicator.tsx` | Indicador digitando |\n| `SofiaHeader.tsx` | CabeÃ§alho do chat |\n| `SofiaInputArea.tsx` | Ãrea de input |\n| `SofiaImagePreview.tsx` | Preview de imagem |\n| `SofiaNutritionCard.tsx` | Card nutricional |\n\n---\n\n## ðŸ¥ Dr. Vital - IA MÃ©dica (src/components/dr-vital/)\n\n### DrVitalChat\nChat com o Dr. Vital.\n\n```typescript\ninterface DrVitalChatProps {\n  examContext?: ExamAnalysis;\n  onClose?: () => void;\n}\n```\n\n### ExamAnalysis\nComponente de anÃ¡lise de exames.\n\n```typescript\ninterface ExamAnalysisProps {\n  examId?: string;\n  onAnalysisComplete?: (analysis: MedicalAnalysis) => void;\n}\n\ninterface MedicalAnalysis {\n  examType: string;\n  extractedData: Record<string, any>;\n  interpretation: string;\n  recommendations: string[];\n  riskLevel: 'low' | 'medium' | 'high';\n}\n```\n\n### ExamHistory\nHistÃ³rico de exames analisados.\n\n```typescript\ninterface ExamHistoryProps {\n  userId: string;\n  onExamSelect?: (exam: ExamRecord) => void;\n}\n```\n\n### Outros Componentes Dr. Vital\n\n| Componente | DescriÃ§Ã£o |\n|------------|-----------|\n| `DrVitalHeader.tsx` | CabeÃ§alho |\n| `ExamUploadArea.tsx` | Ãrea de upload |\n| `ExamResultCard.tsx` | Card de resultado |\n| `HealthIndicator.tsx` | Indicador de saÃºde |\n| `ReportGenerator.tsx` | Gerador de PDF |\n| `RiskBadge.tsx` | Badge de risco |\n\n---\n\n## ðŸŽ® GamificaÃ§Ã£o (src/components/gamification/)\n\n### BadgeSystem\nSistema de badges/conquistas.\n\n```typescript\ninterface BadgeSystemProps {\n  userId: string;\n  showRecent?: boolean;\n  maxDisplay?: number;\n}\n```\n\n### LevelProgress\nBarra de progresso de nÃ­vel.\n\n```typescript\ninterface LevelProgressProps {\n  currentLevel: number;\n  currentXP: number;\n  xpToNextLevel: number;\n  showDetails?: boolean;\n}\n\n// Uso\n<LevelProgress \n  currentLevel={5}\n  currentXP={450}\n  xpToNextLevel={500}\n  showDetails={true}\n/>\n```\n\n### PointsDisplay\nExibiÃ§Ã£o de pontos.\n\n```typescript\ninterface PointsDisplayProps {\n  points: number;\n  weeklyPoints?: number;\n  showTrend?: boolean;\n  compact?: boolean;\n}\n```\n\n### StreakCounter\nContador de streak.\n\n```typescript\ninterface StreakCounterProps {\n  currentStreak: number;\n  longestStreak: number;\n  lastActivityDate?: Date;\n  showFlame?: boolean;\n}\n```\n\n### XPBar\nBarra de XP.\n\n```typescript\ninterface XPBarProps {\n  current: number;\n  max: number;\n  level: number;\n  animated?: boolean;\n}\n```\n\n### RankingCard\nCard de posiÃ§Ã£o no ranking.\n\n```typescript\ninterface RankingCardProps {\n  position: number;\n  totalUsers: number;\n  league: 'bronze' | 'silver' | 'gold' | 'diamond';\n  weeklyChange?: number;\n}\n```\n\n### Outros Componentes GamificaÃ§Ã£o\n\n| Componente | DescriÃ§Ã£o |\n|------------|-----------|\n| `ChallengeCard.tsx` | Card de desafio |\n| `ChallengeProgress.tsx` | Progresso do desafio |\n| `DailyMissionCard.tsx` | Card missÃ£o diÃ¡ria |\n| `LeaderboardRow.tsx` | Linha do ranking |\n| `AchievementUnlock.tsx` | AnimaÃ§Ã£o conquista |\n| `XPGainAnimation.tsx` | AnimaÃ§Ã£o ganho XP |\n| `LevelUpModal.tsx` | Modal level up |\n| `ComboMultiplier.tsx` | Multiplicador combo |\n\n---\n\n## ðŸ‹ï¸ ExercÃ­cios (src/components/exercise/)\n\n### ExerciseLibrary\nBiblioteca de exercÃ­cios.\n\n```typescript\ninterface ExerciseLibraryProps {\n  location?: 'home' | 'gym' | 'outdoor';\n  muscleGroup?: string;\n  difficulty?: 'beginner' | 'intermediate' | 'advanced';\n  onExerciseSelect?: (exercise: Exercise) => void;\n}\n```\n\n### ExerciseCard\nCard individual de exercÃ­cio.\n\n```typescript\ninterface ExerciseCardProps {\n  exercise: Exercise;\n  showDetails?: boolean;\n  onStart?: () => void;\n  onInfoClick?: () => void;\n}\n\ninterface Exercise {\n  id: string;\n  name: string;\n  muscleGroup: string;\n  difficulty: string;\n  sets: string;\n  reps: string;\n  restTime: string;\n  youtubeUrl?: string;\n  imageUrl?: string;\n  instructions: string[];\n}\n```\n\n### ActiveWorkoutModal\nModal de treino ativo.\n\n```typescript\ninterface ActiveWorkoutModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  exercises: Exercise[];\n  onComplete: (summary: WorkoutSummary) => void;\n}\n```\n\n### Subpastas de ExercÃ­cios\n\n#### `exercise/saved-program/`\n| Componente | DescriÃ§Ã£o |\n|------------|-----------|\n| `index.tsx` | Orchestrator principal |\n| `ProgramHeader.tsx` | CabeÃ§alho do programa |\n| `ProgramDayList.tsx` | Lista de dias |\n| `ProgramExerciseList.tsx` | Lista de exercÃ­cios |\n| `WorkoutDayCard.tsx` | Card dia treino |\n| `RestDayCard.tsx` | Card dia descanso |\n\n#### `exercise/workout/`\n| Componente | DescriÃ§Ã£o |\n|------------|-----------|\n| `WorkoutTimer.tsx` | Timer do treino |\n| `ExerciseDisplay.tsx` | Display exercÃ­cio |\n| `ProgressTracker.tsx` | Tracker progresso |\n\n#### `exercise/unified-timer/`\n| Componente | DescriÃ§Ã£o |\n|------------|-----------|\n| `index.tsx` | Timer unificado |\n| `TimerDisplay.tsx` | Display do timer |\n| `TimerControls.tsx` | Controles |\n| `MotivationalMessages.tsx` | Mensagens |\n\n---\n\n## ðŸ¥— NutriÃ§Ã£o (src/components/nutrition/)\n\n### NutritionDashboard\nDashboard nutricional.\n\n```typescript\ninterface NutritionDashboardProps {\n  userId: string;\n  date?: Date;\n}\n```\n\n### MacroChart\nGrÃ¡fico de macronutrientes.\n\n```typescript\ninterface MacroChartProps {\n  protein: number;\n  carbs: number;\n  fat: number;\n  proteinGoal: number;\n  carbsGoal: number;\n  fatGoal: number;\n}\n```\n\n### CalorieProgress\nProgresso de calorias.\n\n```typescript\ninterface CalorieProgressProps {\n  consumed: number;\n  goal: number;\n  burned?: number;\n  showBreakdown?: boolean;\n}\n```\n\n### MealCard\nCard de refeiÃ§Ã£o.\n\n```typescript\ninterface MealCardProps {\n  meal: Meal;\n  onEdit?: () => void;\n  onDelete?: () => void;\n  showMacros?: boolean;\n}\n```\n\n### Outros Componentes NutriÃ§Ã£o\n\n| Componente | DescriÃ§Ã£o |\n|------------|-----------|\n| `WaterTracker.tsx` | Tracker de Ã¡gua |\n| `FoodSearch.tsx` | Busca de alimentos |\n| `NutritionGoals.tsx` | Metas nutricionais |\n| `MealPlanView.tsx` | VisualizaÃ§Ã£o cardÃ¡pio |\n| `NutritionHistory.tsx` | HistÃ³rico |\n| `MacroRing.tsx` | Anel de macros |\n| `FoodItemRow.tsx` | Linha de alimento |\n\n---\n\n## ðŸ“Š Dashboard (src/components/dashboard/)\n\n### DashboardHeader\nCabeÃ§alho do dashboard.\n\n```typescript\ninterface DashboardHeaderProps {\n  userName: string;\n  greeting?: string;\n  showNotifications?: boolean;\n}\n```\n\n### QuickActions\nAÃ§Ãµes rÃ¡pidas.\n\n```typescript\ninterface QuickActionsProps {\n  actions: QuickAction[];\n  columns?: 2 | 3 | 4;\n}\n\ninterface QuickAction {\n  id: string;\n  icon: LucideIcon;\n  label: string;\n  onClick: () => void;\n  badge?: string;\n}\n```\n\n### StatsCards\nCards de estatÃ­sticas.\n\n```typescript\ninterface StatsCardsProps {\n  stats: StatCard[];\n}\n\ninterface StatCard {\n  title: string;\n  value: string | number;\n  change?: number;\n  icon: LucideIcon;\n  color?: string;\n}\n```\n\n### HealthScoreCard\nCard de score de saÃºde.\n\n```typescript\ninterface HealthScoreCardProps {\n  score: number;\n  maxScore?: number;\n  breakdown?: ScoreBreakdown;\n  onDetailsClick?: () => void;\n}\n```\n\n### Outros Componentes Dashboard\n\n| Componente | DescriÃ§Ã£o |\n|------------|-----------|\n| `DailyProgress.tsx` | Progresso diÃ¡rio |\n| `WeeklyChart.tsx` | GrÃ¡fico semanal |\n| `UpcomingGoals.tsx` | Metas prÃ³ximas |\n| `RecentActivity.tsx` | Atividade recente |\n| `MotivationalQuote.tsx` | CitaÃ§Ã£o motivacional |\n| `WeatherWidget.tsx` | Widget clima |\n| `TodaySchedule.tsx` | Agenda do dia |\n\n---\n\n## ðŸ›¡ï¸ Admin (src/components/admin/)\n\n### AdminDashboard\nDashboard administrativo.\n\n```typescript\ninterface AdminDashboardProps {\n  adminId: string;\n}\n```\n\n### UserManagement\nGerenciamento de usuÃ¡rios.\n\n```typescript\ninterface UserManagementProps {\n  onUserSelect?: (user: UserProfile) => void;\n}\n```\n\n### AIConfigPanel\nConfiguraÃ§Ã£o de IA.\n\n```typescript\ninterface AIConfigPanelProps {\n  functionality: string;\n  onSave?: (config: AIConfig) => void;\n}\n```\n\n### SystemHealth\nSaÃºde do sistema.\n\n```typescript\ninterface SystemHealthProps {\n  showDetails?: boolean;\n  refreshInterval?: number;\n}\n```\n\n### Outros Componentes Admin\n\n| Componente | DescriÃ§Ã£o |\n|------------|-----------|\n| `AdminSidebar.tsx` | Sidebar admin |\n| `UserTable.tsx` | Tabela usuÃ¡rios |\n| `AIUsageChart.tsx` | GrÃ¡fico uso IA |\n| `SystemLogs.tsx` | Logs do sistema |\n| `StorageStats.tsx` | EstatÃ­sticas storage |\n| `DatabaseStats.tsx` | EstatÃ­sticas DB |\n| `FeatureFlagsPanel.tsx` | Feature flags |\n\n---\n\n## ðŸ‘¥ Comunidade (src/components/community/)\n\n### FeedPost\nPost do feed.\n\n```typescript\ninterface FeedPostProps {\n  post: Post;\n  onLike?: () => void;\n  onComment?: () => void;\n  onShare?: () => void;\n}\n```\n\n### StoryRing\nRing de stories.\n\n```typescript\ninterface StoryRingProps {\n  stories: Story[];\n  onStoryClick?: (story: Story) => void;\n}\n```\n\n### ProfileCard\nCard de perfil.\n\n```typescript\ninterface ProfileCardProps {\n  user: UserProfile;\n  isFollowing?: boolean;\n  onFollow?: () => void;\n}\n```\n\n### Outros Componentes Comunidade\n\n| Componente | DescriÃ§Ã£o |\n|------------|-----------|\n| `CommentSection.tsx` | SeÃ§Ã£o comentÃ¡rios |\n| `FollowersList.tsx` | Lista seguidores |\n| `FollowingList.tsx` | Lista seguindo |\n| `CreatePostModal.tsx` | Modal criar post |\n| `CreateStoryModal.tsx` | Modal criar story |\n| `DirectMessages.tsx` | Mensagens diretas |\n| `NotificationBell.tsx` | Sino notificaÃ§Ãµes |\n| `UserSearchBar.tsx` | Busca usuÃ¡rios |\n\n---\n\n## ðŸ“± NavegaÃ§Ã£o (src/components/navigation/)\n\n### BottomNavigation\nNavegaÃ§Ã£o inferior mobile.\n\n```typescript\ninterface BottomNavigationProps {\n  activeTab: string;\n  onTabChange: (tab: string) => void;\n}\n```\n\n### MobileHeader\nHeader mobile.\n\n```typescript\ninterface MobileHeaderProps {\n  title: string;\n  showBack?: boolean;\n  showMenu?: boolean;\n  actions?: HeaderAction[];\n}\n```\n\n### Sidebar\nSidebar lateral.\n\n```typescript\ninterface SidebarProps {\n  isOpen: boolean;\n  onClose: () => void;\n  user: UserProfile;\n}\n```\n\n---\n\n## ðŸ”§ Componentes Standalone\n\nComponentes importantes na raiz de `src/components/`:\n\n| Componente | DescriÃ§Ã£o |\n|------------|-----------|\n| `AuthGuard.tsx` | ProteÃ§Ã£o de rotas autenticadas |\n| `Dashboard.tsx` | Dashboard principal |\n| `OnboardingFlow.tsx` | Fluxo de onboarding |\n| `OptimizedImage.tsx` | Imagem otimizada |\n| `InstallPrompt.tsx` | Prompt instalaÃ§Ã£o PWA |\n| `NotificationBell.tsx` | Sino de notificaÃ§Ãµes |\n| `ThemeToggle.tsx` | Toggle tema claro/escuro |\n| `VirtualList.tsx` | Lista virtualizada |\n| `HeroCarousel.tsx` | Carousel hero |\n| `HealthChatBot.tsx` | ChatBot de saÃºde |\n| `MissionSystem.tsx` | Sistema de missÃµes |\n| `RankingPage.tsx` | PÃ¡gina de ranking |\n| `SubscriptionStatus.tsx` | Status assinatura |\n\n---\n\n## ðŸ“ PadrÃµes de Componentes\n\n### Estrutura Recomendada\n\n```typescript\n// ComponentName.tsx\nimport { useState, useCallback } from 'react';\nimport { cn } from '@/lib/utils';\n\ninterface ComponentNameProps {\n  // Props tipadas\n}\n\nexport function ComponentName({ prop1, prop2 }: ComponentNameProps) {\n  // Hooks no topo\n  const [state, setState] = useState();\n  \n  // Handlers\n  const handleClick = useCallback(() => {\n    // LÃ³gica\n  }, []);\n  \n  // Render\n  return (\n    <div className={cn(\"base-classes\", conditionalClass)}>\n      {/* ConteÃºdo */}\n    </div>\n  );\n}\n```\n\n### ConvenÃ§Ãµes\n\n1. **Nomes**: PascalCase para componentes\n2. **Arquivos**: Um componente principal por arquivo\n3. **Props**: Interface com sufixo `Props`\n4. **Hooks**: Extrair lÃ³gica para hooks customizados\n5. **Estilos**: Usar tokens semÃ¢nticos do Tailwind\n\n---\n\n## ðŸ“ PrÃ³ximos Passos\n\n- Consulte `04_HOOKS_REFERENCE.md` para hooks utilizados\n- Consulte `06_NAVIGATION_FLOWS.md` para fluxos de navegaÃ§Ã£o\n",
      "sections": [
        "# ðŸ§© CatÃ¡logo de Componentes React",
        "## ðŸ“Š VisÃ£o Geral",
        "## ðŸŽ¨ UI Base (src/components/ui/)",
        "### Button",
        "### Card",
        "### Dialog",
        "### Outros Componentes UI",
        "## ðŸ¤– Sofia - IA Nutricionista (src/components/sofia/)",
        "### SofiaChat",
        "### SofiaImageAnalysis",
        "### SofiaFoodHistory",
        "### Outros Componentes Sofia",
        "## ðŸ¥ Dr. Vital - IA MÃ©dica (src/components/dr-vital/)",
        "### DrVitalChat",
        "### ExamAnalysis",
        "### ExamHistory",
        "### Outros Componentes Dr. Vital",
        "## ðŸŽ® GamificaÃ§Ã£o (src/components/gamification/)",
        "### BadgeSystem",
        "### LevelProgress",
        "### PointsDisplay",
        "### StreakCounter",
        "### XPBar",
        "### RankingCard",
        "### Outros Componentes GamificaÃ§Ã£o",
        "## ðŸ‹ï¸ ExercÃ­cios (src/components/exercise/)",
        "### ExerciseLibrary",
        "### ExerciseCard",
        "### ActiveWorkoutModal",
        "### Subpastas de ExercÃ­cios",
        "#### `exercise/saved-program/`",
        "#### `exercise/workout/`",
        "#### `exercise/unified-timer/`",
        "## ðŸ¥— NutriÃ§Ã£o (src/components/nutrition/)",
        "### NutritionDashboard",
        "### MacroChart",
        "### CalorieProgress",
        "### MealCard",
        "### Outros Componentes NutriÃ§Ã£o",
        "## ðŸ“Š Dashboard (src/components/dashboard/)",
        "### DashboardHeader",
        "### QuickActions",
        "### StatsCards",
        "### HealthScoreCard",
        "### Outros Componentes Dashboard",
        "## ðŸ›¡ï¸ Admin (src/components/admin/)",
        "### AdminDashboard",
        "### UserManagement",
        "### AIConfigPanel",
        "### SystemHealth",
        "### Outros Componentes Admin",
        "## ðŸ‘¥ Comunidade (src/components/community/)",
        "### FeedPost",
        "### StoryRing",
        "### ProfileCard",
        "### Outros Componentes Comunidade",
        "## ðŸ“± NavegaÃ§Ã£o (src/components/navigation/)",
        "### BottomNavigation",
        "### MobileHeader",
        "### Sidebar",
        "## ðŸ”§ Componentes Standalone",
        "## ðŸ“ PadrÃµes de Componentes",
        "### Estrutura Recomendada",
        "### ConvenÃ§Ãµes",
        "## ðŸ“ PrÃ³ximos Passos"
      ],
      "code_blocks": 74,
      "links": []
    },
    "04_HOOKS_REFERENCE.md": {
      "path": "docs/04_HOOKS_REFERENCE.md",
      "exists": true,
      "lines": 920,
      "size_kb": 17.8193359375,
      "content": "# ðŸª ReferÃªncia de Hooks Customizados\n\n> DocumentaÃ§Ã£o gerada em: 2026-01-16\n> Total de Hooks: 165\n\n---\n\n## ðŸ“Š VisÃ£o Geral\n\n| Categoria | Quantidade | LocalizaÃ§Ã£o |\n|-----------|------------|-------------|\n| AutenticaÃ§Ã£o | 5 | `src/hooks/` |\n| GamificaÃ§Ã£o | 15+ | `src/hooks/gamification/` |\n| Dados de UsuÃ¡rio | 15+ | `src/hooks/` |\n| NutriÃ§Ã£o | 12+ | `src/hooks/` |\n| ExercÃ­cios | 10+ | `src/hooks/exercise/` |\n| SaÃºde/MÃ©dico | 8+ | `src/hooks/dr-vital/` |\n| Comunidade | 10+ | `src/hooks/community/` |\n| Utilidades | 20+ | `src/hooks/` |\n\n---\n\n## ðŸ” AutenticaÃ§Ã£o\n\n### useAuth\nHook principal de autenticaÃ§Ã£o.\n\n```typescript\n// src/hooks/useAuth.ts\ninterface UseAuthReturn {\n  user: User | null;\n  session: Session | null;\n  isLoading: boolean;\n  isAuthenticated: boolean;\n  signIn: (email: string, password: string) => Promise<void>;\n  signUp: (email: string, password: string, metadata?: object) => Promise<void>;\n  signOut: () => Promise<void>;\n  resetPassword: (email: string) => Promise<void>;\n}\n\n// Uso\nconst { user, isAuthenticated, signOut } = useAuth();\n\nif (!isAuthenticated) {\n  return <LoginPage />;\n}\n```\n\n### useAdminMode\nVerifica se usuÃ¡rio Ã© admin.\n\n```typescript\n// src/hooks/useAdminMode.ts\ninterface UseAdminModeReturn {\n  isAdmin: boolean;\n  isLoading: boolean;\n  adminSince: Date | null;\n}\n\n// Uso\nconst { isAdmin, isLoading } = useAdminMode();\n\nif (!isAdmin) {\n  return <AccessDenied />;\n}\n```\n\n### useAdminPermissions\nPermissÃµes granulares de admin.\n\n```typescript\n// src/hooks/useAdminPermissions.ts\ninterface UseAdminPermissionsReturn {\n  permissions: AdminPermission[];\n  hasPermission: (permission: string) => boolean;\n  isLoading: boolean;\n}\n\ntype AdminPermission = \n  | 'manage_users'\n  | 'manage_content'\n  | 'view_analytics'\n  | 'manage_ai'\n  | 'manage_system';\n\n// Uso\nconst { hasPermission } = useAdminPermissions();\n\nif (!hasPermission('manage_users')) {\n  return null;\n}\n```\n\n---\n\n## ðŸŽ® GamificaÃ§Ã£o\n\n### useGamificationUnified\nHook unificado de gamificaÃ§Ã£o.\n\n```typescript\n// src/hooks/useGamificationUnified.ts\ninterface UseGamificationUnifiedReturn {\n  // Dados\n  points: number;\n  xp: number;\n  level: number;\n  currentStreak: number;\n  longestStreak: number;\n  \n  // Status\n  isLoading: boolean;\n  error: Error | null;\n  \n  // AÃ§Ãµes\n  addPoints: (amount: number, action: string) => Promise<void>;\n  addXP: (amount: number, source: string) => Promise<void>;\n  updateStreak: () => Promise<void>;\n  \n  // Computed\n  xpToNextLevel: number;\n  levelProgress: number; // 0-100\n}\n\n// Uso\nconst { \n  points, \n  level, \n  currentStreak, \n  addPoints \n} = useGamificationUnified();\n\nawait addPoints(10, 'meal_logged');\n```\n\n### useRealRanking\nPosiÃ§Ã£o real no ranking.\n\n```typescript\n// src/hooks/useRealRanking.ts\ninterface UseRealRankingReturn {\n  position: number;\n  totalUsers: number;\n  league: LeagueType;\n  weeklyChange: number;\n  topUsers: RankedUser[];\n  isLoading: boolean;\n  refetch: () => void;\n}\n\ntype LeagueType = 'bronze' | 'silver' | 'gold' | 'diamond';\n\ninterface RankedUser {\n  userId: string;\n  name: string;\n  avatarUrl: string;\n  points: number;\n  position: number;\n  level: number;\n}\n\n// Uso\nconst { position, league, topUsers } = useRealRanking();\n```\n\n### useChallenges\nGerenciamento de desafios.\n\n```typescript\n// src/hooks/useChallenges.ts\ninterface UseChallengesReturn {\n  // Dados\n  activeChallenges: Challenge[];\n  myParticipations: ChallengeParticipation[];\n  completedChallenges: Challenge[];\n  \n  // Status\n  isLoading: boolean;\n  \n  // AÃ§Ãµes\n  joinChallenge: (challengeId: string) => Promise<void>;\n  updateProgress: (participationId: string, progress: number) => Promise<void>;\n  leaveChallenge: (challengeId: string) => Promise<void>;\n}\n\n// Uso\nconst { \n  activeChallenges, \n  joinChallenge, \n  updateProgress \n} = useChallenges();\n```\n\n### useDailyMissions\nMissÃµes diÃ¡rias.\n\n```typescript\n// src/hooks/useDailyMissions.ts\ninterface UseDailyMissionsReturn {\n  missions: DailyMission[];\n  completedCount: number;\n  totalMissions: number;\n  streakDays: number;\n  totalPoints: number;\n  isLoading: boolean;\n  completeMission: (missionId: string) => Promise<void>;\n  refreshMissions: () => void;\n}\n\ninterface DailyMission {\n  id: string;\n  title: string;\n  description: string;\n  points: number;\n  isCompleted: boolean;\n  category: 'nutrition' | 'exercise' | 'health' | 'social';\n  icon: string;\n}\n\n// Uso\nconst { missions, completeMission } = useDailyMissions();\n```\n\n### useFlashChallenge\nDesafios relÃ¢mpago.\n\n```typescript\n// src/hooks/useFlashChallenge.ts\ninterface UseFlashChallengeReturn {\n  currentChallenge: FlashChallenge | null;\n  timeRemaining: number; // segundos\n  myProgress: number;\n  isParticipating: boolean;\n  join: () => Promise<void>;\n  updateProgress: (value: number) => Promise<void>;\n}\n```\n\n### useUserPoints\nPontos do usuÃ¡rio.\n\n```typescript\n// src/hooks/useUserPoints.ts\ninterface UseUserPointsReturn {\n  totalPoints: number;\n  weeklyPoints: number;\n  monthlyPoints: number;\n  pointsHistory: PointsEntry[];\n  isLoading: boolean;\n}\n```\n\n### useUserXP\nXP do usuÃ¡rio.\n\n```typescript\n// src/hooks/useUserXP.ts\ninterface UseUserXPReturn {\n  totalXP: number;\n  level: number;\n  xpToNextLevel: number;\n  progress: number; // 0-100\n  isLoading: boolean;\n}\n```\n\n### useUserStreak\nStreak do usuÃ¡rio.\n\n```typescript\n// src/hooks/useUserStreak.ts\ninterface UseUserStreakReturn {\n  currentStreak: number;\n  longestStreak: number;\n  lastActivityDate: Date | null;\n  isActive: boolean;\n  isLoading: boolean;\n}\n```\n\n---\n\n## ðŸ‘¤ Dados de UsuÃ¡rio\n\n### useUserProfile\nPerfil do usuÃ¡rio.\n\n```typescript\n// src/hooks/useUserProfile.ts\ninterface UseUserProfileReturn {\n  profile: UserProfile | null;\n  isLoading: boolean;\n  error: Error | null;\n  updateProfile: (data: Partial<UserProfile>) => Promise<void>;\n  refreshProfile: () => void;\n}\n\ninterface UserProfile {\n  id: string;\n  userId: string;\n  fullName: string;\n  avatarUrl: string | null;\n  gender: string | null;\n  birthDate: Date | null;\n  heightCm: number | null;\n  weightKg: number | null;\n  targetWeightKg: number | null;\n  activityLevel: string | null;\n  dietaryPreference: string | null;\n  healthGoals: string[];\n  onboardingCompleted: boolean;\n  isAdmin: boolean;\n  subscriptionStatus: string;\n}\n\n// Uso\nconst { profile, updateProfile } = useUserProfile();\n\nawait updateProfile({ fullName: 'Novo Nome' });\n```\n\n### useHealthData\nDados de saÃºde consolidados.\n\n```typescript\n// src/hooks/useHealthData.ts\ninterface UseHealthDataReturn {\n  // Dados atuais\n  currentWeight: number | null;\n  bmi: number | null;\n  bodyFatPercentage: number | null;\n  \n  // HistÃ³rico\n  weightHistory: WeightEntry[];\n  healthDiary: HealthDiaryEntry[];\n  \n  // AÃ§Ãµes\n  logWeight: (weight: number, date?: Date) => Promise<void>;\n  logHealthEntry: (entry: Partial<HealthDiaryEntry>) => Promise<void>;\n  \n  // Status\n  isLoading: boolean;\n}\n```\n\n### useGoogleFitData\nDados do Google Fit.\n\n```typescript\n// src/hooks/useGoogleFitData.ts\ninterface UseGoogleFitDataReturn {\n  isConnected: boolean;\n  lastSync: Date | null;\n  \n  // Dados do dia\n  todayData: GoogleFitDayData | null;\n  \n  // HistÃ³rico\n  weeklyData: GoogleFitDayData[];\n  \n  // AÃ§Ãµes\n  sync: () => Promise<void>;\n  disconnect: () => Promise<void>;\n  \n  // Status\n  isSyncing: boolean;\n  error: Error | null;\n}\n\ninterface GoogleFitDayData {\n  date: Date;\n  steps: number;\n  calories: number;\n  distanceMeters: number;\n  activeMinutes: number;\n  heartRateAvg: number | null;\n  sleepHours: number | null;\n}\n\n// Uso\nconst { todayData, sync, isSyncing } = useGoogleFitData();\n```\n\n### useTrackingData\nDados de tracking diÃ¡rio.\n\n```typescript\n// src/hooks/useTrackingData.ts\ninterface UseTrackingDataReturn {\n  todayTracking: DailyTracking | null;\n  weeklyTracking: DailyTracking[];\n  \n  // AÃ§Ãµes\n  updateTracking: (data: Partial<DailyTracking>) => Promise<void>;\n  \n  isLoading: boolean;\n}\n```\n\n### useHealthScore\nScore de saÃºde calculado.\n\n```typescript\n// src/hooks/useHealthScore.ts\ninterface UseHealthScoreReturn {\n  score: number; // 0-100\n  breakdown: ScoreBreakdown;\n  trend: 'up' | 'down' | 'stable';\n  lastUpdated: Date;\n  isLoading: boolean;\n}\n\ninterface ScoreBreakdown {\n  nutrition: number;\n  exercise: number;\n  sleep: number;\n  hydration: number;\n  consistency: number;\n}\n```\n\n---\n\n## ðŸ¥— NutriÃ§Ã£o\n\n### useNutritionData\nDados nutricionais do usuÃ¡rio.\n\n```typescript\n// src/hooks/useNutritionData.ts\ninterface UseNutritionDataReturn {\n  // Metas\n  dailyGoals: NutritionGoals;\n  \n  // Progresso hoje\n  todayProgress: NutritionProgress;\n  \n  // HistÃ³rico\n  weeklyHistory: DailyNutrition[];\n  \n  // Status\n  isLoading: boolean;\n  \n  // AÃ§Ãµes\n  updateGoals: (goals: Partial<NutritionGoals>) => Promise<void>;\n}\n\ninterface NutritionGoals {\n  calories: number;\n  protein: number;\n  carbs: number;\n  fat: number;\n  fiber: number;\n  water: number; // ml\n}\n\ninterface NutritionProgress {\n  caloriesConsumed: number;\n  proteinConsumed: number;\n  carbsConsumed: number;\n  fatConsumed: number;\n  waterConsumed: number;\n}\n```\n\n### useSofiaAnalysis\nAnÃ¡lise de alimentos via Sofia.\n\n```typescript\n// src/hooks/useSofiaAnalysis.ts\ninterface UseSofiaAnalysisReturn {\n  analyze: (imageUrl: string) => Promise<FoodAnalysisResult>;\n  isAnalyzing: boolean;\n  lastAnalysis: FoodAnalysisResult | null;\n  error: Error | null;\n}\n\ninterface FoodAnalysisResult {\n  foods: FoodItem[];\n  totalCalories: number;\n  totalProtein: number;\n  totalCarbs: number;\n  totalFat: number;\n  totalFiber: number;\n  confidence: number;\n  suggestions: string[];\n}\n\n// Uso\nconst { analyze, isAnalyzing } = useSofiaAnalysis();\n\nconst result = await analyze(imageUrl);\n```\n\n### useFoodHistory\nHistÃ³rico de refeiÃ§Ãµes.\n\n```typescript\n// src/hooks/useFoodHistory.ts\ninterface UseFoodHistoryReturn {\n  meals: Meal[];\n  todayMeals: Meal[];\n  \n  // AÃ§Ãµes\n  addMeal: (meal: NewMeal) => Promise<void>;\n  updateMeal: (id: string, data: Partial<Meal>) => Promise<void>;\n  deleteMeal: (id: string) => Promise<void>;\n  \n  // Filtros\n  filterByDate: (date: Date) => Meal[];\n  filterByType: (type: MealType) => Meal[];\n  \n  isLoading: boolean;\n}\n```\n\n### useMealPlanHistory\nHistÃ³rico de planos alimentares.\n\n```typescript\n// src/hooks/useMealPlanHistory.ts\ninterface UseMealPlanHistoryReturn {\n  plans: MealPlan[];\n  activePlan: MealPlan | null;\n  \n  // AÃ§Ãµes\n  createPlan: (plan: NewMealPlan) => Promise<void>;\n  activatePlan: (planId: string) => Promise<void>;\n  deactivatePlan: (planId: string) => Promise<void>;\n  \n  isLoading: boolean;\n}\n```\n\n---\n\n## ðŸ‹ï¸ ExercÃ­cios\n\n### useExerciseLibrary\nBiblioteca de exercÃ­cios.\n\n```typescript\n// src/hooks/useExercisesLibrary.ts\ninterface UseExercisesLibraryReturn {\n  exercises: Exercise[];\n  \n  // Filtros\n  filterByLocation: (location: string) => Exercise[];\n  filterByMuscleGroup: (group: string) => Exercise[];\n  filterByDifficulty: (difficulty: string) => Exercise[];\n  search: (query: string) => Exercise[];\n  \n  isLoading: boolean;\n}\n```\n\n### useExerciseProgram\nPrograma de exercÃ­cios do usuÃ¡rio.\n\n```typescript\n// src/hooks/useExerciseProgram.ts\ninterface UseExerciseProgramReturn {\n  activeProgram: WorkoutProgram | null;\n  programs: WorkoutProgram[];\n  \n  // AÃ§Ãµes\n  createProgram: (program: NewProgram) => Promise<void>;\n  activateProgram: (programId: string) => Promise<void>;\n  completeWorkout: (summary: WorkoutSummary) => Promise<void>;\n  \n  // Hoje\n  todayWorkout: DayWorkout | null;\n  \n  isLoading: boolean;\n}\n```\n\n### useExerciseProgress\nProgresso de exercÃ­cios.\n\n```typescript\n// src/hooks/useExerciseProgress.ts\ninterface UseExerciseProgressReturn {\n  totalWorkouts: number;\n  totalMinutes: number;\n  totalCaloriesBurned: number;\n  \n  weeklyStats: WeeklyExerciseStats;\n  monthlyStats: MonthlyExerciseStats;\n  \n  streakDays: number;\n  \n  isLoading: boolean;\n}\n```\n\n---\n\n## ðŸ¥ SaÃºde/MÃ©dico\n\n### useDrVital (localizado em dr-vital/)\nHook do Dr. Vital.\n\n```typescript\n// src/hooks/dr-vital/useDrVital.ts\ninterface UseDrVitalReturn {\n  // AnÃ¡lises\n  analyses: ExamAnalysis[];\n  latestAnalysis: ExamAnalysis | null;\n  \n  // Chat\n  sendMessage: (message: string, context?: ExamContext) => Promise<string>;\n  chatHistory: ChatMessage[];\n  \n  // AÃ§Ãµes\n  analyzeExam: (fileUrl: string, examType: string) => Promise<ExamAnalysis>;\n  generateReport: (analysisId: string) => Promise<string>; // PDF URL\n  \n  // Status\n  isAnalyzing: boolean;\n  isChatting: boolean;\n}\n```\n\n### useExamAccess\nAcesso a exames do usuÃ¡rio.\n\n```typescript\n// src/hooks/useExamAccess.ts\ninterface UseExamAccessReturn {\n  exams: ExamRecord[];\n  \n  uploadExam: (file: File, examType: string) => Promise<ExamRecord>;\n  deleteExam: (examId: string) => Promise<void>;\n  \n  isUploading: boolean;\n}\n```\n\n---\n\n## ðŸ‘¥ Comunidade\n\n### useFeedPosts\nPosts do feed.\n\n```typescript\n// src/hooks/useFeedPosts.ts\ninterface UseFeedPostsReturn {\n  posts: Post[];\n  myPosts: Post[];\n  \n  // AÃ§Ãµes\n  createPost: (post: NewPost) => Promise<void>;\n  likePost: (postId: string) => Promise<void>;\n  unlikePost: (postId: string) => Promise<void>;\n  deletePost: (postId: string) => Promise<void>;\n  \n  // PaginaÃ§Ã£o\n  loadMore: () => void;\n  hasMore: boolean;\n  \n  isLoading: boolean;\n}\n```\n\n### useStories\nStories.\n\n```typescript\n// src/hooks/useStories.ts\ninterface UseStoriesReturn {\n  stories: Story[];\n  myStories: Story[];\n  \n  createStory: (story: NewStory) => Promise<void>;\n  viewStory: (storyId: string) => Promise<void>;\n  deleteStory: (storyId: string) => Promise<void>;\n  \n  isLoading: boolean;\n}\n```\n\n### useFollow\nSistema de seguir.\n\n```typescript\n// src/hooks/useFollow.ts\ninterface UseFollowReturn {\n  followers: UserProfile[];\n  following: UserProfile[];\n  followersCount: number;\n  followingCount: number;\n  \n  follow: (userId: string) => Promise<void>;\n  unfollow: (userId: string) => Promise<void>;\n  isFollowing: (userId: string) => boolean;\n  \n  isLoading: boolean;\n}\n```\n\n### useDirectMessages\nMensagens diretas.\n\n```typescript\n// src/hooks/useDirectMessages.ts\ninterface UseDirectMessagesReturn {\n  conversations: Conversation[];\n  \n  sendMessage: (userId: string, content: string) => Promise<void>;\n  markAsRead: (conversationId: string) => Promise<void>;\n  \n  unreadCount: number;\n  isLoading: boolean;\n}\n```\n\n---\n\n## ðŸ”§ Utilidades\n\n### useCamera\nAcesso Ã  cÃ¢mera.\n\n```typescript\n// src/hooks/useCamera.ts\ninterface UseCameraReturn {\n  takePhoto: () => Promise<CapturedPhoto>;\n  selectFromGallery: () => Promise<CapturedPhoto>;\n  isAvailable: boolean;\n  hasPermission: boolean;\n  requestPermission: () => Promise<boolean>;\n}\n```\n\n### useHaptics\nFeedback hÃ¡ptico.\n\n```typescript\n// src/hooks/useHaptics.ts\ninterface UseHapticsReturn {\n  vibrate: (style?: 'light' | 'medium' | 'heavy') => void;\n  impact: (style?: 'light' | 'medium' | 'heavy') => void;\n  notification: (type?: 'success' | 'warning' | 'error') => void;\n  isAvailable: boolean;\n}\n\n// Uso\nconst { vibrate, impact } = useHaptics();\n\nimpact('medium');\n```\n\n### useNetworkStatus\nStatus da rede.\n\n```typescript\n// src/hooks/useNetworkStatus.ts\ninterface UseNetworkStatusReturn {\n  isOnline: boolean;\n  connectionType: 'wifi' | '4g' | '3g' | '2g' | 'unknown';\n  effectiveType: string;\n}\n```\n\n### useReducedMotion\nPreferÃªncia de movimento reduzido.\n\n```typescript\n// src/hooks/useReducedMotion.ts\nconst prefersReducedMotion: boolean = useReducedMotion();\n```\n\n### useDebouncedState\nState com debounce.\n\n```typescript\n// src/hooks/useDebouncedState.ts\nconst [value, setValue, debouncedValue] = useDebouncedState<T>(\n  initialValue: T,\n  delay: number = 300\n);\n```\n\n### useLongPress\nDetecÃ§Ã£o de long press.\n\n```typescript\n// src/hooks/useLongPress.ts\nconst longPressProps = useLongPress(\n  callback: () => void,\n  options?: { delay?: number; threshold?: number }\n);\n\n<button {...longPressProps}>Hold me</button>\n```\n\n### useSwipeGesture\nDetecÃ§Ã£o de gestos de swipe.\n\n```typescript\n// src/hooks/useSwipeGesture.ts\nconst { ref, direction } = useSwipeGesture({\n  onSwipeLeft?: () => void;\n  onSwipeRight?: () => void;\n  onSwipeUp?: () => void;\n  onSwipeDown?: () => void;\n  threshold?: number;\n});\n```\n\n### useMediaUpload\nUpload de mÃ­dia.\n\n```typescript\n// src/hooks/useMediaUpload.ts\ninterface UseMediaUploadReturn {\n  upload: (file: File, bucket: string) => Promise<string>;\n  uploadProgress: number;\n  isUploading: boolean;\n  error: Error | null;\n}\n```\n\n### use-mobile\nDetecÃ§Ã£o de mobile.\n\n```typescript\n// src/hooks/use-mobile.tsx\nconst isMobile: boolean = useIsMobile();\n```\n\n### use-toast\nSistema de toast.\n\n```typescript\n// src/hooks/use-toast.ts\nconst { toast } = useToast();\n\ntoast({\n  title: \"Sucesso!\",\n  description: \"OperaÃ§Ã£o realizada.\",\n  variant: \"default\" | \"destructive\",\n});\n```\n\n---\n\n## ðŸ“ PadrÃµes de Hooks\n\n### Estrutura Recomendada\n\n```typescript\n// useMyHook.ts\nimport { useState, useEffect, useCallback } from 'react';\nimport { useQuery, useMutation } from '@tanstack/react-query';\nimport { supabase } from '@/integrations/supabase/client';\n\ninterface UseMyHookReturn {\n  data: MyData | null;\n  isLoading: boolean;\n  error: Error | null;\n  action: (param: string) => Promise<void>;\n}\n\nexport function useMyHook(param: string): UseMyHookReturn {\n  // Query para buscar dados\n  const { data, isLoading, error } = useQuery({\n    queryKey: ['my-data', param],\n    queryFn: async () => {\n      const { data, error } = await supabase\n        .from('my_table')\n        .select('*')\n        .eq('param', param);\n      \n      if (error) throw error;\n      return data;\n    },\n  });\n\n  // Mutation para aÃ§Ãµes\n  const mutation = useMutation({\n    mutationFn: async (value: string) => {\n      const { error } = await supabase\n        .from('my_table')\n        .insert({ value });\n      \n      if (error) throw error;\n    },\n  });\n\n  const action = useCallback(async (value: string) => {\n    await mutation.mutateAsync(value);\n  }, [mutation]);\n\n  return {\n    data: data ?? null,\n    isLoading,\n    error: error as Error | null,\n    action,\n  };\n}\n```\n\n### ConvenÃ§Ãµes\n\n1. **Nomes**: Prefixo `use` + camelCase\n2. **Retorno**: Interface tipada `Use[Name]Return`\n3. **Queries**: Usar React Query para cache\n4. **Mutations**: Usar useMutation para aÃ§Ãµes\n5. **Callbacks**: Usar useCallback para funÃ§Ãµes\n\n---\n\n## ðŸ“ PrÃ³ximos Passos\n\n- Consulte `03_COMPONENTS_CATALOG.md` para componentes que usam estes hooks\n- Consulte `05_EDGE_FUNCTIONS.md` para APIs chamadas pelos hooks\n",
      "sections": [
        "# ðŸª ReferÃªncia de Hooks Customizados",
        "## ðŸ“Š VisÃ£o Geral",
        "## ðŸ” AutenticaÃ§Ã£o",
        "### useAuth",
        "### useAdminMode",
        "### useAdminPermissions",
        "## ðŸŽ® GamificaÃ§Ã£o",
        "### useGamificationUnified",
        "### useRealRanking",
        "### useChallenges",
        "### useDailyMissions",
        "### useFlashChallenge",
        "### useUserPoints",
        "### useUserXP",
        "### useUserStreak",
        "## ðŸ‘¤ Dados de UsuÃ¡rio",
        "### useUserProfile",
        "### useHealthData",
        "### useGoogleFitData",
        "### useTrackingData",
        "### useHealthScore",
        "## ðŸ¥— NutriÃ§Ã£o",
        "### useNutritionData",
        "### useSofiaAnalysis",
        "### useFoodHistory",
        "### useMealPlanHistory",
        "## ðŸ‹ï¸ ExercÃ­cios",
        "### useExerciseLibrary",
        "### useExerciseProgram",
        "### useExerciseProgress",
        "## ðŸ¥ SaÃºde/MÃ©dico",
        "### useDrVital (localizado em dr-vital/)",
        "### useExamAccess",
        "## ðŸ‘¥ Comunidade",
        "### useFeedPosts",
        "### useStories",
        "### useFollow",
        "### useDirectMessages",
        "## ðŸ”§ Utilidades",
        "### useCamera",
        "### useHaptics",
        "### useNetworkStatus",
        "### useReducedMotion",
        "### useDebouncedState",
        "### useLongPress",
        "### useSwipeGesture",
        "### useMediaUpload",
        "### use-mobile",
        "### use-toast",
        "## ðŸ“ PadrÃµes de Hooks",
        "### Estrutura Recomendada",
        "### ConvenÃ§Ãµes",
        "## ðŸ“ PrÃ³ximos Passos"
      ],
      "code_blocks": 80,
      "links": []
    },
    "05_EDGE_FUNCTIONS.md": {
      "path": "docs/05_EDGE_FUNCTIONS.md",
      "exists": true,
      "lines": 853,
      "size_kb": 14.232421875,
      "content": "# âš¡ Edge Functions - API Backend\n\n> DocumentaÃ§Ã£o gerada em: 2026-01-16\n> Total de Edge Functions: 89\n\n---\n\n## ðŸ“Š VisÃ£o Geral\n\n| Categoria | Quantidade | DescriÃ§Ã£o |\n|-----------|------------|-----------|\n| IA/AnÃ¡lise | 15 | Sofia, Dr. Vital, YOLO |\n| WhatsApp | 15 | Webhooks e automaÃ§Ãµes |\n| Google Fit | 5 | SincronizaÃ§Ã£o e OAuth |\n| NutriÃ§Ã£o | 8 | CÃ¡lculos e planos |\n| MÃ©dico | 6 | Exames e relatÃ³rios |\n| NotificaÃ§Ãµes | 4 | Email e push |\n| Utilidades | 36 | Cache, upload, etc |\n\n---\n\n## ðŸ¤– IA/AnÃ¡lise\n\n### sofia-image-analysis\nAnÃ¡lise de imagens de alimentos usando YOLO + Gemini.\n\n```\nPOST /functions/v1/sofia-image-analysis\n```\n\n**Headers:**\n```\nAuthorization: Bearer <user_token>\nContent-Type: application/json\n```\n\n**Request Body:**\n```typescript\ninterface SofiaImageAnalysisRequest {\n  imageUrl: string;           // URL da imagem\n  imageBase64?: string;       // OU base64 da imagem\n  analysisType?: 'food' | 'meal' | 'product';\n  userId?: string;            // Opcional, extraÃ­do do token\n}\n```\n\n**Response:**\n```typescript\ninterface SofiaImageAnalysisResponse {\n  success: boolean;\n  data: {\n    foods: FoodItem[];\n    totalCalories: number;\n    totalProtein: number;\n    totalCarbs: number;\n    totalFat: number;\n    totalFiber: number;\n    confidence: number;\n    yoloDetections?: YoloDetection[];\n    geminiAnalysis?: string;\n    processingTime: number;\n  };\n  cached?: boolean;\n}\n\ninterface FoodItem {\n  name: string;\n  quantity: string;\n  portion: string;\n  calories: number;\n  protein: number;\n  carbs: number;\n  fat: number;\n  fiber: number;\n  confidence: number;\n}\n```\n\n**Exemplo:**\n```bash\ncurl -X POST \\\n  https://ciszqtlaacrhfwsqnvjr.supabase.co/functions/v1/sofia-image-analysis \\\n  -H \"Authorization: Bearer $TOKEN\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"imageUrl\": \"https://storage.example.com/meal.jpg\"}'\n```\n\n---\n\n### analyze-medical-exam\nAnÃ¡lise de exames mÃ©dicos com OCR + IA.\n\n```\nPOST /functions/v1/analyze-medical-exam\n```\n\n**Request Body:**\n```typescript\ninterface AnalyzeMedicalExamRequest {\n  fileUrl: string;            // URL do arquivo (PDF/imagem)\n  examType: string;           // Tipo do exame\n  userId: string;\n}\n```\n\n**Response:**\n```typescript\ninterface AnalyzeMedicalExamResponse {\n  success: boolean;\n  data: {\n    examId: string;\n    extractedText: string;\n    extractedData: Record<string, any>;\n    interpretation: string;\n    recommendations: string[];\n    healthIndicators: HealthIndicator[];\n    riskLevel: 'low' | 'medium' | 'high';\n    processingStatus: string;\n  };\n}\n\ninterface HealthIndicator {\n  name: string;\n  value: string;\n  unit: string;\n  referenceRange: string;\n  status: 'normal' | 'attention' | 'critical';\n}\n```\n\n---\n\n### dr-vital-chat\nChat com Dr. Vital (IA mÃ©dica).\n\n```\nPOST /functions/v1/dr-vital-chat\n```\n\n**Request Body:**\n```typescript\ninterface DrVitalChatRequest {\n  message: string;\n  userId: string;\n  conversationId?: string;\n  examContext?: {\n    examId: string;\n    examType: string;\n    extractedData: Record<string, any>;\n  };\n}\n```\n\n**Response:**\n```typescript\ninterface DrVitalChatResponse {\n  success: boolean;\n  data: {\n    response: string;\n    conversationId: string;\n    suggestions?: string[];\n    followUpQuestions?: string[];\n  };\n}\n```\n\n---\n\n### food-analysis\nAnÃ¡lise nutricional de texto.\n\n```\nPOST /functions/v1/food-analysis\n```\n\n**Request Body:**\n```typescript\ninterface FoodAnalysisRequest {\n  foodDescription: string;    // \"2 ovos fritos com bacon\"\n  userId?: string;\n}\n```\n\n**Response:**\n```typescript\ninterface FoodAnalysisResponse {\n  success: boolean;\n  data: {\n    foods: FoodItem[];\n    totalNutrition: NutritionSummary;\n    suggestions: string[];\n  };\n}\n```\n\n---\n\n### nutrition-calc\nCÃ¡lculo nutricional determinÃ­stico.\n\n```\nPOST /functions/v1/nutrition-calc\n```\n\n**Request Body:**\n```typescript\ninterface NutritionCalcRequest {\n  foods: {\n    name: string;\n    quantity: number;\n    unit: string;\n  }[];\n}\n```\n\n**Response:**\n```typescript\ninterface NutritionCalcResponse {\n  success: boolean;\n  data: {\n    items: CalculatedFood[];\n    totals: NutritionTotals;\n  };\n}\n```\n\n---\n\n### nutrition-daily-summary\nResumo nutricional diÃ¡rio.\n\n```\nGET /functions/v1/nutrition-daily-summary?userId={userId}&date={YYYY-MM-DD}\n```\n\n**Response:**\n```typescript\ninterface NutritionDailySummaryResponse {\n  success: boolean;\n  data: {\n    date: string;\n    meals: Meal[];\n    totals: NutritionTotals;\n    goals: NutritionGoals;\n    progress: NutritionProgress;\n    aiInsights: string;\n  };\n}\n```\n\n---\n\n## ðŸ“± WhatsApp\n\n### whatsapp-webhook-unified\nWebhook unificado para mensagens WhatsApp.\n\n```\nPOST /functions/v1/whatsapp-webhook-unified\n```\n\n**Request Body (Evolution API):**\n```typescript\ninterface WhatsAppWebhookRequest {\n  event: string;\n  instance: string;\n  data: {\n    key: {\n      remoteJid: string;\n      fromMe: boolean;\n      id: string;\n    };\n    message: {\n      conversation?: string;\n      imageMessage?: {\n        url: string;\n        mimetype: string;\n      };\n    };\n  };\n}\n```\n\n**Processamento:**\n1. Identifica tipo de mensagem (texto, imagem, Ã¡udio)\n2. Busca usuÃ¡rio pelo nÃºmero de telefone\n3. Se imagem: analisa com Sofia\n4. Se texto: processa com IA\n5. Envia resposta via Evolution API\n\n---\n\n### whatsapp-weekly-report\nEnvia relatÃ³rio semanal via WhatsApp.\n\n```\nPOST /functions/v1/whatsapp-weekly-report\n```\n\n**Request Body:**\n```typescript\ninterface WeeklyReportRequest {\n  userId: string;\n  phoneNumber: string;\n}\n```\n\n---\n\n### whatsapp-daily-motivation\nEnvia mensagem motivacional diÃ¡ria.\n\n```\nPOST /functions/v1/whatsapp-daily-motivation\n```\n\n**Request Body:**\n```typescript\ninterface DailyMotivationRequest {\n  userId: string;\n  phoneNumber: string;\n  messageType?: 'motivation' | 'reminder' | 'tip';\n}\n```\n\n---\n\n### whatsapp-goal-reminders\nLembretes de metas via WhatsApp.\n\n```\nPOST /functions/v1/whatsapp-goal-reminders\n```\n\n---\n\n## ðŸƒ Google Fit\n\n### google-fit-sync\nSincroniza dados do Google Fit.\n\n```\nPOST /functions/v1/google-fit-sync\n```\n\n**Request Body:**\n```typescript\ninterface GoogleFitSyncRequest {\n  userId: string;\n  startDate?: string;   // YYYY-MM-DD\n  endDate?: string;     // YYYY-MM-DD\n  dataTypes?: string[]; // ['steps', 'calories', 'heart_rate', 'sleep']\n}\n```\n\n**Response:**\n```typescript\ninterface GoogleFitSyncResponse {\n  success: boolean;\n  data: {\n    syncedDays: number;\n    lastSyncAt: string;\n    summary: {\n      steps: number;\n      calories: number;\n      activeMinutes: number;\n      sleepHours: number;\n    };\n  };\n}\n```\n\n---\n\n### google-fit-callback\nCallback OAuth do Google Fit.\n\n```\nGET /functions/v1/google-fit-callback?code={code}&state={userId}\n```\n\n---\n\n### google-fit-token\nGerenciamento de tokens.\n\n```\nPOST /functions/v1/google-fit-token\n```\n\n**Request Body:**\n```typescript\ninterface GoogleFitTokenRequest {\n  action: 'refresh' | 'revoke';\n  userId: string;\n}\n```\n\n---\n\n### google-fit-ai-analysis\nAnÃ¡lise IA dos dados do Google Fit.\n\n```\nPOST /functions/v1/google-fit-ai-analysis\n```\n\n**Request Body:**\n```typescript\ninterface GoogleFitAIAnalysisRequest {\n  userId: string;\n  period: 'day' | 'week' | 'month';\n}\n```\n\n**Response:**\n```typescript\ninterface GoogleFitAIAnalysisResponse {\n  success: boolean;\n  data: {\n    insights: string[];\n    recommendations: string[];\n    trends: {\n      metric: string;\n      trend: 'improving' | 'stable' | 'declining';\n      change: number;\n    }[];\n    score: number;\n  };\n}\n```\n\n---\n\n## ðŸ¥— NutriÃ§Ã£o\n\n### generate-meal-plan-taco\nGera plano alimentar usando tabela TACO.\n\n```\nPOST /functions/v1/generate-meal-plan-taco\n```\n\n**Request Body:**\n```typescript\ninterface GenerateMealPlanRequest {\n  userId: string;\n  preferences: {\n    calories: number;\n    mealsPerDay: number;\n    dietaryRestrictions: string[];\n    preferences: string[];\n    budget?: 'low' | 'medium' | 'high';\n  };\n  duration: number; // dias\n}\n```\n\n**Response:**\n```typescript\ninterface GenerateMealPlanResponse {\n  success: boolean;\n  data: {\n    planId: string;\n    days: MealPlanDay[];\n    shoppingList: ShoppingItem[];\n    nutritionSummary: NutritionSummary;\n  };\n}\n```\n\n---\n\n### nutrition-planner\nPlanejador nutricional.\n\n```\nPOST /functions/v1/nutrition-planner\n```\n\n---\n\n### enrich-food-data\nEnriquece dados de alimentos.\n\n```\nPOST /functions/v1/enrich-food-data\n```\n\n**Request Body:**\n```typescript\ninterface EnrichFoodDataRequest {\n  foodName: string;\n  portion?: string;\n}\n```\n\n**Response:**\n```typescript\ninterface EnrichFoodDataResponse {\n  success: boolean;\n  data: {\n    name: string;\n    aliases: string[];\n    category: string;\n    nutrition: NutritionInfo;\n    commonPortions: Portion[];\n    healthTips: string[];\n  };\n}\n```\n\n---\n\n## ðŸ“„ MÃ©dico/RelatÃ³rios\n\n### generate-medical-pdf\nGera PDF de relatÃ³rio mÃ©dico.\n\n```\nPOST /functions/v1/generate-medical-pdf\n```\n\n**Request Body:**\n```typescript\ninterface GenerateMedicalPDFRequest {\n  analysisId: string;\n  userId: string;\n  includeCharts?: boolean;\n  includeRecommendations?: boolean;\n}\n```\n\n**Response:**\n```typescript\ninterface GenerateMedicalPDFResponse {\n  success: boolean;\n  data: {\n    pdfUrl: string;\n    expiresAt: string;\n  };\n}\n```\n\n---\n\n### generate-medical-report\nGera relatÃ³rio mÃ©dico completo.\n\n```\nPOST /functions/v1/generate-medical-report\n```\n\n---\n\n### premium-medical-report\nRelatÃ³rio mÃ©dico premium (detalhado).\n\n```\nPOST /functions/v1/premium-medical-report\n```\n\n---\n\n### dr-vital-weekly-report\nRelatÃ³rio semanal do Dr. Vital.\n\n```\nPOST /functions/v1/dr-vital-weekly-report\n```\n\n---\n\n## ðŸ“§ NotificaÃ§Ãµes\n\n### send-email\nEnvio de emails via Resend.\n\n```\nPOST /functions/v1/send-email\n```\n\n**Request Body:**\n```typescript\ninterface SendEmailRequest {\n  to: string;\n  subject: string;\n  html?: string;\n  template?: string;\n  templateData?: Record<string, any>;\n}\n```\n\n---\n\n### goal-notifications\nNotificaÃ§Ãµes de metas.\n\n```\nPOST /functions/v1/goal-notifications\n```\n\n**Request Body:**\n```typescript\ninterface GoalNotificationRequest {\n  userId: string;\n  notificationType: 'reminder' | 'achievement' | 'warning';\n  goalId?: string;\n}\n```\n\n---\n\n## ðŸ”§ Utilidades\n\n### media-upload\nUpload de mÃ­dia para Storage.\n\n```\nPOST /functions/v1/media-upload\n```\n\n**Request Body (multipart/form-data):**\n```\nfile: File\nbucket: string\npath?: string\n```\n\n**Response:**\n```typescript\ninterface MediaUploadResponse {\n  success: boolean;\n  data: {\n    url: string;\n    path: string;\n    size: number;\n    mimeType: string;\n  };\n}\n```\n\n---\n\n### cache-manager\nGerenciamento de cache.\n\n```\nPOST /functions/v1/cache-manager\n```\n\n**Request Body:**\n```typescript\ninterface CacheManagerRequest {\n  action: 'get' | 'set' | 'delete' | 'clear';\n  key?: string;\n  value?: any;\n  ttl?: number; // segundos\n}\n```\n\n---\n\n### rate-limiter\nRate limiting para APIs.\n\n```\nPOST /functions/v1/rate-limiter\n```\n\n**Request Body:**\n```typescript\ninterface RateLimiterRequest {\n  key: string;\n  limit: number;\n  window: number; // segundos\n}\n```\n\n**Response:**\n```typescript\ninterface RateLimiterResponse {\n  allowed: boolean;\n  remaining: number;\n  resetAt: string;\n}\n```\n\n---\n\n### detect-image-type\nDetecta tipo de imagem (comida, exame, etc).\n\n```\nPOST /functions/v1/detect-image-type\n```\n\n**Request Body:**\n```typescript\ninterface DetectImageTypeRequest {\n  imageUrl: string;\n}\n```\n\n**Response:**\n```typescript\ninterface DetectImageTypeResponse {\n  success: boolean;\n  data: {\n    type: 'food' | 'medical_exam' | 'document' | 'other';\n    confidence: number;\n    suggestedAction: string;\n  };\n}\n```\n\n---\n\n## ðŸ”Œ IntegraÃ§Ãµes Externas\n\n### YOLO Service\nServiÃ§o de detecÃ§Ã£o de objetos.\n\n**URL:** `https://yolo-service-yolo-detection.{host}.easypanel.host`\n\n**Endpoint:** `POST /detect`\n\n**Request:**\n```typescript\ninterface YoloRequest {\n  image_url: string;\n  confidence_threshold?: number;\n}\n```\n\n**Response:**\n```typescript\ninterface YoloResponse {\n  detections: {\n    class: string;\n    confidence: number;\n    bbox: [number, number, number, number];\n  }[];\n  processing_time: number;\n}\n```\n\n---\n\n### Gemini API\nUsado para anÃ¡lise de texto e imagem.\n\n**ConfiguraÃ§Ã£o no cÃ³digo:**\n```typescript\nconst genAI = new GoogleGenerativeAI(GOOGLE_AI_API_KEY);\nconst model = genAI.getGenerativeModel({ model: \"gemini-1.5-flash\" });\n\nconst result = await model.generateContent([\n  { text: prompt },\n  { inlineData: { mimeType: \"image/jpeg\", data: base64 } }\n]);\n```\n\n---\n\n### Evolution API (WhatsApp)\nAPI para envio de mensagens WhatsApp.\n\n**URL:** Configurado via N8N_WHATSAPP_WEBHOOK\n\n**Endpoint:** `POST /message/sendText/{instance}`\n\n**Request:**\n```typescript\ninterface EvolutionSendTextRequest {\n  number: string;\n  text: string;\n}\n```\n\n---\n\n## ðŸ“ PadrÃµes de Edge Functions\n\n### Estrutura BÃ¡sica\n\n```typescript\n// supabase/functions/my-function/index.ts\nimport { serve } from \"https://deno.land/std@0.168.0/http/server.ts\";\nimport { createClient } from 'https://esm.sh/@supabase/supabase-js@2';\n\nconst corsHeaders = {\n  'Access-Control-Allow-Origin': '*',\n  'Access-Control-Allow-Headers': 'authorization, x-client-info, apikey, content-type',\n};\n\nserve(async (req) => {\n  // Handle CORS preflight\n  if (req.method === 'OPTIONS') {\n    return new Response(null, { headers: corsHeaders });\n  }\n\n  try {\n    // Verificar autenticaÃ§Ã£o\n    const authHeader = req.headers.get('Authorization');\n    if (!authHeader) {\n      throw new Error('No authorization header');\n    }\n\n    // Criar cliente Supabase\n    const supabase = createClient(\n      Deno.env.get('SUPABASE_URL')!,\n      Deno.env.get('SUPABASE_SERVICE_ROLE_KEY')!\n    );\n\n    // Parse request body\n    const body = await req.json();\n\n    // LÃ³gica da funÃ§Ã£o\n    const result = await processRequest(body, supabase);\n\n    return new Response(\n      JSON.stringify({ success: true, data: result }),\n      { headers: { ...corsHeaders, 'Content-Type': 'application/json' } }\n    );\n  } catch (error) {\n    console.error('Error:', error);\n    return new Response(\n      JSON.stringify({ success: false, error: error.message }),\n      { status: 400, headers: { ...corsHeaders, 'Content-Type': 'application/json' } }\n    );\n  }\n});\n```\n\n### VariÃ¡veis de Ambiente\n\n| VariÃ¡vel | DescriÃ§Ã£o | ObrigatÃ³ria |\n|----------|-----------|-------------|\n| `SUPABASE_URL` | URL do Supabase | Sim |\n| `SUPABASE_SERVICE_ROLE_KEY` | Chave service role | Sim |\n| `GOOGLE_AI_API_KEY` | Chave Gemini | Para IA |\n| `YOLO_SERVICE_URL` | URL do YOLO | Para detecÃ§Ã£o |\n| `N8N_WHATSAPP_WEBHOOK` | Webhook WhatsApp | Para WhatsApp |\n| `RESEND_API_KEY` | Chave Resend | Para emails |\n\n---\n\n## ðŸ“ PrÃ³ximos Passos\n\n- Consulte `07_AI_SYSTEMS.md` para detalhes do fluxo de IA\n- Consulte `09_ENVIRONMENT_VARS.md` para configuraÃ§Ã£o completa\n",
      "sections": [
        "# âš¡ Edge Functions - API Backend",
        "## ðŸ“Š VisÃ£o Geral",
        "## ðŸ¤– IA/AnÃ¡lise",
        "### sofia-image-analysis",
        "### analyze-medical-exam",
        "### dr-vital-chat",
        "### food-analysis",
        "### nutrition-calc",
        "### nutrition-daily-summary",
        "## ðŸ“± WhatsApp",
        "### whatsapp-webhook-unified",
        "### whatsapp-weekly-report",
        "### whatsapp-daily-motivation",
        "### whatsapp-goal-reminders",
        "## ðŸƒ Google Fit",
        "### google-fit-sync",
        "### google-fit-callback",
        "### google-fit-token",
        "### google-fit-ai-analysis",
        "## ðŸ¥— NutriÃ§Ã£o",
        "### generate-meal-plan-taco",
        "### nutrition-planner",
        "### enrich-food-data",
        "## ðŸ“„ MÃ©dico/RelatÃ³rios",
        "### generate-medical-pdf",
        "### generate-medical-report",
        "### premium-medical-report",
        "### dr-vital-weekly-report",
        "## ðŸ“§ NotificaÃ§Ãµes",
        "### send-email",
        "### goal-notifications",
        "## ðŸ”§ Utilidades",
        "### media-upload",
        "### cache-manager",
        "### rate-limiter",
        "### detect-image-type",
        "## ðŸ”Œ IntegraÃ§Ãµes Externas",
        "### YOLO Service",
        "### Gemini API",
        "### Evolution API (WhatsApp)",
        "## ðŸ“ PadrÃµes de Edge Functions",
        "### Estrutura BÃ¡sica",
        "### VariÃ¡veis de Ambiente",
        "## ðŸ“ PrÃ³ximos Passos"
      ],
      "code_blocks": 136,
      "links": []
    },
    "06_NAVIGATION_FLOWS.md": {
      "path": "docs/06_NAVIGATION_FLOWS.md",
      "exists": true,
      "lines": 422,
      "size_kb": 14.0634765625,
      "content": "# ðŸ§­ Fluxos de NavegaÃ§Ã£o\n\n> DocumentaÃ§Ã£o gerada em: 2026-01-16\n> Total de Rotas: 33\n\n---\n\n## ðŸ“Š VisÃ£o Geral\n\n| Categoria | Quantidade | DescriÃ§Ã£o |\n|-----------|------------|-----------|\n| PÃºblicas | 5 | Acesso sem login |\n| Dashboard | 8 | Ãrea principal |\n| Features | 12 | Funcionalidades |\n| Admin | 8 | Painel admin |\n\n---\n\n## ðŸ—ºï¸ Mapa de Rotas\n\n### Rotas PÃºblicas\n\n| Rota | Componente | DescriÃ§Ã£o |\n|------|------------|-----------|\n| `/auth` | `AuthPage` | Login e cadastro |\n| `/terms` | `TermsPage` | Termos de uso |\n| `/termos` | `TermsPage` | Termos (PT) |\n| `/privacidade` | `TermsPage` | PolÃ­tica privacidade |\n| `/install` | `Install` | InstalaÃ§Ã£o PWA |\n| `/public-report/:id` | `PublicReport` | RelatÃ³rio pÃºblico |\n| `/public-post/:id` | `PublicPostPage` | Post pÃºblico |\n\n### Rotas Protegidas - Dashboard\n\n| Rota | Componente | DescriÃ§Ã£o |\n|------|------------|-----------|\n| `/` | `Dashboard` | Dashboard principal |\n| `/dashboard` | `Dashboard` | Dashboard (alias) |\n| `/dashboard/tracking` | `NutritionTrackingPage` | Tracking nutricional |\n| `/dashboard/goals` | `GoalsPageV2` | Metas |\n| `/dashboard/progress` | `ProgressPage` | Progresso |\n| `/dashboard/challenges` | `ChallengesV2Page` | Desafios |\n| `/dashboard/profile` | `UserProfile` | Perfil |\n| `/dashboard/settings` | `Settings` | ConfiguraÃ§Ãµes |\n\n### Rotas Protegidas - Features\n\n| Rota | Componente | DescriÃ§Ã£o |\n|------|------------|-----------|\n| `/sofia` | `SofiaPage` | Chat Sofia |\n| `/sofia-nutricional` | `SofiaNutricionalPage` | Sofia nutriÃ§Ã£o |\n| `/nutricao` | `NutritionTrackingPage` | NutriÃ§Ã£o |\n| `/exercicios` | `ExercisePage` | ExercÃ­cios |\n| `/desafios` | `ChallengesV2Page` | Desafios |\n| `/dr-vital-enhanced` | `DrVitalEnhancedPage` | Dr. Vital |\n| `/dr-vital` | `UserDrVitalPage` | Dr. Vital usuÃ¡rio |\n| `/anamnese` | `AnamnesisPage` | Anamnese |\n| `/google-fit-dashboard` | `GoogleFitPremiumDashboard` | Google Fit |\n| `/google-fit-callback` | `GoogleFitCallback` | OAuth callback |\n| `/health-feed` | `HealthFeedPage` | Feed social |\n| `/comunidade` | `HealthFeedPage` | Comunidade |\n\n### Rotas Admin\n\n| Rota | Componente | DescriÃ§Ã£o |\n|------|------------|-----------|\n| `/admin` | `AdminPage` | Painel admin |\n| `/admin/dashboard` | `AdminDashboardPage` | Dashboard admin |\n| `/admin/users` | `UserManagementPage` | UsuÃ¡rios |\n| `/admin/ai-config` | `AIConfigPage` | Config IA |\n| `/admin/system-health` | `SystemHealthPage` | SaÃºde sistema |\n| `/admin/storage` | `StoragePage` | Storage |\n| `/admin/analytics` | `AnalyticsPage` | Analytics |\n| `/admin/logs` | `LogsPage` | Logs |\n\n---\n\n## ðŸ” Fluxo de AutenticaÃ§Ã£o\n\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚                      USUÃRIO ACESSA APP                      â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                                  â”‚\n                                  â–¼\n                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n                    â”‚   Tem sessÃ£o ativa?     â”‚\n                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                                  â”‚\n                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n                    â”‚                           â”‚\n                    â–¼ NÃƒO                       â–¼ SIM\n          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n          â”‚    /auth        â”‚         â”‚ Verificar token â”‚\n          â”‚  Login/Signup   â”‚         â”‚    vÃ¡lido       â”‚\n          â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                   â”‚                           â”‚\n                   â–¼                           â”‚\n          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚\n          â”‚  AutenticaÃ§Ã£o   â”‚                  â”‚\n          â”‚    Supabase     â”‚                  â”‚\n          â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚\n                   â”‚                           â”‚\n                   â”‚ SUCESSO                   â”‚\n                   â”‚                           â”‚\n                   â–¼                           â–¼\n          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n          â”‚         Onboarding completo?            â”‚\n          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                            â”‚\n              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n              â”‚                           â”‚\n              â–¼ NÃƒO                       â–¼ SIM\n    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n    â”‚   Onboarding    â”‚         â”‚    Dashboard    â”‚\n    â”‚      Flow       â”‚         â”‚   Principal     â”‚\n    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n             â”‚\n             â”‚ COMPLETO\n             â”‚\n             â–¼\n    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n    â”‚    Dashboard    â”‚\n    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n---\n\n## ðŸ‘¤ Fluxo de Onboarding\n\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚                         ONBOARDING FLOW                           â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                                  â”‚\n                                  â–¼\n                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n                    â”‚   Step 1: Boas-vindas   â”‚\n                    â”‚   Nome, foto perfil     â”‚\n                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                                  â”‚\n                                  â–¼\n                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n                    â”‚   Step 2: Dados FÃ­sicos â”‚\n                    â”‚   Peso, altura, idade   â”‚\n                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                                  â”‚\n                                  â–¼\n                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n                    â”‚   Step 3: Objetivos     â”‚\n                    â”‚   Metas de saÃºde        â”‚\n                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                                  â”‚\n                                  â–¼\n                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n                    â”‚   Step 4: PreferÃªncias  â”‚\n                    â”‚   Alimentares           â”‚\n                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                                  â”‚\n                                  â–¼\n                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n                    â”‚   Step 5: NÃ­vel Ativ.   â”‚\n                    â”‚   FrequÃªncia exercÃ­cio  â”‚\n                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                                  â”‚\n                                  â–¼\n                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n                    â”‚   Step 6: Conectar      â”‚\n                    â”‚   Google Fit (opcional) â”‚\n                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                                  â”‚\n                                  â–¼\n                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n                    â”‚   Salvar perfil         â”‚\n                    â”‚   onboarding_completed  â”‚\n                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                                  â”‚\n                                  â–¼\n                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n                    â”‚      â†’ Dashboard        â”‚\n                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n---\n\n## ðŸ“± NavegaÃ§Ã£o Mobile\n\n### Bottom Navigation\n\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚                                                             â”‚\nâ”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚\nâ”‚   â”‚  Home   â”‚  â”‚  Sofia  â”‚  â”‚ Nutri   â”‚  â”‚ Perfil  â”‚       â”‚\nâ”‚   â”‚   ðŸ     â”‚  â”‚   ðŸ¤–    â”‚  â”‚   ðŸ¥—    â”‚  â”‚   ðŸ‘¤    â”‚       â”‚\nâ”‚   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜       â”‚\nâ”‚        â”‚            â”‚            â”‚            â”‚             â”‚\nâ”‚        â–¼            â–¼            â–¼            â–¼             â”‚\nâ”‚   /dashboard    /sofia     /nutricao    /profile           â”‚\nâ”‚                                                             â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n### Gestos Suportados\n\n| Gesto | AÃ§Ã£o | Contexto |\n|-------|------|----------|\n| Swipe Left | PrÃ³ximo item | CarrossÃ©is, Stories |\n| Swipe Right | Item anterior | CarrossÃ©is, Stories |\n| Swipe Down | Atualizar | Listas, Feed |\n| Long Press | Menu contexto | Posts, Cards |\n\n### Header Mobile\n\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚  â†  â”‚        TÃ­tulo da PÃ¡gina         â”‚  ðŸ””  â”‚  âš™ï¸  â”‚  â˜°  â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n     Back      Title                  Notif  Settings Menu\n```\n\n---\n\n## ðŸ”„ Fluxos de Features\n\n### Fluxo Sofia - AnÃ¡lise de Alimento\n\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚  /sofia        â”‚ â”€â”€â–º â”‚  Captura foto  â”‚ â”€â”€â–º â”‚  Processando   â”‚\nâ”‚  Chat inicial  â”‚     â”‚  ou seleciona  â”‚     â”‚  YOLO + Gemini â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                                                      â”‚\n        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n        â”‚\n        â–¼\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚  Resultado     â”‚ â”€â”€â–º â”‚  Confirmar/    â”‚ â”€â”€â–º â”‚  Salvo em      â”‚\nâ”‚  anÃ¡lise       â”‚     â”‚  Editar        â”‚     â”‚  food_history  â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n### Fluxo Dr. Vital - AnÃ¡lise de Exame\n\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚  /dr-vital     â”‚ â”€â”€â–º â”‚  Upload PDF/   â”‚ â”€â”€â–º â”‚  OCR +         â”‚\nâ”‚  PÃ¡gina inicialâ”‚     â”‚  Imagem        â”‚     â”‚  ExtraÃ§Ã£o      â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                                                      â”‚\n        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n        â”‚\n        â–¼\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚  InterpretaÃ§Ã£o â”‚ â”€â”€â–º â”‚  Chat com      â”‚ â”€â”€â–º â”‚  Gerar PDF     â”‚\nâ”‚  IA            â”‚     â”‚  Dr. Vital     â”‚     â”‚  RelatÃ³rio     â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n### Fluxo ExercÃ­cios\n\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚  /exercicios   â”‚ â”€â”€â–º â”‚  Selecionar    â”‚ â”€â”€â–º â”‚  Ver detalhes  â”‚\nâ”‚  Biblioteca    â”‚     â”‚  exercÃ­cio     â”‚     â”‚  e instruÃ§Ãµes  â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                                                      â”‚\n        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n        â”‚\n        â–¼\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚  Iniciar       â”‚ â”€â”€â–º â”‚  Timer ativo   â”‚ â”€â”€â–º â”‚  Concluir      â”‚\nâ”‚  treino        â”‚     â”‚  + feedback    â”‚     â”‚  + XP ganho    â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n---\n\n## ðŸ›¡ï¸ ProteÃ§Ã£o de Rotas\n\n### AuthGuard\n\n```typescript\n// src/components/AuthGuard.tsx\ninterface AuthGuardProps {\n  children: React.ReactNode;\n  requireAdmin?: boolean;\n  requireOnboarding?: boolean;\n}\n\n// LÃ³gica de proteÃ§Ã£o:\n// 1. Verifica sessÃ£o ativa\n// 2. Se requireAdmin, verifica isAdmin\n// 3. Se requireOnboarding, verifica onboarding_completed\n// 4. Redireciona conforme necessÃ¡rio\n```\n\n### Hierarquia de Acesso\n\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚                        SUPER ADMIN                          â”‚\nâ”‚                     Acesso total                            â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                              â”‚\n                              â–¼\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚                          ADMIN                              â”‚\nâ”‚            Painel admin + todas features                    â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                              â”‚\n                              â–¼\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚                       USUÃRIO PREMIUM                       â”‚\nâ”‚              Todas features + Dr. Vital completo            â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                              â”‚\n                              â–¼\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚                        USUÃRIO FREE                         â”‚\nâ”‚                   Features bÃ¡sicas                          â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                              â”‚\n                              â–¼\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚                         VISITANTE                           â”‚\nâ”‚                    Apenas /auth, /terms                     â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n---\n\n## ðŸ“ ConfiguraÃ§Ã£o de Rotas\n\n### App.tsx - Estrutura de Rotas\n\n```typescript\n// src/App.tsx\n<BrowserRouter>\n  <Routes>\n    {/* PÃºblicas */}\n    <Route path=\"/auth\" element={<AuthPage />} />\n    <Route path=\"/terms\" element={<TermsPage />} />\n    <Route path=\"/install\" element={<Install />} />\n    \n    {/* Protegidas */}\n    <Route element={<AuthGuard />}>\n      {/* Dashboard */}\n      <Route path=\"/\" element={<Dashboard />} />\n      <Route path=\"/dashboard\" element={<Dashboard />} />\n      <Route path=\"/dashboard/tracking\" element={<NutritionTrackingPage />} />\n      \n      {/* Features */}\n      <Route path=\"/sofia\" element={<SofiaPage />} />\n      <Route path=\"/dr-vital-enhanced\" element={<DrVitalEnhancedPage />} />\n      <Route path=\"/exercicios\" element={<ExercisePage />} />\n      \n      {/* Admin (requer admin) */}\n      <Route element={<AuthGuard requireAdmin />}>\n        <Route path=\"/admin\" element={<AdminPage />} />\n        <Route path=\"/admin/*\" element={<AdminRoutes />} />\n      </Route>\n    </Route>\n    \n    {/* 404 */}\n    <Route path=\"*\" element={<NotFound />} />\n  </Routes>\n</BrowserRouter>\n```\n\n---\n\n## ðŸ”— NavegaÃ§Ã£o ProgramÃ¡tica\n\n### useNavigate\n\n```typescript\nimport { useNavigate } from 'react-router-dom';\n\nconst MyComponent = () => {\n  const navigate = useNavigate();\n  \n  const goToSofia = () => {\n    navigate('/sofia');\n  };\n  \n  const goBack = () => {\n    navigate(-1);\n  };\n  \n  const replaceRoute = () => {\n    navigate('/dashboard', { replace: true });\n  };\n  \n  const withState = () => {\n    navigate('/result', { state: { data: someData } });\n  };\n};\n```\n\n### useDashboardNavigation\n\n```typescript\n// src/hooks/useDashboardNavigation.ts\ninterface UseDashboardNavigationReturn {\n  goToSofia: () => void;\n  goToNutrition: () => void;\n  goToExercises: () => void;\n  goToDrVital: () => void;\n  goToProfile: () => void;\n  goToSettings: () => void;\n  goBack: () => void;\n}\n```\n\n---\n\n## ðŸ“ PrÃ³ximos Passos\n\n- Consulte `03_COMPONENTS_CATALOG.md` para componentes de navegaÃ§Ã£o\n- Consulte `07_AI_SYSTEMS.md` para fluxos de IA detalhados\n",
      "sections": [
        "# ðŸ§­ Fluxos de NavegaÃ§Ã£o",
        "## ðŸ“Š VisÃ£o Geral",
        "## ðŸ—ºï¸ Mapa de Rotas",
        "### Rotas PÃºblicas",
        "### Rotas Protegidas - Dashboard",
        "### Rotas Protegidas - Features",
        "### Rotas Admin",
        "## ðŸ” Fluxo de AutenticaÃ§Ã£o",
        "## ðŸ‘¤ Fluxo de Onboarding",
        "## ðŸ“± NavegaÃ§Ã£o Mobile",
        "### Bottom Navigation",
        "### Gestos Suportados",
        "### Header Mobile",
        "## ðŸ”„ Fluxos de Features",
        "### Fluxo Sofia - AnÃ¡lise de Alimento",
        "### Fluxo Dr. Vital - AnÃ¡lise de Exame",
        "### Fluxo ExercÃ­cios",
        "## ðŸ›¡ï¸ ProteÃ§Ã£o de Rotas",
        "### AuthGuard",
        "### Hierarquia de Acesso",
        "## ðŸ“ ConfiguraÃ§Ã£o de Rotas",
        "### App.tsx - Estrutura de Rotas",
        "## ðŸ”— NavegaÃ§Ã£o ProgramÃ¡tica",
        "### useNavigate",
        "### useDashboardNavigation",
        "## ðŸ“ PrÃ³ximos Passos"
      ],
      "code_blocks": 24,
      "links": []
    },
    "07_AI_SYSTEMS.md": {
      "path": "docs/07_AI_SYSTEMS.md",
      "exists": true,
      "lines": 624,
      "size_kb": 24.2958984375,
      "content": "# ðŸ¤– Sistemas de InteligÃªncia Artificial\n\n> DocumentaÃ§Ã£o gerada em: 2026-01-16\n> Sistemas: Sofia, Dr. Vital, YOLO Integration\n\n---\n\n## ðŸ“Š VisÃ£o Geral\n\n| Sistema | FunÃ§Ã£o | Modelos | Edge Function |\n|---------|--------|---------|---------------|\n| **Sofia** | Nutricionista IA | YOLO + Gemini | `sofia-image-analysis` |\n| **Dr. Vital** | MÃ©dico IA | Gemini + OCR | `analyze-medical-exam` |\n| **Chat IA** | ConversaÃ§Ã£o | Gemini/GPT | `dr-vital-chat` |\n| **DetecÃ§Ã£o** | Objetos | YOLO v8 | ServiÃ§o externo |\n\n---\n\n## ðŸ¥— Sofia - Nutricionista IA\n\n### Arquitetura\n\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚                         SOFIA SYSTEM                            â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                                  â”‚\n                                  â–¼\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚                        FRONTEND                                 â”‚\nâ”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚\nâ”‚  â”‚ SofiaChat.tsx â”‚  â”‚ ImageAnalysis â”‚  â”‚ FoodHistory   â”‚       â”‚\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚\nâ”‚          â”‚                  â”‚                                   â”‚\nâ”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚                             â”‚                                   â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                              â”‚\n                              â–¼\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚                     EDGE FUNCTION                               â”‚\nâ”‚                 sofia-image-analysis                            â”‚\nâ”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚\nâ”‚  â”‚ 1. Receber imagem (URL ou Base64)                       â”‚   â”‚\nâ”‚  â”‚ 2. Verificar cache (analysis_cache)                     â”‚   â”‚\nâ”‚  â”‚ 3. Se cache hit â†’ retornar resultado                    â”‚   â”‚\nâ”‚  â”‚ 4. Se cache miss â†’ processar                            â”‚   â”‚\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚\nâ”‚                             â”‚                                   â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                              â”‚\n              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n              â”‚                               â”‚\n              â–¼                               â–¼\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚      YOLO SERVICE       â”‚     â”‚     GEMINI API          â”‚\nâ”‚  DetecÃ§Ã£o de objetos    â”‚     â”‚  AnÃ¡lise nutricional    â”‚\nâ”‚  - Identifica alimentos â”‚     â”‚  - Calcula porÃ§Ãµes      â”‚\nâ”‚  - Bounding boxes       â”‚     â”‚  - Estima calorias      â”‚\nâ”‚  - Confidence scores    â”‚     â”‚  - Macros detalhados    â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n             â”‚                               â”‚\n             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                             â”‚\n                             â–¼\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚                      DATABASE                                   â”‚\nâ”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚\nâ”‚  â”‚  food_history   â”‚  â”‚ analysis_cache  â”‚  â”‚  sofia_memory   â”‚ â”‚\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n### Fluxo Detalhado de AnÃ¡lise\n\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚ PASSO 1: UsuÃ¡rio envia foto de refeiÃ§Ã£o                          â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                              â”‚\n                              â–¼\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚ PASSO 2: Edge Function recebe request                            â”‚\nâ”‚ {                                                                â”‚\nâ”‚   imageUrl: \"https://storage.../meal.jpg\",                       â”‚\nâ”‚   userId: \"uuid\",                                                â”‚\nâ”‚   analysisType: \"food\"                                           â”‚\nâ”‚ }                                                                â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                              â”‚\n                              â–¼\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚ PASSO 3: Gerar hash da imagem                                    â”‚\nâ”‚ const imageHash = await hashImage(imageBase64);                  â”‚\nâ”‚ // hash: \"abc123def456...\"                                       â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                              â”‚\n                              â–¼\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚ PASSO 4: Verificar cache                                         â”‚\nâ”‚ SELECT * FROM analysis_cache                                     â”‚\nâ”‚ WHERE image_hash = 'abc123...' AND analysis_type = 'food'        â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                              â”‚\n              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n              â”‚                               â”‚\n              â–¼ CACHE HIT                     â–¼ CACHE MISS\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚ Retornar resultado      â”‚     â”‚ PASSO 5: Chamar YOLO            â”‚\nâ”‚ cached: true            â”‚     â”‚ POST yolo-service/detect        â”‚\nâ”‚ ~100ms                  â”‚     â”‚ { image_url: \"...\" }            â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                                               â”‚\n                                               â–¼\n                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n                              â”‚ RESPOSTA YOLO:                   â”‚\n                              â”‚ {                                â”‚\n                              â”‚   detections: [                  â”‚\n                              â”‚     { class: \"rice\",             â”‚\n                              â”‚       confidence: 0.92,          â”‚\n                              â”‚       bbox: [x1,y1,x2,y2] },     â”‚\n                              â”‚     { class: \"chicken\",          â”‚\n                              â”‚       confidence: 0.88 },        â”‚\n                              â”‚     { class: \"salad\",            â”‚\n                              â”‚       confidence: 0.85 }         â”‚\n                              â”‚   ]                              â”‚\n                              â”‚ }                                â”‚\n                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                                             â”‚\n                                             â–¼\n                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n                              â”‚ PASSO 6: Refinar com Gemini      â”‚\n                              â”‚                                  â”‚\n                              â”‚ Prompt:                          â”‚\n                              â”‚ \"Analise esta imagem de refeiÃ§Ã£o â”‚\n                              â”‚  YOLO detectou: rice, chicken,   â”‚\n                              â”‚  salad. Estime porÃ§Ãµes e valores â”‚\n                              â”‚  nutricionais detalhados.\"       â”‚\n                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                                             â”‚\n                                             â–¼\n                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n                              â”‚ RESPOSTA GEMINI:                 â”‚\n                              â”‚ {                                â”‚\n                              â”‚   foods: [                       â”‚\n                              â”‚     { name: \"Arroz branco\",      â”‚\n                              â”‚       quantity: \"150g\",          â”‚\n                              â”‚       calories: 195,             â”‚\n                              â”‚       protein: 4.5,              â”‚\n                              â”‚       carbs: 43,                 â”‚\n                              â”‚       fat: 0.5 },                â”‚\n                              â”‚     { name: \"Frango grelhado\",   â”‚\n                              â”‚       quantity: \"120g\",          â”‚\n                              â”‚       calories: 198,             â”‚\n                              â”‚       protein: 37,               â”‚\n                              â”‚       carbs: 0,                  â”‚\n                              â”‚       fat: 5.2 },                â”‚\n                              â”‚     ...                          â”‚\n                              â”‚   ],                             â”‚\n                              â”‚   totalCalories: 493,            â”‚\n                              â”‚   suggestions: [...]             â”‚\n                              â”‚ }                                â”‚\n                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                                             â”‚\n                                             â–¼\n                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n                              â”‚ PASSO 7: Salvar no cache         â”‚\n                              â”‚ INSERT INTO analysis_cache       â”‚\n                              â”‚ (image_hash, analysis_type,      â”‚\n                              â”‚  result, model_used, ...)        â”‚\n                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                                             â”‚\n                                             â–¼\n                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n                              â”‚ PASSO 8: Retornar resultado      â”‚\n                              â”‚ { success: true, data: {...} }   â”‚\n                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n### Tabelas Envolvidas\n\n| Tabela | FunÃ§Ã£o |\n|--------|--------|\n| `food_history` | HistÃ³rico de refeiÃ§Ãµes do usuÃ¡rio |\n| `analysis_cache` | Cache de anÃ¡lises de imagem |\n| `sofia_memory` | MemÃ³ria contextual por usuÃ¡rio |\n| `sofia_learning` | Aprendizado sobre preferÃªncias |\n\n### Cache de AnÃ¡lise\n\n```typescript\n// Estrutura do cache\ninterface AnalysisCache {\n  id: string;\n  image_hash: string;        // Hash MD5 da imagem\n  analysis_type: 'food' | 'exam';\n  result: FoodAnalysisResult;\n  model_used: string;        // \"gemini-1.5-flash\"\n  processing_time_ms: number;\n  yolo_confidence: number;\n  hits: number;              // Contagem de acessos\n  last_hit_at: Date;\n  created_at: Date;\n}\n\n// FunÃ§Ãµes de cache (image-cache.ts)\nasync function hashImage(base64: string): Promise<string>;\nasync function getCachedResult(hash: string, type: string): Promise<Result | null>;\nasync function setCachedResult(hash: string, type: string, result: any): Promise<void>;\nfunction isCacheEnabled(): boolean;\n```\n\n### Prompts Sofia\n\n```typescript\n// Prompt de anÃ¡lise de imagem\nconst FOOD_ANALYSIS_PROMPT = `\nVocÃª Ã© Sofia, nutricionista especializada em anÃ¡lise de refeiÃ§Ãµes.\n\nCONTEXTO DO USUÃRIO:\n- Nome: {userName}\n- Objetivo: {userGoal}\n- RestriÃ§Ãµes: {restrictions}\n\nDETECÃ‡Ã•ES YOLO:\n{yoloDetections}\n\nTAREFA:\nAnalise a imagem e forneÃ§a:\n1. Lista de alimentos com porÃ§Ãµes estimadas\n2. Valores nutricionais por item\n3. Totais de calorias, proteÃ­nas, carboidratos e gorduras\n4. SugestÃµes personalizadas baseadas no objetivo do usuÃ¡rio\n\nFORMATO DE RESPOSTA:\nJSON vÃ¡lido conforme schema FoodAnalysisResult\n`;\n```\n\n---\n\n## ðŸ¥ Dr. Vital - MÃ©dico IA\n\n### Arquitetura\n\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚                       DR. VITAL SYSTEM                          â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                                  â”‚\n                                  â–¼\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚                        FRONTEND                                 â”‚\nâ”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚\nâ”‚  â”‚ DrVitalChat   â”‚  â”‚ ExamUpload    â”‚  â”‚ ReportView    â”‚       â”‚\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚\nâ”‚          â”‚                  â”‚                                   â”‚\nâ”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                              â”‚\n                              â–¼\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚                     EDGE FUNCTIONS                              â”‚\nâ”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚\nâ”‚  â”‚ analyze-medical-exam     â†’ OCR + ExtraÃ§Ã£o de dados      â”‚   â”‚\nâ”‚  â”‚ dr-vital-chat            â†’ Chat contextual              â”‚   â”‚\nâ”‚  â”‚ generate-medical-pdf     â†’ GeraÃ§Ã£o de relatÃ³rio PDF     â”‚   â”‚\nâ”‚  â”‚ dr-vital-weekly-report   â†’ RelatÃ³rio semanal            â”‚   â”‚\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                              â”‚\n                              â–¼\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚                      GEMINI API                                 â”‚\nâ”‚  - ExtraÃ§Ã£o de texto (OCR via Vision)                          â”‚\nâ”‚  - InterpretaÃ§Ã£o de resultados                                  â”‚\nâ”‚  - GeraÃ§Ã£o de recomendaÃ§Ãµes                                     â”‚\nâ”‚  - Chat mÃ©dico contextual                                       â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                              â”‚\n                              â–¼\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚                      DATABASE                                   â”‚\nâ”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚\nâ”‚  â”‚medical_exam_analysesâ”‚  â”‚ medical_pdf_reports â”‚              â”‚\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n### Fluxo de AnÃ¡lise de Exame\n\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚ 1. Upload de PDF/Imagem do exame                                 â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                               â”‚\n                               â–¼\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚ 2. Armazenar no Storage                                          â”‚\nâ”‚    Bucket: medical-exams                                         â”‚\nâ”‚    Path: {userId}/{examId}.pdf                                   â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                               â”‚\n                               â–¼\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚ 3. analyze-medical-exam Edge Function                            â”‚\nâ”‚                                                                  â”‚\nâ”‚    a) Converter PDF para imagens (se necessÃ¡rio)                 â”‚\nâ”‚    b) Enviar para Gemini Vision                                  â”‚\nâ”‚    c) Extrair texto e dados estruturados                         â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                               â”‚\n                               â–¼\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚ 4. EstruturaÃ§Ã£o dos dados                                        â”‚\nâ”‚                                                                  â”‚\nâ”‚    extractedData: {                                              â”‚\nâ”‚      \"Hemoglobina\": { value: \"14.2\", unit: \"g/dL\",              â”‚\nâ”‚                       reference: \"12.0-16.0\",                   â”‚\nâ”‚                       status: \"normal\" },                       â”‚\nâ”‚      \"Glicose\": { value: \"126\", unit: \"mg/dL\",                  â”‚\nâ”‚                   reference: \"70-99\",                           â”‚\nâ”‚                   status: \"attention\" },                        â”‚\nâ”‚      ...                                                        â”‚\nâ”‚    }                                                            â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                               â”‚\n                               â–¼\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚ 5. InterpretaÃ§Ã£o com IA                                          â”‚\nâ”‚                                                                  â”‚\nâ”‚    - AnÃ¡lise de cada indicador                                   â”‚\nâ”‚    - CorrelaÃ§Ã£o entre resultados                                 â”‚\nâ”‚    - IdentificaÃ§Ã£o de padrÃµes                                    â”‚\nâ”‚    - GeraÃ§Ã£o de recomendaÃ§Ãµes                                    â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                               â”‚\n                               â–¼\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚ 6. Salvar em medical_exam_analyses                               â”‚\nâ”‚                                                                  â”‚\nâ”‚    - extracted_text                                              â”‚\nâ”‚    - extracted_data (JSONB)                                      â”‚\nâ”‚    - ai_interpretation                                           â”‚\nâ”‚    - recommendations                                             â”‚\nâ”‚    - risk_level                                                  â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n### Indicadores de SaÃºde\n\n```typescript\ninterface HealthIndicator {\n  name: string;           // \"Hemoglobina\"\n  value: string;          // \"14.2\"\n  unit: string;           // \"g/dL\"\n  referenceRange: string; // \"12.0-16.0\"\n  status: 'normal' | 'attention' | 'critical';\n  interpretation: string;\n  recommendation?: string;\n}\n\n// Status baseado em:\n// - normal: dentro da faixa de referÃªncia\n// - attention: levemente fora, monitorar\n// - critical: significativamente fora, aÃ§Ã£o necessÃ¡ria\n```\n\n### Prompts Dr. Vital\n\n```typescript\n// Prompt de anÃ¡lise de exame\nconst MEDICAL_EXAM_PROMPT = `\nVocÃª Ã© Dr. Vital, especialista em anÃ¡lise de exames laboratoriais.\n\nEXAME RECEBIDO:\nTipo: {examType}\nData: {examDate}\n\nTEXTO EXTRAÃDO:\n{extractedText}\n\nTAREFA:\n1. Identifique todos os indicadores de saÃºde\n2. Compare com valores de referÃªncia\n3. Classifique status (normal/attention/critical)\n4. ForneÃ§a interpretaÃ§Ã£o clara para leigo\n5. Gere recomendaÃ§Ãµes prÃ¡ticas\n6. Identifique correlaÃ§Ãµes entre indicadores\n\nIMPORTANTE:\n- Use linguagem acessÃ­vel\n- NÃ£o faÃ§a diagnÃ³sticos definitivos\n- Recomende consulta mÃ©dica quando apropriado\n- Seja empÃ¡tico e tranquilizador\n\nFORMATO: JSON conforme schema MedicalAnalysis\n`;\n\n// Prompt de chat\nconst DR_VITAL_CHAT_PROMPT = `\nVocÃª Ã© Dr. Vital, mÃ©dico virtual especializado em saÃºde preventiva.\n\nCONTEXTO DO PACIENTE:\n- HistÃ³rico de exames: {examHistory}\n- Ãšltimo exame analisado: {lastExam}\n- Indicadores de atenÃ§Ã£o: {attentionIndicators}\n\nHISTÃ“RICO DA CONVERSA:\n{chatHistory}\n\nMENSAGEM DO PACIENTE:\n{userMessage}\n\nDIRETRIZES:\n1. Responda de forma empÃ¡tica e profissional\n2. Baseie-se nos dados do paciente quando relevante\n3. NÃ£o faÃ§a diagnÃ³sticos - sugira consulta mÃ©dica quando necessÃ¡rio\n4. OfereÃ§a informaÃ§Ãµes educativas sobre saÃºde\n5. Seja claro e evite jargÃ£o mÃ©dico excessivo\n`;\n```\n\n---\n\n## ðŸ” YOLO Service\n\n### Arquitetura do ServiÃ§o\n\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚                      YOLO SERVICE                               â”‚\nâ”‚                   (EasyPanel Deployment)                        â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                              â”‚\n                              â–¼\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚  URL: https://yolo-service-yolo-detection.{host}.easypanel.host â”‚\nâ”‚                                                                 â”‚\nâ”‚  Endpoints:                                                     â”‚\nâ”‚  - POST /detect          â†’ DetecÃ§Ã£o de objetos                  â”‚\nâ”‚  - GET  /health          â†’ Health check                         â”‚\nâ”‚  - GET  /models          â†’ Modelos disponÃ­veis                  â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n### Request/Response\n\n```typescript\n// Request\ninterface YoloDetectRequest {\n  image_url: string;\n  confidence_threshold?: number; // default: 0.5\n  model?: string;                // default: \"yolov8n\"\n}\n\n// Response\ninterface YoloDetectResponse {\n  success: boolean;\n  detections: YoloDetection[];\n  processing_time_ms: number;\n  model_used: string;\n}\n\ninterface YoloDetection {\n  class: string;           // \"apple\", \"rice\", \"chicken\"\n  confidence: number;      // 0.0 - 1.0\n  bbox: [number, number, number, number]; // [x1, y1, x2, y2]\n  area: number;           // Ã¡rea em pixels\n}\n```\n\n### Classes DetectÃ¡veis (Alimentos)\n\nO modelo YOLO foi treinado para detectar categorias de alimentos comuns:\n\n| Categoria | Exemplos |\n|-----------|----------|\n| Frutas | apple, banana, orange, grape |\n| ProteÃ­nas | chicken, beef, fish, egg |\n| Carboidratos | rice, bread, pasta, potato |\n| Vegetais | broccoli, carrot, salad, tomato |\n| Bebidas | coffee, juice, water |\n| Sobremesas | cake, ice cream, cookie |\n\n### Fallback para Gemini\n\nSe YOLO falhar ou retornar confidence baixa:\n\n```typescript\n// LÃ³gica de fallback\nasync function analyzeImage(imageUrl: string) {\n  // Tentar YOLO primeiro\n  try {\n    const yoloResult = await callYoloService(imageUrl);\n    \n    // Se confidence mÃ©dia > 0.7, usar YOLO\n    const avgConfidence = calculateAverageConfidence(yoloResult.detections);\n    if (avgConfidence >= 0.7) {\n      return refineWithGemini(imageUrl, yoloResult);\n    }\n  } catch (error) {\n    console.log('YOLO failed, falling back to Gemini');\n  }\n  \n  // Fallback: anÃ¡lise completa com Gemini\n  return analyzeWithGeminiOnly(imageUrl);\n}\n```\n\n---\n\n## ðŸ’¾ Sistema de Cache de IA\n\n### Arquitetura de Cache\n\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚                     CACHE LAYER                                 â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                              â”‚\n        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n        â”‚                     â”‚                     â”‚\n        â–¼                     â–¼                     â–¼\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚analysis_cache â”‚     â”‚ai_response_   â”‚     â”‚ image_cache   â”‚\nâ”‚               â”‚     â”‚    cache      â”‚     â”‚               â”‚\nâ”‚ - image_hash  â”‚     â”‚ - query_hash  â”‚     â”‚ - storage_pathâ”‚\nâ”‚ - result      â”‚     â”‚ - response    â”‚     â”‚ - base64_data â”‚\nâ”‚ - hits        â”‚     â”‚ - ttl_hours   â”‚     â”‚ - access_countâ”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n### EstratÃ©gia de Cache\n\n| Tipo | TTL | Quando usar |\n|------|-----|-------------|\n| Image Analysis | 7 dias | Fotos de alimentos |\n| Chat Response | 1 hora | Perguntas frequentes |\n| Medical Exam | 30 dias | AnÃ¡lises de exames |\n| Image Data | 24 horas | Imagens base64 |\n\n### BenefÃ­cios Esperados\n\n| MÃ©trica | Sem Cache | Com Cache |\n|---------|-----------|-----------|\n| Tempo resposta (hit) | 3-5s | 100-150ms |\n| Custo YOLO | 100% | ~40% |\n| Custo Gemini | 100% | ~40% |\n| Taxa de hit | 0% | ~60% |\n\n---\n\n## ðŸ“Š MÃ©tricas e Monitoramento\n\n### Tabela de Logs\n\n```sql\n-- ai_usage_logs\nSELECT \n  provider,\n  model_name,\n  functionality,\n  COUNT(*) as calls,\n  AVG(response_time_ms) as avg_time,\n  SUM(tokens_used) as total_tokens,\n  SUM(estimated_cost) as total_cost,\n  SUM(CASE WHEN success THEN 1 ELSE 0 END)::float / COUNT(*) as success_rate\nFROM ai_usage_logs\nWHERE created_at > now() - interval '7 days'\nGROUP BY provider, model_name, functionality\nORDER BY calls DESC;\n```\n\n### Dashboard de IA (Admin)\n\nMÃ©tricas exibidas:\n- Chamadas por dia/semana\n- Tempo mÃ©dio de resposta\n- Taxa de cache hit\n- Custo estimado\n- Erros por tipo\n- Top funcionalidades\n\n---\n\n## ðŸ”§ ConfiguraÃ§Ã£o de IA\n\n### ai_configurations\n\n```typescript\ninterface AIConfiguration {\n  id: string;\n  functionality: string;      // \"food_analysis\", \"medical_chat\"\n  service: string;            // \"gemini\", \"openai\"\n  model: string;              // \"gemini-1.5-flash\"\n  temperature: number;        // 0.0 - 1.0\n  max_tokens: number;\n  system_prompt: string;\n  personality: string;        // \"professional\", \"friendly\"\n  is_enabled: boolean;\n  priority: number;\n  created_at: Date;\n  updated_at: Date;\n}\n```\n\n### Modelos Suportados\n\n| Provider | Modelo | Uso Recomendado |\n|----------|--------|-----------------|\n| Google | gemini-1.5-flash | AnÃ¡lise rÃ¡pida |\n| Google | gemini-1.5-pro | AnÃ¡lise complexa |\n| OpenAI | gpt-4-turbo | Chat avanÃ§ado |\n| OpenAI | gpt-3.5-turbo | Chat simples |\n\n---\n\n## ðŸ“ PrÃ³ximos Passos\n\n- Consulte `05_EDGE_FUNCTIONS.md` para detalhes de implementaÃ§Ã£o\n- Consulte `08_GAMIFICATION.md` para XP ganho com anÃ¡lises\n- Consulte `09_ENVIRONMENT_VARS.md` para configuraÃ§Ã£o de APIs\n",
      "sections": [
        "# ðŸ¤– Sistemas de InteligÃªncia Artificial",
        "## ðŸ“Š VisÃ£o Geral",
        "## ðŸ¥— Sofia - Nutricionista IA",
        "### Arquitetura",
        "### Fluxo Detalhado de AnÃ¡lise",
        "### Tabelas Envolvidas",
        "### Cache de AnÃ¡lise",
        "### Prompts Sofia",
        "## ðŸ¥ Dr. Vital - MÃ©dico IA",
        "### Arquitetura",
        "### Fluxo de AnÃ¡lise de Exame",
        "### Indicadores de SaÃºde",
        "### Prompts Dr. Vital",
        "## ðŸ” YOLO Service",
        "### Arquitetura do ServiÃ§o",
        "### Request/Response",
        "### Classes DetectÃ¡veis (Alimentos)",
        "### Fallback para Gemini",
        "## ðŸ’¾ Sistema de Cache de IA",
        "### Arquitetura de Cache",
        "### EstratÃ©gia de Cache",
        "### BenefÃ­cios Esperados",
        "## ðŸ“Š MÃ©tricas e Monitoramento",
        "### Tabela de Logs",
        "### Dashboard de IA (Admin)",
        "## ðŸ”§ ConfiguraÃ§Ã£o de IA",
        "### ai_configurations",
        "### Modelos Suportados",
        "## ðŸ“ PrÃ³ximos Passos"
      ],
      "code_blocks": 28,
      "links": []
    },
    "08_GAMIFICATION.md": {
      "path": "docs/08_GAMIFICATION.md",
      "exists": true,
      "lines": 635,
      "size_kb": 15.9189453125,
      "content": "# ðŸŽ® Sistema de GamificaÃ§Ã£o\n\n> DocumentaÃ§Ã£o gerada em: 2026-01-16\n> Sistema: Pontos, XP, NÃ­veis, Desafios, Ranking\n\n---\n\n## ðŸ“Š VisÃ£o Geral\n\n| Componente | DescriÃ§Ã£o | Tabela Principal |\n|------------|-----------|------------------|\n| **Pontos** | Moeda principal | `user_points` |\n| **XP** | ExperiÃªncia para nÃ­veis | `user_points` |\n| **NÃ­veis** | 1-100 baseado em XP | Calculado |\n| **Streak** | Dias consecutivos | `user_points` |\n| **Desafios** | Metas temporÃ¡rias | `challenges` |\n| **Ranking** | PosiÃ§Ã£o entre usuÃ¡rios | Calculado |\n| **Conquistas** | Badges desbloqueÃ¡veis | `user_achievements_v2` |\n| **MissÃµes** | Tarefas diÃ¡rias | `daily_mission_sessions` |\n\n---\n\n## ðŸ† Sistema de Pontos\n\n### Estrutura da Tabela\n\n```sql\n-- user_points\nCREATE TABLE user_points (\n  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n  user_id UUID NOT NULL REFERENCES auth.users,\n  total_points INTEGER DEFAULT 0,\n  xp_total INTEGER DEFAULT 0,\n  level INTEGER DEFAULT 1,\n  current_streak INTEGER DEFAULT 0,\n  longest_streak INTEGER DEFAULT 0,\n  last_activity_date DATE,\n  weekly_points INTEGER DEFAULT 0,\n  monthly_points INTEGER DEFAULT 0,\n  created_at TIMESTAMPTZ DEFAULT now(),\n  updated_at TIMESTAMPTZ DEFAULT now(),\n  UNIQUE(user_id)\n);\n```\n\n### AÃ§Ãµes que Geram Pontos\n\n| AÃ§Ã£o | Pontos | XP | DescriÃ§Ã£o |\n|------|--------|-----|-----------|\n| Registrar refeiÃ§Ã£o | 10 | 15 | Via Sofia ou manual |\n| Foto de refeiÃ§Ã£o | 15 | 20 | Com anÃ¡lise de IA |\n| Completar meta diÃ¡ria | 20 | 30 | Qualquer meta |\n| ExercÃ­cio registrado | 15 | 25 | Treino completo |\n| Beber Ã¡gua | 5 | 5 | Por registro |\n| Check-in diÃ¡rio | 10 | 10 | Primeiro acesso do dia |\n| Streak mantido | 5 Ã— dias | 10 | BÃ´nus por streak |\n| Desafio completo | VariÃ¡vel | VariÃ¡vel | Definido no desafio |\n| Conquista desbloqueada | 50-200 | 100-500 | Por raridade |\n\n### FunÃ§Ã£o de AdiÃ§Ã£o de Pontos\n\n```sql\n-- add_user_points()\nCREATE OR REPLACE FUNCTION add_user_points(\n  p_user_id UUID,\n  p_points INTEGER,\n  p_xp INTEGER,\n  p_action TEXT\n) RETURNS VOID AS $$\nDECLARE\n  v_new_level INTEGER;\n  v_current_xp INTEGER;\nBEGIN\n  -- Atualizar pontos e XP\n  UPDATE user_points\n  SET \n    total_points = total_points + p_points,\n    xp_total = xp_total + p_xp,\n    weekly_points = weekly_points + p_points,\n    monthly_points = monthly_points + p_points,\n    updated_at = now()\n  WHERE user_id = p_user_id\n  RETURNING xp_total INTO v_current_xp;\n  \n  -- Calcular novo nÃ­vel\n  v_new_level := calculate_level(v_current_xp);\n  \n  -- Atualizar nÃ­vel se mudou\n  UPDATE user_points\n  SET level = v_new_level\n  WHERE user_id = p_user_id AND level != v_new_level;\n  \n  -- Registrar log (opcional)\n  INSERT INTO points_history (user_id, points, xp, action, created_at)\n  VALUES (p_user_id, p_points, p_xp, p_action, now());\nEND;\n$$ LANGUAGE plpgsql;\n```\n\n---\n\n## ðŸ“ˆ Sistema de XP e NÃ­veis\n\n### FÃ³rmula de NÃ­vel\n\n```typescript\n// FÃ³rmula: XP necessÃ¡rio para nÃ­vel N\n// xp_required = 100 * N^1.5\n\nconst LEVEL_THRESHOLDS = {\n  1: 0,\n  2: 100,\n  3: 260,\n  4: 490,\n  5: 790,\n  10: 3162,\n  20: 8944,\n  50: 35355,\n  100: 100000,\n};\n\nfunction calculateLevel(xpTotal: number): number {\n  let level = 1;\n  let xpRequired = 0;\n  \n  while (true) {\n    xpRequired = Math.floor(100 * Math.pow(level + 1, 1.5));\n    if (xpTotal < xpRequired) break;\n    level++;\n    if (level >= 100) break;\n  }\n  \n  return level;\n}\n\nfunction xpToNextLevel(currentXP: number, currentLevel: number): number {\n  const nextLevelXP = Math.floor(100 * Math.pow(currentLevel + 1, 1.5));\n  return nextLevelXP - currentXP;\n}\n\nfunction levelProgress(currentXP: number, currentLevel: number): number {\n  const currentLevelXP = Math.floor(100 * Math.pow(currentLevel, 1.5));\n  const nextLevelXP = Math.floor(100 * Math.pow(currentLevel + 1, 1.5));\n  const progress = (currentXP - currentLevelXP) / (nextLevelXP - currentLevelXP);\n  return Math.min(Math.max(progress * 100, 0), 100);\n}\n```\n\n### FunÃ§Ã£o SQL de CÃ¡lculo\n\n```sql\n-- calculate_level()\nCREATE OR REPLACE FUNCTION calculate_level(p_xp_total INTEGER)\nRETURNS INTEGER AS $$\nDECLARE\n  v_level INTEGER := 1;\n  v_xp_required INTEGER;\nBEGIN\n  LOOP\n    v_xp_required := FLOOR(100 * POWER(v_level + 1, 1.5));\n    EXIT WHEN p_xp_total < v_xp_required OR v_level >= 100;\n    v_level := v_level + 1;\n  END LOOP;\n  RETURN v_level;\nEND;\n$$ LANGUAGE plpgsql IMMUTABLE;\n```\n\n---\n\n## ðŸ”¥ Sistema de Streak\n\n### LÃ³gica de Streak\n\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚                     STREAK LOGIC                                â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n\nDia 1: Atividade â†’ streak = 1\nDia 2: Atividade â†’ streak = 2\nDia 3: Atividade â†’ streak = 3\nDia 4: SEM atividade â†’ streak = 0 (reset)\nDia 5: Atividade â†’ streak = 1 (recomeÃ§a)\n\nRegra: Streak mantÃ©m se atividade no dia OU no dia anterior\n       Streak reseta se passar 1 dia completo sem atividade\n```\n\n### FunÃ§Ã£o de AtualizaÃ§Ã£o\n\n```sql\n-- recalculate_user_streak()\nCREATE OR REPLACE FUNCTION recalculate_user_streak(p_user_id UUID)\nRETURNS VOID AS $$\nDECLARE\n  v_last_activity DATE;\n  v_current_streak INTEGER;\n  v_today DATE := CURRENT_DATE;\nBEGIN\n  -- Buscar Ãºltima atividade\n  SELECT last_activity_date, current_streak\n  INTO v_last_activity, v_current_streak\n  FROM user_points\n  WHERE user_id = p_user_id;\n  \n  -- Se nunca teve atividade\n  IF v_last_activity IS NULL THEN\n    UPDATE user_points\n    SET current_streak = 1, last_activity_date = v_today\n    WHERE user_id = p_user_id;\n    RETURN;\n  END IF;\n  \n  -- Se Ã© o mesmo dia, nÃ£o muda\n  IF v_last_activity = v_today THEN\n    RETURN;\n  END IF;\n  \n  -- Se Ã© o dia seguinte, incrementa\n  IF v_last_activity = v_today - 1 THEN\n    UPDATE user_points\n    SET \n      current_streak = current_streak + 1,\n      longest_streak = GREATEST(longest_streak, current_streak + 1),\n      last_activity_date = v_today\n    WHERE user_id = p_user_id;\n    RETURN;\n  END IF;\n  \n  -- Se passou mais de 1 dia, reseta\n  UPDATE user_points\n  SET current_streak = 1, last_activity_date = v_today\n  WHERE user_id = p_user_id;\nEND;\n$$ LANGUAGE plpgsql;\n```\n\n### ProteÃ§Ã£o de Streak\n\n```typescript\n// UsuÃ¡rio pode usar \"protetor de streak\" 1x por semana\ninterface StreakProtection {\n  userId: string;\n  protectionUsedAt: Date | null;\n  canUseProtection: boolean; // true se nÃ£o usou nos Ãºltimos 7 dias\n}\n\nasync function useStreakProtection(userId: string): Promise<boolean> {\n  const { data } = await supabase\n    .from('user_points')\n    .select('protection_used_at')\n    .eq('user_id', userId)\n    .single();\n  \n  const lastUsed = data?.protection_used_at;\n  const sevenDaysAgo = new Date(Date.now() - 7 * 24 * 60 * 60 * 1000);\n  \n  if (!lastUsed || new Date(lastUsed) < sevenDaysAgo) {\n    await supabase\n      .from('user_points')\n      .update({ protection_used_at: new Date() })\n      .eq('user_id', userId);\n    return true;\n  }\n  \n  return false;\n}\n```\n\n---\n\n## ðŸŽ¯ Sistema de Desafios\n\n### Estrutura\n\n```sql\n-- challenges\nCREATE TABLE challenges (\n  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n  title TEXT NOT NULL,\n  description TEXT,\n  challenge_type TEXT, -- 'steps', 'calories', 'water', 'exercise', 'custom'\n  target_value INTEGER,\n  target_unit TEXT,\n  xp_reward INTEGER DEFAULT 100,\n  points_reward INTEGER DEFAULT 50,\n  badge_reward TEXT,\n  start_date DATE,\n  end_date DATE,\n  is_active BOOLEAN DEFAULT true,\n  difficulty TEXT, -- 'easy', 'medium', 'hard', 'extreme'\n  icon TEXT,\n  color TEXT,\n  created_at TIMESTAMPTZ DEFAULT now()\n);\n\n-- challenge_participations\nCREATE TABLE challenge_participations (\n  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n  challenge_id UUID REFERENCES challenges,\n  user_id UUID NOT NULL,\n  progress INTEGER DEFAULT 0,\n  target_value INTEGER,\n  is_completed BOOLEAN DEFAULT false,\n  completed_at TIMESTAMPTZ,\n  points_earned INTEGER DEFAULT 0,\n  current_streak INTEGER DEFAULT 0,\n  started_at TIMESTAMPTZ DEFAULT now(),\n  created_at TIMESTAMPTZ DEFAULT now(),\n  updated_at TIMESTAMPTZ DEFAULT now()\n);\n```\n\n### Tipos de Desafios\n\n| Tipo | Exemplo | Tracking |\n|------|---------|----------|\n| `steps` | \"10k passos/dia por 7 dias\" | Google Fit |\n| `calories` | \"Manter 2000kcal por 5 dias\" | food_history |\n| `water` | \"Beber 3L Ã¡gua por 7 dias\" | health_diary |\n| `exercise` | \"Treinar 5x esta semana\" | exercise_tracking |\n| `weight` | \"Perder 2kg em 30 dias\" | Pesagens |\n| `streak` | \"Manter streak de 14 dias\" | user_points |\n| `custom` | Definido pelo admin | Manual |\n\n### FunÃ§Ã£o de AtualizaÃ§Ã£o de Progresso\n\n```sql\n-- update_challenge_progress()\nCREATE OR REPLACE FUNCTION update_challenge_progress(\n  p_user_id UUID,\n  p_challenge_id UUID,\n  p_increment INTEGER\n) RETURNS VOID AS $$\nDECLARE\n  v_participation RECORD;\nBEGIN\n  -- Buscar participaÃ§Ã£o\n  SELECT * INTO v_participation\n  FROM challenge_participations\n  WHERE user_id = p_user_id AND challenge_id = p_challenge_id;\n  \n  -- Se nÃ£o existe, criar\n  IF v_participation IS NULL THEN\n    INSERT INTO challenge_participations (user_id, challenge_id, progress)\n    VALUES (p_user_id, p_challenge_id, p_increment);\n    RETURN;\n  END IF;\n  \n  -- Se jÃ¡ completou, ignorar\n  IF v_participation.is_completed THEN\n    RETURN;\n  END IF;\n  \n  -- Atualizar progresso\n  UPDATE challenge_participations\n  SET \n    progress = progress + p_increment,\n    updated_at = now()\n  WHERE id = v_participation.id;\n  \n  -- Verificar se completou\n  IF (v_participation.progress + p_increment) >= v_participation.target_value THEN\n    -- Marcar como completo e dar recompensa\n    UPDATE challenge_participations\n    SET \n      is_completed = true,\n      completed_at = now(),\n      points_earned = (SELECT points_reward FROM challenges WHERE id = p_challenge_id)\n    WHERE id = v_participation.id;\n    \n    -- Adicionar pontos e XP ao usuÃ¡rio\n    PERFORM add_user_points(\n      p_user_id,\n      (SELECT points_reward FROM challenges WHERE id = p_challenge_id),\n      (SELECT xp_reward FROM challenges WHERE id = p_challenge_id),\n      'challenge_completed'\n    );\n  END IF;\nEND;\n$$ LANGUAGE plpgsql;\n```\n\n---\n\n## ðŸ… Sistema de Ranking\n\n### Ligas\n\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚                       LIGAS                                     â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n\nðŸ’Ž DIAMANTE  â”‚ Top 1%    â”‚ 10.000+ pontos semanais\nðŸ¥‡ OURO      â”‚ Top 5%    â”‚ 5.000+ pontos semanais  \nðŸ¥ˆ PRATA     â”‚ Top 20%   â”‚ 2.000+ pontos semanais\nðŸ¥‰ BRONZE    â”‚ Demais    â”‚ < 2.000 pontos semanais\n\nPromoÃ§Ã£o/Rebaixamento: Semanal (domingo 23:59)\n- Top 10% da liga: Promovido\n- Bottom 10% da liga: Rebaixado\n```\n\n### CÃ¡lculo de Ranking\n\n```sql\n-- Ranking global por pontos semanais\nSELECT \n  p.user_id,\n  pr.full_name,\n  pr.avatar_url,\n  p.weekly_points,\n  p.level,\n  p.current_streak,\n  ROW_NUMBER() OVER (ORDER BY p.weekly_points DESC) as position\nFROM user_points p\nJOIN profiles pr ON p.user_id = pr.user_id\nORDER BY p.weekly_points DESC\nLIMIT 100;\n\n-- Ranking por liga\nWITH league_users AS (\n  SELECT \n    user_id,\n    weekly_points,\n    CASE \n      WHEN weekly_points >= 10000 THEN 'diamond'\n      WHEN weekly_points >= 5000 THEN 'gold'\n      WHEN weekly_points >= 2000 THEN 'silver'\n      ELSE 'bronze'\n    END as league\n  FROM user_points\n)\nSELECT \n  lu.*,\n  ROW_NUMBER() OVER (PARTITION BY league ORDER BY weekly_points DESC) as league_position\nFROM league_users lu;\n```\n\n### PromoÃ§Ãµes Semanais\n\n```sql\n-- process_league_promotions()\nCREATE OR REPLACE FUNCTION process_league_promotions()\nRETURNS VOID AS $$\nBEGIN\n  -- Resetar pontos semanais\n  UPDATE user_points SET weekly_points = 0;\n  \n  -- Registrar histÃ³rico de liga\n  INSERT INTO league_history (user_id, league, position, week_end)\n  SELECT \n    user_id, \n    current_league,\n    league_position,\n    CURRENT_DATE\n  FROM user_league_positions;\n  \n  -- Notificar promoÃ§Ãµes/rebaixamentos\n  -- (implementado via Edge Function)\nEND;\n$$ LANGUAGE plpgsql;\n```\n\n---\n\n## ðŸ† Sistema de Conquistas\n\n### Estrutura\n\n```sql\n-- user_achievements_v2\nCREATE TABLE user_achievements_v2 (\n  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n  user_id UUID NOT NULL,\n  achievement_id TEXT NOT NULL,\n  achievement_name TEXT,\n  achievement_description TEXT,\n  achievement_icon TEXT,\n  category TEXT, -- 'nutrition', 'exercise', 'consistency', 'social', 'special'\n  rarity TEXT, -- 'common', 'rare', 'epic', 'legendary'\n  xp_reward INTEGER DEFAULT 100,\n  unlocked_at TIMESTAMPTZ DEFAULT now(),\n  created_at TIMESTAMPTZ DEFAULT now(),\n  UNIQUE(user_id, achievement_id)\n);\n```\n\n### Conquistas DisponÃ­veis\n\n| ID | Nome | Categoria | Raridade | XP | CondiÃ§Ã£o |\n|----|------|-----------|----------|-----|----------|\n| `first_meal` | Primeira RefeiÃ§Ã£o | nutrition | common | 50 | Registrar 1Âª refeiÃ§Ã£o |\n| `week_streak` | Semana de Ouro | consistency | rare | 200 | 7 dias de streak |\n| `month_streak` | MÃªs Invicto | consistency | epic | 500 | 30 dias de streak |\n| `century_streak` | CentenÃ¡rio | consistency | legendary | 1000 | 100 dias de streak |\n| `photo_master` | FotÃ³grafo | nutrition | rare | 150 | 50 fotos analisadas |\n| `hydration_hero` | Hidratado | nutrition | common | 100 | Meta Ã¡gua 7 dias |\n| `gym_rat` | Rato de Academia | exercise | rare | 200 | 50 treinos |\n| `social_butterfly` | SociÃ¡vel | social | rare | 150 | 10 posts no feed |\n| `challenge_master` | Mestre dos Desafios | special | epic | 500 | Completar 10 desafios |\n| `top_10` | Elite | special | legendary | 1000 | Top 10 global |\n\n### VerificaÃ§Ã£o de Conquistas\n\n```typescript\n// Hook para verificar conquistas\nasync function checkAchievements(userId: string, action: string) {\n  const achievements = await getAvailableAchievements(userId);\n  \n  for (const achievement of achievements) {\n    if (await meetsCondition(userId, achievement)) {\n      await unlockAchievement(userId, achievement);\n      \n      // Notificar usuÃ¡rio\n      toast.success(`ðŸ† Conquista desbloqueada: ${achievement.name}`);\n      \n      // Adicionar XP\n      await addXP(userId, achievement.xpReward, 'achievement');\n    }\n  }\n}\n```\n\n---\n\n## ðŸ“‹ MissÃµes DiÃ¡rias\n\n### Estrutura\n\n```sql\n-- daily_mission_sessions\nCREATE TABLE daily_mission_sessions (\n  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n  user_id UUID NOT NULL,\n  session_date DATE NOT NULL,\n  missions_completed INTEGER DEFAULT 0,\n  total_points INTEGER DEFAULT 0,\n  streak_days INTEGER DEFAULT 0,\n  completed_sections JSONB DEFAULT '{}',\n  is_completed BOOLEAN DEFAULT false,\n  created_at TIMESTAMPTZ DEFAULT now(),\n  UNIQUE(user_id, session_date)\n);\n```\n\n### MissÃµes do Dia\n\nGeradas dinamicamente baseadas no perfil:\n\n| Tipo | Exemplo | Pontos | FrequÃªncia |\n|------|---------|--------|------------|\n| NutriÃ§Ã£o | \"Registre cafÃ© da manhÃ£\" | 10 | DiÃ¡ria |\n| Ãgua | \"Beba 8 copos de Ã¡gua\" | 10 | DiÃ¡ria |\n| ExercÃ­cio | \"FaÃ§a 30min de atividade\" | 15 | 3x/semana |\n| Check-in | \"FaÃ§a check-in no app\" | 5 | DiÃ¡ria |\n| Social | \"Curta um post\" | 5 | DiÃ¡ria |\n| Especial | \"Complete todas as missÃµes\" | 20 | DiÃ¡ria |\n\n### Reset DiÃ¡rio\n\n```sql\n-- Trigger para reset Ã s 00:00\nCREATE OR REPLACE FUNCTION reset_daily_missions()\nRETURNS TRIGGER AS $$\nBEGIN\n  -- Criar nova sessÃ£o para o dia\n  INSERT INTO daily_mission_sessions (user_id, session_date)\n  SELECT DISTINCT user_id, CURRENT_DATE\n  FROM daily_mission_sessions\n  ON CONFLICT DO NOTHING;\n  \n  RETURN NULL;\nEND;\n$$ LANGUAGE plpgsql;\n```\n\n---\n\n## ðŸ“Š Hooks de GamificaÃ§Ã£o\n\n### useGamificationUnified\n\n```typescript\n// src/hooks/useGamificationUnified.ts\ninterface UseGamificationUnifiedReturn {\n  // Dados\n  points: number;\n  xp: number;\n  level: number;\n  currentStreak: number;\n  longestStreak: number;\n  weeklyPoints: number;\n  \n  // Progresso\n  xpToNextLevel: number;\n  levelProgress: number;\n  \n  // Ranking\n  position: number;\n  league: LeagueType;\n  \n  // Status\n  isLoading: boolean;\n  error: Error | null;\n  \n  // AÃ§Ãµes\n  addPoints: (amount: number, action: string) => Promise<void>;\n  addXP: (amount: number, source: string) => Promise<void>;\n  checkAchievements: () => Promise<void>;\n  \n  // Refetch\n  refetch: () => void;\n}\n\n// Uso\nconst { \n  points, \n  level, \n  currentStreak,\n  addPoints,\n  levelProgress \n} = useGamificationUnified();\n```\n\n---\n\n## ðŸ“ PrÃ³ximos Passos\n\n- Consulte `03_COMPONENTS_CATALOG.md` para componentes visuais\n- Consulte `04_HOOKS_REFERENCE.md` para hooks relacionados\n- Consulte `02_DATABASE_SCHEMA.md` para tabelas completas\n",
      "sections": [
        "# ðŸŽ® Sistema de GamificaÃ§Ã£o",
        "## ðŸ“Š VisÃ£o Geral",
        "## ðŸ† Sistema de Pontos",
        "### Estrutura da Tabela",
        "### AÃ§Ãµes que Geram Pontos",
        "### FunÃ§Ã£o de AdiÃ§Ã£o de Pontos",
        "## ðŸ“ˆ Sistema de XP e NÃ­veis",
        "### FÃ³rmula de NÃ­vel",
        "### FunÃ§Ã£o SQL de CÃ¡lculo",
        "## ðŸ”¥ Sistema de Streak",
        "### LÃ³gica de Streak",
        "### FunÃ§Ã£o de AtualizaÃ§Ã£o",
        "### ProteÃ§Ã£o de Streak",
        "## ðŸŽ¯ Sistema de Desafios",
        "### Estrutura",
        "### Tipos de Desafios",
        "### FunÃ§Ã£o de AtualizaÃ§Ã£o de Progresso",
        "## ðŸ… Sistema de Ranking",
        "### Ligas",
        "### CÃ¡lculo de Ranking",
        "### PromoÃ§Ãµes Semanais",
        "## ðŸ† Sistema de Conquistas",
        "### Estrutura",
        "### Conquistas DisponÃ­veis",
        "### VerificaÃ§Ã£o de Conquistas",
        "## ðŸ“‹ MissÃµes DiÃ¡rias",
        "### Estrutura",
        "### MissÃµes do Dia",
        "### Reset DiÃ¡rio",
        "## ðŸ“Š Hooks de GamificaÃ§Ã£o",
        "### useGamificationUnified",
        "## ðŸ“ PrÃ³ximos Passos"
      ],
      "code_blocks": 34,
      "links": []
    },
    "09_ENVIRONMENT_VARS.md": {
      "path": "docs/09_ENVIRONMENT_VARS.md",
      "exists": true,
      "lines": 284,
      "size_kb": 7.8466796875,
      "content": "# ðŸ” VariÃ¡veis de Ambiente\n\n> DocumentaÃ§Ã£o gerada em: 2026-01-16\n> IMPORTANTE: Nunca commitar valores reais de secrets!\n\n---\n\n## ðŸ“Š VisÃ£o Geral\n\n| Categoria | Quantidade | Prefixo |\n|-----------|------------|---------|\n| Frontend (Vite) | 8 | `VITE_` |\n| Edge Functions | 15+ | Nenhum |\n| IntegraÃ§Ãµes | 5 | Variado |\n\n---\n\n## ðŸ–¥ï¸ Frontend (Vite)\n\nVariÃ¡veis acessÃ­veis no cÃ³digo frontend via `import.meta.env`.\n\n| VariÃ¡vel | Tipo | ObrigatÃ³ria | DescriÃ§Ã£o |\n|----------|------|-------------|-----------|\n| `VITE_SUPABASE_URL` | URL | âœ… Sim | URL do projeto Supabase |\n| `VITE_SUPABASE_ANON_KEY` | JWT | âœ… Sim | Chave pÃºblica anon |\n| `VITE_SUPABASE_PROJECT_ID` | String | âœ… Sim | ID do projeto |\n| `VITE_APP_NAME` | String | âŒ NÃ£o | Nome do aplicativo |\n| `VITE_APP_URL` | URL | âŒ NÃ£o | URL do app em produÃ§Ã£o |\n| `VITE_DEBUG_MODE` | Boolean | âŒ NÃ£o | Ativar modo debug |\n| `VITE_ENABLE_ANALYTICS` | Boolean | âŒ NÃ£o | Ativar analytics |\n| `VITE_SENTRY_DSN` | URL | âŒ NÃ£o | DSN do Sentry |\n\n### Exemplo .env\n\n```bash\n# .env (Frontend - NÃƒO commitar valores reais!)\n\n# Supabase (ObrigatÃ³rias)\nVITE_SUPABASE_URL=https://ciszqtlaacrhfwsqnvjr.supabase.co\nVITE_SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...\nVITE_SUPABASE_PROJECT_ID=ciszqtlaacrhfwsqnvjr\n\n# AplicaÃ§Ã£o (Opcionais)\nVITE_APP_NAME=MaxNutrition\nVITE_APP_URL=https://your-wellness-companion-02.lovable.app\nVITE_DEBUG_MODE=false\nVITE_ENABLE_ANALYTICS=true\n```\n\n### Uso no CÃ³digo\n\n```typescript\n// Acessando variÃ¡veis de ambiente\nconst supabaseUrl = import.meta.env.VITE_SUPABASE_URL;\nconst supabaseKey = import.meta.env.VITE_SUPABASE_ANON_KEY;\n\n// VerificaÃ§Ã£o de debug\nif (import.meta.env.VITE_DEBUG_MODE === 'true') {\n  console.log('Debug mode ativo');\n}\n\n// Tipagem (vite-env.d.ts)\ninterface ImportMetaEnv {\n  readonly VITE_SUPABASE_URL: string;\n  readonly VITE_SUPABASE_ANON_KEY: string;\n  readonly VITE_SUPABASE_PROJECT_ID: string;\n  readonly VITE_APP_NAME?: string;\n  readonly VITE_APP_URL?: string;\n  readonly VITE_DEBUG_MODE?: string;\n  readonly VITE_ENABLE_ANALYTICS?: string;\n  readonly VITE_SENTRY_DSN?: string;\n}\n```\n\n---\n\n## âš¡ Edge Functions (Backend)\n\nVariÃ¡veis configuradas no Supabase para Edge Functions.\n\n### Supabase Core\n\n| VariÃ¡vel | Tipo | ObrigatÃ³ria | DescriÃ§Ã£o |\n|----------|------|-------------|-----------|\n| `SUPABASE_URL` | URL | âœ… Sim | URL do Supabase |\n| `SUPABASE_SERVICE_ROLE_KEY` | JWT | âœ… Sim | Chave service role |\n| `SUPABASE_ANON_KEY` | JWT | âœ… Sim | Chave anon |\n\n### IA e AnÃ¡lise\n\n| VariÃ¡vel | Functions | ObrigatÃ³ria | DescriÃ§Ã£o |\n|----------|-----------|-------------|-----------|\n| `GOOGLE_AI_API_KEY` | sofia-*, dr-vital-* | âœ… Para IA | Chave Gemini API |\n| `OPENAI_API_KEY` | enhanced-gpt-chat | âŒ Opcional | Chave OpenAI |\n| `YOLO_SERVICE_URL` | sofia-image-analysis | âœ… Para YOLO | URL do serviÃ§o YOLO |\n\n### WhatsApp/ComunicaÃ§Ã£o\n\n| VariÃ¡vel | Functions | ObrigatÃ³ria | DescriÃ§Ã£o |\n|----------|-----------|-------------|-----------|\n| `N8N_WHATSAPP_WEBHOOK` | whatsapp-* | âœ… Para WhatsApp | Webhook do N8N |\n| `EVOLUTION_API_URL` | whatsapp-* | âŒ Opcional | URL Evolution API |\n| `EVOLUTION_API_KEY` | whatsapp-* | âŒ Opcional | Chave Evolution |\n| `RESEND_API_KEY` | send-email | âŒ Opcional | Chave Resend (email) |\n\n### Google Fit\n\n| VariÃ¡vel | Functions | ObrigatÃ³ria | DescriÃ§Ã£o |\n|----------|-----------|-------------|-----------|\n| `GOOGLE_CLIENT_ID` | google-fit-* | âœ… Para Fit | Client ID OAuth |\n| `GOOGLE_CLIENT_SECRET` | google-fit-* | âœ… Para Fit | Client Secret |\n| `GOOGLE_REDIRECT_URI` | google-fit-callback | âœ… Para Fit | URI de callback |\n\n### Storage (MinIO)\n\n| VariÃ¡vel | Functions | ObrigatÃ³ria | DescriÃ§Ã£o |\n|----------|-----------|-------------|-----------|\n| `MINIO_ENDPOINT` | media-upload | âŒ Opcional | Endpoint MinIO |\n| `MINIO_ACCESS_KEY` | media-upload | âŒ Opcional | Access key |\n| `MINIO_SECRET_KEY` | media-upload | âŒ Opcional | Secret key |\n| `MINIO_BUCKET_NAME` | media-upload | âŒ Opcional | Nome do bucket |\n\n---\n\n## ðŸ”§ ConfiguraÃ§Ã£o de Secrets\n\n### Via MaxNutrition Cloud\n\n1. Acesse ConfiguraÃ§Ãµes do Projeto\n2. VÃ¡ em \"Backend Settings\" > \"Secrets\"\n3. Adicione cada variÃ¡vel necessÃ¡ria\n\n### VariÃ¡veis JÃ¡ Configuradas (Auto)\n\n```\nSUPABASE_URL              âœ… AutomÃ¡tico\nSUPABASE_ANON_KEY         âœ… AutomÃ¡tico  \nSUPABASE_SERVICE_ROLE_KEY âœ… AutomÃ¡tico\n```\n\n### VariÃ¡veis a Configurar Manualmente\n\n```\nGOOGLE_AI_API_KEY         âš ï¸ NecessÃ¡rio para IA\nYOLO_SERVICE_URL          âš ï¸ NecessÃ¡rio para detecÃ§Ã£o\nN8N_WHATSAPP_WEBHOOK      âš ï¸ NecessÃ¡rio para WhatsApp\nGOOGLE_CLIENT_ID          âš ï¸ NecessÃ¡rio para Google Fit\nGOOGLE_CLIENT_SECRET      âš ï¸ NecessÃ¡rio para Google Fit\nRESEND_API_KEY            â“ Opcional para emails\n```\n\n---\n\n## ðŸ“ Estrutura de Arquivos\n\n```\n/\nâ”œâ”€â”€ .env                    # âŒ NÃƒO COMMITAR (git ignored)\nâ”œâ”€â”€ .env.example            # âœ… Template sem valores reais\nâ”œâ”€â”€ .env.local              # âŒ NÃƒO COMMITAR (development)\nâ””â”€â”€ docs/\n    â””â”€â”€ ENVIRONMENT.md      # Esta documentaÃ§Ã£o\n```\n\n### .env.example\n\n```bash\n# ============================================\n# MAXNUTRITION - VARIÃVEIS DE AMBIENTE\n# ============================================\n# Copie este arquivo para .env e preencha os valores\n\n# ------------------------------------------\n# SUPABASE (ObrigatÃ³rias)\n# ------------------------------------------\nVITE_SUPABASE_URL=https://your-project.supabase.co\nVITE_SUPABASE_ANON_KEY=your-anon-key-here\nVITE_SUPABASE_PROJECT_ID=your-project-id\n\n# ------------------------------------------\n# APLICAÃ‡ÃƒO (Opcionais)\n# ------------------------------------------\nVITE_APP_NAME=MaxNutrition\nVITE_APP_URL=https://your-app-url.com\nVITE_DEBUG_MODE=false\nVITE_ENABLE_ANALYTICS=false\n\n# ------------------------------------------\n# MONITORAMENTO (Opcionais)\n# ------------------------------------------\nVITE_SENTRY_DSN=https://your-sentry-dsn\n\n# ============================================\n# EDGE FUNCTIONS\n# ============================================\n# Configurar diretamente no Supabase Dashboard\n# ou via MaxNutrition Cloud Settings\n\n# GOOGLE_AI_API_KEY=your-gemini-key\n# YOLO_SERVICE_URL=https://your-yolo-service.com\n# N8N_WHATSAPP_WEBHOOK=https://your-n8n-webhook\n# RESEND_API_KEY=your-resend-key\n```\n\n---\n\n## ðŸ”’ Boas PrÃ¡ticas de SeguranÃ§a\n\n### âœ… FAZER\n\n1. **Usar .env.example** para documentar variÃ¡veis\n2. **Rotacionar secrets** periodicamente\n3. **Usar chaves diferentes** para dev/staging/prod\n4. **Limitar escopo** de API keys quando possÃ­vel\n5. **Monitorar uso** de API keys\n\n### âŒ NÃƒO FAZER\n\n1. **Nunca commitar** valores reais de secrets\n2. **Nunca logar** secrets no console\n3. **Nunca expor** SERVICE_ROLE_KEY no frontend\n4. **Nunca hardcodar** secrets no cÃ³digo\n5. **Nunca compartilhar** secrets via chat/email\n\n---\n\n## ðŸ” DiagnÃ³stico de Problemas\n\n### VariÃ¡vel nÃ£o encontrada\n\n```typescript\n// Erro: \"import.meta.env.VITE_SUPABASE_URL is undefined\"\n\n// Verificar:\n// 1. Arquivo .env existe na raiz\n// 2. Prefixo VITE_ para variÃ¡veis do frontend\n// 3. Reiniciar servidor de desenvolvimento\n// 4. VariÃ¡vel estÃ¡ no .env correto\n```\n\n### Edge Function sem acesso\n\n```typescript\n// Erro: \"Deno.env.get('GOOGLE_AI_API_KEY') is undefined\"\n\n// Verificar:\n// 1. Secret configurado no MaxNutrition Cloud\n// 2. Nome exato da variÃ¡vel (case-sensitive)\n// 3. Redeploy da Edge Function apÃ³s adicionar secret\n```\n\n### Google Fit OAuth falha\n\n```\n// Erro: \"redirect_uri_mismatch\"\n\n// Verificar:\n// 1. GOOGLE_REDIRECT_URI corresponde ao configurado no Google Console\n// 2. URIs autorizados incluem o domÃ­nio correto\n// 3. Protocolo correto (https:// em produÃ§Ã£o)\n```\n\n---\n\n## ðŸ“‹ Checklist de Deploy\n\nAntes de fazer deploy em produÃ§Ã£o:\n\n- [ ] Todas variÃ¡veis obrigatÃ³rias configuradas\n- [ ] Chaves de produÃ§Ã£o (nÃ£o desenvolvimento)\n- [ ] URLs corretas para ambiente de produÃ§Ã£o\n- [ ] Google Fit OAuth URIs atualizados\n- [ ] YOLO Service URL de produÃ§Ã£o\n- [ ] Secrets do WhatsApp configurados\n- [ ] Monitoramento (Sentry) configurado\n- [ ] Backup das configuraÃ§Ãµes\n\n---\n\n## ðŸ“ PrÃ³ximos Passos\n\n- Consulte `10_DEPLOY_GUIDE.md` para processo de deploy\n- Consulte `05_EDGE_FUNCTIONS.md` para uso das variÃ¡veis\n",
      "sections": [
        "# ðŸ” VariÃ¡veis de Ambiente",
        "## ðŸ“Š VisÃ£o Geral",
        "## ðŸ–¥ï¸ Frontend (Vite)",
        "### Exemplo .env",
        "# .env (Frontend - NÃƒO commitar valores reais!)",
        "# Supabase (ObrigatÃ³rias)",
        "# AplicaÃ§Ã£o (Opcionais)",
        "### Uso no CÃ³digo",
        "## âš¡ Edge Functions (Backend)",
        "### Supabase Core",
        "### IA e AnÃ¡lise",
        "### WhatsApp/ComunicaÃ§Ã£o",
        "### Google Fit",
        "### Storage (MinIO)",
        "## ðŸ”§ ConfiguraÃ§Ã£o de Secrets",
        "### Via MaxNutrition Cloud",
        "### VariÃ¡veis JÃ¡ Configuradas (Auto)",
        "### VariÃ¡veis a Configurar Manualmente",
        "## ðŸ“ Estrutura de Arquivos",
        "### .env.example",
        "# ============================================",
        "# MAXNUTRITION - VARIÃVEIS DE AMBIENTE",
        "# ============================================",
        "# Copie este arquivo para .env e preencha os valores",
        "# ------------------------------------------",
        "# SUPABASE (ObrigatÃ³rias)",
        "# ------------------------------------------",
        "# ------------------------------------------",
        "# APLICAÃ‡ÃƒO (Opcionais)",
        "# ------------------------------------------",
        "# ------------------------------------------",
        "# MONITORAMENTO (Opcionais)",
        "# ------------------------------------------",
        "# ============================================",
        "# EDGE FUNCTIONS",
        "# ============================================",
        "# Configurar diretamente no Supabase Dashboard",
        "# ou via MaxNutrition Cloud Settings",
        "# GOOGLE_AI_API_KEY=your-gemini-key",
        "# YOLO_SERVICE_URL=https://your-yolo-service.com",
        "# N8N_WHATSAPP_WEBHOOK=https://your-n8n-webhook",
        "# RESEND_API_KEY=your-resend-key",
        "## ðŸ”’ Boas PrÃ¡ticas de SeguranÃ§a",
        "### âœ… FAZER",
        "### âŒ NÃƒO FAZER",
        "## ðŸ” DiagnÃ³stico de Problemas",
        "### VariÃ¡vel nÃ£o encontrada",
        "### Edge Function sem acesso",
        "### Google Fit OAuth falha",
        "## ðŸ“‹ Checklist de Deploy",
        "## ðŸ“ PrÃ³ximos Passos"
      ],
      "code_blocks": 18,
      "links": []
    },
    "10_DEPLOY_GUIDE.md": {
      "path": "docs/10_DEPLOY_GUIDE.md",
      "exists": true,
      "lines": 439,
      "size_kb": 8.2080078125,
      "content": "# ðŸš€ Guia de Deploy\n\n> DocumentaÃ§Ã£o gerada em: 2026-01-16\n> Plataforma: MaxNutrition Cloud\n\n---\n\n## ðŸ“Š VisÃ£o Geral\n\n| Ambiente | URL | Branch |\n|----------|-----|--------|\n| Preview | `https://id-preview--*.lovable.app` | feature/* |\n| Production | `https://your-wellness-companion-02.lovable.app` | main |\n\n---\n\n## ðŸ› ï¸ Requisitos\n\n### Sistema\n\n| Requisito | VersÃ£o |\n|-----------|--------|\n| Node.js | 18.x ou superior |\n| npm | 9.x ou superior |\n| Git | 2.x ou superior |\n\n### Contas/Acessos\n\n- [x] Conta Lovable (jÃ¡ configurada)\n- [x] MaxNutrition Cloud habilitado\n- [ ] Google Cloud Console (para Google Fit)\n- [ ] Evolution API (para WhatsApp)\n- [ ] Resend (para emails)\n\n---\n\n## ðŸ’» Desenvolvimento Local\n\n### 1. Clonar RepositÃ³rio\n\n```bash\n# Via Lovable (recomendado)\n# Clique em \"Edit in VS Code\" ou \"Edit in Cursor\"\n\n# Ou via Git\ngit clone https://github.com/your-repo/maxnutrition.git\ncd maxnutrition\n```\n\n### 2. Instalar DependÃªncias\n\n```bash\nnpm install\n```\n\n### 3. Configurar VariÃ¡veis de Ambiente\n\n```bash\n# Copiar template\ncp .env.example .env\n\n# Editar .env com seus valores\n# VITE_SUPABASE_URL=...\n# VITE_SUPABASE_ANON_KEY=...\n```\n\n### 4. Iniciar Servidor de Desenvolvimento\n\n```bash\nnpm run dev\n```\n\nAcesse: `http://localhost:5173`\n\n### 5. Build de ProduÃ§Ã£o (Local)\n\n```bash\n# Build\nnpm run build\n\n# Preview do build\nnpm run preview\n```\n\n---\n\n## â˜ï¸ Deploy via Lovable\n\n### Deploy AutomÃ¡tico\n\nCada push no repositÃ³rio dispara deploy automÃ¡tico:\n\n1. **Preview**: Branches `feature/*` geram preview\n2. **Production**: Branch `main` faz deploy em produÃ§Ã£o\n\n### Deploy Manual\n\n1. Abra o projeto no Lovable\n2. FaÃ§a suas alteraÃ§Ãµes\n3. Clique em \"Deploy\" ou aguarde auto-deploy\n4. Verifique logs de build\n\n### Verificar Status\n\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚                     LOVABLE DASHBOARD                           â”‚\nâ”‚                                                                 â”‚\nâ”‚  Status: âœ… Deployed                                            â”‚\nâ”‚  Last Deploy: 2026-01-16 15:30:00                              â”‚\nâ”‚  Build Time: 45s                                                â”‚\nâ”‚                                                                 â”‚\nâ”‚  URLs:                                                          â”‚\nâ”‚  - Preview: https://id-preview--f520bb44-...lovable.app        â”‚\nâ”‚  - Production: https://your-wellness-companion-02.lovable.app  â”‚\nâ”‚                                                                 â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n---\n\n## ðŸ—„ï¸ Backend (MaxNutrition Cloud)\n\n### Edge Functions\n\nEdge Functions sÃ£o deployadas automaticamente ao salvar.\n\n```bash\n# Estrutura\nsupabase/functions/\nâ”œâ”€â”€ my-function/\nâ”‚   â””â”€â”€ index.ts\nâ””â”€â”€ another-function/\n    â””â”€â”€ index.ts\n```\n\n### Verificar Deploy de Function\n\n```bash\n# Via Lovable\n# 1. Salve a Edge Function\n# 2. Aguarde \"Function deployed\" no log\n# 3. Teste via:\ncurl https://ciszqtlaacrhfwsqnvjr.supabase.co/functions/v1/my-function\n```\n\n### Logs de Edge Functions\n\n```bash\n# No Lovable, use a ferramenta:\n# supabase--edge-function-logs\n\n# Ou via Dashboard\n# Settings > Backend > Logs\n```\n\n---\n\n## ðŸ—ƒï¸ Database Migrations\n\n### Criar Migration\n\n```sql\n-- Via Lovable:\n-- Use a ferramenta supabase--migration\n\n-- Exemplo:\nCREATE TABLE my_table (\n  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n  name TEXT NOT NULL,\n  created_at TIMESTAMPTZ DEFAULT now()\n);\n\n-- Habilitar RLS\nALTER TABLE my_table ENABLE ROW LEVEL SECURITY;\n\n-- Criar policy\nCREATE POLICY \"Users can view own data\"\n  ON my_table FOR SELECT\n  USING (auth.uid() = user_id);\n```\n\n### Aplicar Migration\n\n1. Crie a migration via `supabase--migration`\n2. Revise o SQL gerado\n3. Confirme a aplicaÃ§Ã£o\n4. Verifique no banco\n\n---\n\n## ðŸ” ConfiguraÃ§Ã£o de Secrets\n\n### Via MaxNutrition Cloud UI\n\n1. Acesse Settings do projeto\n2. VÃ¡ em \"Backend Settings\"\n3. Clique em \"Secrets\"\n4. Adicione/edite secrets\n\n### Secrets NecessÃ¡rios\n\n| Secret | ObrigatÃ³rio | Onde Obter |\n|--------|-------------|------------|\n| `GOOGLE_AI_API_KEY` | Sim (IA) | [Google AI Studio](https://makersuite.google.com/) |\n| `YOLO_SERVICE_URL` | Sim (detecÃ§Ã£o) | Seu EasyPanel |\n| `N8N_WHATSAPP_WEBHOOK` | Para WhatsApp | Seu N8N |\n| `GOOGLE_CLIENT_ID` | Para Google Fit | [Google Console](https://console.cloud.google.com/) |\n| `GOOGLE_CLIENT_SECRET` | Para Google Fit | Google Console |\n| `RESEND_API_KEY` | Para emails | [Resend](https://resend.com/) |\n\n---\n\n## ðŸ“± Build Mobile (Capacitor)\n\n### ConfiguraÃ§Ã£o\n\n```typescript\n// capacitor.config.ts\nimport { CapacitorConfig } from '@capacitor/cli';\n\nconst config: CapacitorConfig = {\n  appId: 'com.maxnutrition.app',\n  appName: 'MaxNutrition',\n  webDir: 'dist',\n  server: {\n    androidScheme: 'https'\n  }\n};\n\nexport default config;\n```\n\n### Build Android\n\n```bash\n# Build web\nnpm run build\n\n# Sincronizar com Android\nnpx cap sync android\n\n# Abrir no Android Studio\nnpx cap open android\n\n# Build APK/AAB via Android Studio\n```\n\n### Build iOS\n\n```bash\n# Build web\nnpm run build\n\n# Sincronizar com iOS\nnpx cap sync ios\n\n# Abrir no Xcode\nnpx cap open ios\n\n# Build via Xcode\n```\n\n---\n\n## ðŸ”„ CI/CD Pipeline\n\n### Fluxo AutomÃ¡tico\n\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚   Commit    â”‚ â”€â”€â–º â”‚   Build     â”‚ â”€â”€â–º â”‚   Deploy    â”‚\nâ”‚   Push      â”‚     â”‚   (Vite)    â”‚     â”‚   (Lovable) â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                           â”‚\n                           â–¼\n                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n                    â”‚  TypeCheck  â”‚\n                    â”‚   Lint      â”‚\n                    â”‚   Tests     â”‚\n                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n### Checks AutomÃ¡ticos\n\n- [x] TypeScript compilation\n- [x] ESLint validation\n- [x] Build success\n- [x] Edge Functions deploy\n\n---\n\n## ðŸ“Š Monitoramento\n\n### Sentry (Erros)\n\n```typescript\n// src/main.tsx\nimport * as Sentry from \"@sentry/react\";\n\nSentry.init({\n  dsn: import.meta.env.VITE_SENTRY_DSN,\n  environment: import.meta.env.MODE,\n  tracesSampleRate: 0.1,\n});\n```\n\n### Logs do Backend\n\n```sql\n-- Verificar logs de IA\nSELECT \n  created_at,\n  provider,\n  functionality,\n  success,\n  response_time_ms,\n  error_message\nFROM ai_usage_logs\nWHERE created_at > now() - interval '1 hour'\nORDER BY created_at DESC\nLIMIT 50;\n```\n\n### MÃ©tricas de Uso\n\n```sql\n-- UsuÃ¡rios ativos\nSELECT \n  DATE(created_at) as date,\n  COUNT(DISTINCT user_id) as active_users\nFROM user_activity_logs\nWHERE created_at > now() - interval '7 days'\nGROUP BY DATE(created_at)\nORDER BY date;\n```\n\n---\n\n## ðŸ”§ Troubleshooting\n\n### Build Falha\n\n```bash\n# Erro: TypeScript errors\n# SoluÃ§Ã£o: Verificar erros de tipo\nnpm run typecheck\n\n# Erro: Missing dependencies\n# SoluÃ§Ã£o: Reinstalar\nrm -rf node_modules\nnpm install\n\n# Erro: Out of memory\n# SoluÃ§Ã£o: Aumentar memÃ³ria\nNODE_OPTIONS=--max-old-space-size=4096 npm run build\n```\n\n### Edge Function Falha\n\n```bash\n# Verificar logs\n# Use supabase--edge-function-logs no Lovable\n\n# Erros comuns:\n# 1. Secret nÃ£o configurado â†’ Adicionar secret\n# 2. Timeout â†’ Otimizar funÃ§Ã£o\n# 3. CORS â†’ Verificar headers\n```\n\n### Database Migration Falha\n\n```sql\n-- Verificar erro\n-- Use supabase--analytics-query para ver logs\n\n-- Rollback manual (se necessÃ¡rio)\n-- Criar nova migration que reverte mudanÃ§as\n```\n\n---\n\n## ðŸ“‹ Checklist de Deploy\n\n### PrÃ©-Deploy\n\n- [ ] Todos os testes passando\n- [ ] Sem erros de TypeScript\n- [ ] VariÃ¡veis de ambiente configuradas\n- [ ] Secrets do backend configurados\n- [ ] Migrations aplicadas\n- [ ] Edge Functions testadas\n\n### PÃ³s-Deploy\n\n- [ ] Verificar URL de produÃ§Ã£o\n- [ ] Testar fluxos crÃ­ticos:\n  - [ ] Login/Logout\n  - [ ] AnÃ¡lise de alimentos (Sofia)\n  - [ ] Registro de refeiÃ§Ã£o\n  - [ ] Google Fit sync\n- [ ] Verificar logs de erro\n- [ ] Monitorar mÃ©tricas\n\n---\n\n## ðŸŒ DomÃ­nio Personalizado\n\n### Configurar DomÃ­nio\n\n1. Acesse Settings > Domain no Lovable\n2. Adicione seu domÃ­nio personalizado\n3. Configure DNS conforme instruÃ§Ãµes\n4. Aguarde propagaÃ§Ã£o (atÃ© 24h)\n\n### DNS Records\n\n```\nTipo    Nome    Valor\nA       @       [IP fornecido pelo Lovable]\nCNAME   www     [CNAME fornecido pelo Lovable]\n```\n\n---\n\n## ðŸ“ PrÃ³ximos Passos\n\n- Consulte `09_ENVIRONMENT_VARS.md` para configuraÃ§Ã£o de secrets\n- Consulte `05_EDGE_FUNCTIONS.md` para detalhes do backend\n- Consulte `01_ESTRUTURA_PROJETO.md` para visÃ£o geral\n\n---\n\n## ðŸ“ž Suporte\n\n- **DocumentaÃ§Ã£o MaxNutrition**: https://docs.lovable.dev\n- **Supabase Docs**: https://supabase.com/docs\n- **Comunidade**: https://discord.gg/lovable\n",
      "sections": [
        "# ðŸš€ Guia de Deploy",
        "## ðŸ“Š VisÃ£o Geral",
        "## ðŸ› ï¸ Requisitos",
        "### Sistema",
        "### Contas/Acessos",
        "## ðŸ’» Desenvolvimento Local",
        "### 1. Clonar RepositÃ³rio",
        "# Via Lovable (recomendado)",
        "# Clique em \"Edit in VS Code\" ou \"Edit in Cursor\"",
        "# Ou via Git",
        "### 2. Instalar DependÃªncias",
        "### 3. Configurar VariÃ¡veis de Ambiente",
        "# Copiar template",
        "# Editar .env com seus valores",
        "# VITE_SUPABASE_URL=...",
        "# VITE_SUPABASE_ANON_KEY=...",
        "### 4. Iniciar Servidor de Desenvolvimento",
        "### 5. Build de ProduÃ§Ã£o (Local)",
        "# Build",
        "# Preview do build",
        "## â˜ï¸ Deploy via Lovable",
        "### Deploy AutomÃ¡tico",
        "### Deploy Manual",
        "### Verificar Status",
        "## ðŸ—„ï¸ Backend (MaxNutrition Cloud)",
        "### Edge Functions",
        "# Estrutura",
        "### Verificar Deploy de Function",
        "# Via Lovable",
        "# 1. Salve a Edge Function",
        "# 2. Aguarde \"Function deployed\" no log",
        "# 3. Teste via:",
        "### Logs de Edge Functions",
        "# No Lovable, use a ferramenta:",
        "# supabase--edge-function-logs",
        "# Ou via Dashboard",
        "# Settings > Backend > Logs",
        "## ðŸ—ƒï¸ Database Migrations",
        "### Criar Migration",
        "### Aplicar Migration",
        "## ðŸ” ConfiguraÃ§Ã£o de Secrets",
        "### Via MaxNutrition Cloud UI",
        "### Secrets NecessÃ¡rios",
        "## ðŸ“± Build Mobile (Capacitor)",
        "### ConfiguraÃ§Ã£o",
        "### Build Android",
        "# Build web",
        "# Sincronizar com Android",
        "# Abrir no Android Studio",
        "# Build APK/AAB via Android Studio",
        "### Build iOS",
        "# Build web",
        "# Sincronizar com iOS",
        "# Abrir no Xcode",
        "# Build via Xcode",
        "## ðŸ”„ CI/CD Pipeline",
        "### Fluxo AutomÃ¡tico",
        "### Checks AutomÃ¡ticos",
        "## ðŸ“Š Monitoramento",
        "### Sentry (Erros)",
        "### Logs do Backend",
        "### MÃ©tricas de Uso",
        "## ðŸ”§ Troubleshooting",
        "### Build Falha",
        "# Erro: TypeScript errors",
        "# SoluÃ§Ã£o: Verificar erros de tipo",
        "# Erro: Missing dependencies",
        "# SoluÃ§Ã£o: Reinstalar",
        "# Erro: Out of memory",
        "# SoluÃ§Ã£o: Aumentar memÃ³ria",
        "### Edge Function Falha",
        "# Verificar logs",
        "# Use supabase--edge-function-logs no Lovable",
        "# Erros comuns:",
        "# 1. Secret nÃ£o configurado â†’ Adicionar secret",
        "# 2. Timeout â†’ Otimizar funÃ§Ã£o",
        "# 3. CORS â†’ Verificar headers",
        "### Database Migration Falha",
        "## ðŸ“‹ Checklist de Deploy",
        "### PrÃ©-Deploy",
        "### PÃ³s-Deploy",
        "## ðŸŒ DomÃ­nio Personalizado",
        "### Configurar DomÃ­nio",
        "### DNS Records",
        "## ðŸ“ PrÃ³ximos Passos",
        "## ðŸ“ž Suporte"
      ],
      "code_blocks": 42,
      "links": [
        "https://makersuite.google.com/",
        "https://console.cloud.google.com/",
        "https://resend.com/"
      ]
    },
    "DATABASE_SCHEMA.md": {
      "path": "docs/DATABASE_SCHEMA.md",
      "exists": true,
      "lines": 1182,
      "size_kb": 20.177734375,
      "content": "# ðŸ—„ï¸ Schema Completo do Banco de Dados\n\n**Ãšltima atualizaÃ§Ã£o:** 05 de Janeiro de 2026  \n**Total de Tabelas:** 236 tabelas\n\n---\n\n## ðŸ“‹ Ãndice por Categoria\n\n1. [UsuÃ¡rios e Perfis](#usuÃ¡rios-e-perfis)\n2. [SaÃºde e MediÃ§Ãµes](#saÃºde-e-mediÃ§Ãµes)\n3. [NutriÃ§Ã£o e AlimentaÃ§Ã£o](#nutriÃ§Ã£o-e-alimentaÃ§Ã£o)\n4. [ExercÃ­cios e Atividade](#exercÃ­cios-e-atividade)\n5. [Metas e GamificaÃ§Ã£o](#metas-e-gamificaÃ§Ã£o)\n6. [Cursos e ConteÃºdo](#cursos-e-conteÃºdo)\n7. [Comunidade e Social](#comunidade-e-social)\n8. [IAs e ConfiguraÃ§Ãµes](#ias-e-configuraÃ§Ãµes)\n9. [IntegraÃ§Ãµes Externas](#integraÃ§Ãµes-externas)\n10. [Sistema e Admin](#sistema-e-admin)\n\n---\n\n## ðŸ‘¤ UsuÃ¡rios e Perfis\n\n### profiles\nPerfil principal do usuÃ¡rio.\n\n```sql\nprofiles (\n  id UUID PRIMARY KEY,\n  user_id UUID REFERENCES auth.users,\n  nome TEXT,\n  email TEXT,\n  telefone TEXT,\n  avatar_url TEXT,\n  data_nascimento DATE,\n  genero TEXT,\n  altura_cm INTEGER,\n  peso_inicial NUMERIC,\n  peso_meta NUMERIC,\n  nivel_atividade TEXT,\n  objetivo TEXT,\n  is_admin BOOLEAN DEFAULT false,\n  is_active BOOLEAN DEFAULT true,\n  subscription_status TEXT,\n  subscription_plan TEXT,\n  created_at TIMESTAMPTZ,\n  updated_at TIMESTAMPTZ\n)\n```\n\n### user_anamnesis\nAnamnese mÃ©dica completa do usuÃ¡rio.\n\n```sql\nuser_anamnesis (\n  id UUID PRIMARY KEY,\n  user_id UUID,\n  \n  -- HistÃ³rico mÃ©dico\n  medical_history JSONB,\n  current_medications TEXT[],\n  allergies TEXT[],\n  chronic_conditions TEXT[],\n  surgeries TEXT[],\n  family_history JSONB,\n  \n  -- Estilo de vida\n  smoking_status TEXT,\n  alcohol_consumption TEXT,\n  physical_activity_level TEXT,\n  sleep_quality_score INTEGER,\n  daily_stress_level INTEGER,\n  \n  -- AlimentaÃ§Ã£o\n  dietary_restrictions TEXT[],\n  food_preferences TEXT[],\n  eating_habits JSONB,\n  water_intake_daily INTEGER,\n  \n  -- Objetivos\n  health_goals TEXT[],\n  weight_loss_attempts TEXT,\n  motivation_factors TEXT[],\n  \n  -- Relacionamento com comida\n  emotional_eating BOOLEAN,\n  binge_eating BOOLEAN,\n  food_relationship_notes TEXT,\n  \n  completed_at TIMESTAMPTZ,\n  created_at TIMESTAMPTZ,\n  updated_at TIMESTAMPTZ\n)\n```\n\n### user_physical_data\nDados fÃ­sicos do usuÃ¡rio.\n\n```sql\nuser_physical_data (\n  id UUID PRIMARY KEY,\n  user_id UUID,\n  altura_cm NUMERIC,\n  peso_kg NUMERIC,\n  imc NUMERIC,\n  sexo TEXT,\n  idade INTEGER,\n  circunferencia_cintura NUMERIC,\n  circunferencia_quadril NUMERIC,\n  biotipo TEXT,\n  created_at TIMESTAMPTZ,\n  updated_at TIMESTAMPTZ\n)\n```\n\n---\n\n## ðŸ¥ SaÃºde e MediÃ§Ãµes\n\n### weight_measurements\nMediÃ§Ãµes de peso e composiÃ§Ã£o corporal.\n\n```sql\nweight_measurements (\n  id UUID PRIMARY KEY,\n  user_id UUID,\n  peso_kg NUMERIC NOT NULL,\n  imc NUMERIC,\n  \n  -- ComposiÃ§Ã£o corporal (bioimpedÃ¢ncia)\n  gordura_corporal_percent NUMERIC,\n  massa_muscular_kg NUMERIC,\n  agua_corporal_percent NUMERIC,\n  massa_ossea_kg NUMERIC,\n  taxa_metabolica_basal INTEGER,\n  gordura_visceral INTEGER,\n  idade_corporal INTEGER,\n  proteina_percent NUMERIC,\n  \n  -- Medidas\n  circunferencia_abdominal_cm NUMERIC,\n  circunferencia_braco_cm NUMERIC,\n  circunferencia_coxa_cm NUMERIC,\n  \n  -- Risco\n  risco_cardiometabolico TEXT,\n  \n  -- Metadados\n  measurement_date DATE,\n  source TEXT, -- 'manual', 'xiaomi', 'google_fit'\n  notes TEXT,\n  created_at TIMESTAMPTZ\n)\n```\n\n### sleep_tracking\nMonitoramento de sono.\n\n```sql\nsleep_tracking (\n  id UUID PRIMARY KEY,\n  user_id UUID,\n  date DATE,\n  hours_slept NUMERIC,\n  sleep_quality INTEGER, -- 1-10\n  bedtime TIME,\n  wake_time TIME,\n  deep_sleep_hours NUMERIC,\n  rem_sleep_hours NUMERIC,\n  light_sleep_hours NUMERIC,\n  awake_time_minutes INTEGER,\n  sleep_efficiency NUMERIC,\n  notes TEXT,\n  source TEXT,\n  created_at TIMESTAMPTZ\n)\n```\n\n### mood_tracking\nMonitoramento de humor.\n\n```sql\nmood_tracking (\n  id UUID PRIMARY KEY,\n  user_id UUID,\n  date DATE,\n  mood_score INTEGER, -- 1-10\n  energy_level INTEGER, -- 1-10\n  stress_level INTEGER, -- 1-10\n  anxiety_level INTEGER, -- 1-10\n  emotions TEXT[], -- ['feliz', 'ansioso', 'cansado']\n  notes TEXT,\n  created_at TIMESTAMPTZ\n)\n```\n\n### heart_rate_data\nDados de frequÃªncia cardÃ­aca.\n\n```sql\nheart_rate_data (\n  id UUID PRIMARY KEY,\n  user_id UUID,\n  bpm INTEGER,\n  resting_bpm INTEGER,\n  max_bpm INTEGER,\n  min_bpm INTEGER,\n  recorded_at TIMESTAMPTZ,\n  source TEXT,\n  activity_type TEXT,\n  created_at TIMESTAMPTZ\n)\n```\n\n### medical_documents\nDocumentos mÃ©dicos.\n\n```sql\nmedical_documents (\n  id UUID PRIMARY KEY,\n  user_id UUID,\n  document_type TEXT, -- 'exame', 'receita', 'atestado'\n  title TEXT,\n  description TEXT,\n  file_url TEXT,\n  file_name TEXT,\n  file_size INTEGER,\n  mime_type TEXT,\n  \n  -- Processamento IA\n  status TEXT, -- 'pending', 'processing', 'completed', 'error'\n  extracted_data JSONB,\n  ai_analysis TEXT,\n  \n  -- Metadados\n  document_date DATE,\n  doctor_name TEXT,\n  clinic_name TEXT,\n  \n  created_at TIMESTAMPTZ,\n  updated_at TIMESTAMPTZ\n)\n```\n\n### prescriptions\nPrescriÃ§Ãµes mÃ©dicas.\n\n```sql\nprescriptions (\n  id UUID PRIMARY KEY,\n  user_id UUID,\n  medication_name TEXT,\n  dosage TEXT,\n  frequency TEXT,\n  start_date DATE,\n  end_date DATE,\n  prescriber TEXT,\n  notes TEXT,\n  is_active BOOLEAN,\n  created_at TIMESTAMPTZ\n)\n```\n\n### user_supplements\nSuplementos do usuÃ¡rio.\n\n```sql\nuser_supplements (\n  id UUID PRIMARY KEY,\n  user_id UUID,\n  supplement_name TEXT,\n  brand TEXT,\n  dosage TEXT,\n  frequency TEXT,\n  purpose TEXT,\n  is_active BOOLEAN,\n  start_date DATE,\n  notes TEXT,\n  created_at TIMESTAMPTZ\n)\n```\n\n---\n\n## ðŸŽ NutriÃ§Ã£o e AlimentaÃ§Ã£o\n\n### nutrition_tracking\nRastreamento nutricional diÃ¡rio.\n\n```sql\nnutrition_tracking (\n  id UUID PRIMARY KEY,\n  user_id UUID,\n  date DATE,\n  meal_type TEXT, -- 'cafe_manha', 'almoco', 'lanche', 'jantar', 'ceia'\n  foods_consumed TEXT[],\n  calories INTEGER,\n  protein_g NUMERIC,\n  carbs_g NUMERIC,\n  fat_g NUMERIC,\n  fiber_g NUMERIC,\n  sodium_mg INTEGER,\n  water_ml INTEGER,\n  notes TEXT,\n  created_at TIMESTAMPTZ\n)\n```\n\n### food_analysis\nAnÃ¡lises de alimentos por IA.\n\n```sql\nfood_analysis (\n  id UUID PRIMARY KEY,\n  user_id UUID,\n  meal_type TEXT,\n  image_url TEXT,\n  \n  -- Alimentos detectados\n  foods_detected JSONB,\n  portion_sizes JSONB,\n  \n  -- Valores nutricionais\n  total_calories INTEGER,\n  total_protein NUMERIC,\n  total_carbs NUMERIC,\n  total_fat NUMERIC,\n  total_fiber NUMERIC,\n  \n  -- AnÃ¡lise IA\n  health_score INTEGER, -- 1-100\n  suggestions TEXT[],\n  warnings TEXT[],\n  \n  -- Status\n  confirmed BOOLEAN DEFAULT false,\n  user_adjustments JSONB,\n  \n  created_at TIMESTAMPTZ\n)\n```\n\n### water_tracking\nMonitoramento de hidrataÃ§Ã£o.\n\n```sql\nwater_tracking (\n  id UUID PRIMARY KEY,\n  user_id UUID,\n  date DATE,\n  amount_ml INTEGER,\n  total_daily_ml INTEGER,\n  goal_ml INTEGER,\n  created_at TIMESTAMPTZ\n)\n```\n\n### nutrition_foods\nBase de alimentos.\n\n```sql\nnutrition_foods (\n  id UUID PRIMARY KEY,\n  food_name TEXT NOT NULL,\n  category TEXT,\n  portion_size TEXT,\n  portion_weight_g NUMERIC,\n  \n  -- Macros por porÃ§Ã£o\n  calories NUMERIC,\n  protein_g NUMERIC,\n  carbs_g NUMERIC,\n  fat_g NUMERIC,\n  fiber_g NUMERIC,\n  sugar_g NUMERIC,\n  sodium_mg NUMERIC,\n  \n  -- Micros\n  vitamins JSONB,\n  minerals JSONB,\n  \n  -- Metadados\n  source TEXT, -- 'taco', 'usda', 'manual'\n  is_verified BOOLEAN,\n  created_at TIMESTAMPTZ\n)\n```\n\n### nutrition_aliases\nAliases para normalizaÃ§Ã£o de nomes.\n\n```sql\nnutrition_aliases (\n  id UUID PRIMARY KEY,\n  food_id UUID REFERENCES nutrition_foods,\n  alias TEXT,\n  alias_normalized TEXT,\n  created_at TIMESTAMPTZ\n)\n```\n\n### meal_plans\nPlanos de refeiÃ§Ã£o.\n\n```sql\nmeal_plans (\n  id UUID PRIMARY KEY,\n  user_id UUID,\n  plan_name TEXT,\n  start_date DATE,\n  end_date DATE,\n  meals JSONB, -- estrutura de refeiÃ§Ãµes por dia\n  total_daily_calories INTEGER,\n  created_by TEXT, -- 'ai', 'nutritionist', 'user'\n  is_active BOOLEAN,\n  created_at TIMESTAMPTZ\n)\n```\n\n---\n\n## ðŸ’ª ExercÃ­cios e Atividade\n\n### exercise_tracking\nRegistro de exercÃ­cios.\n\n```sql\nexercise_tracking (\n  id UUID PRIMARY KEY,\n  user_id UUID,\n  date DATE,\n  exercise_type TEXT,\n  exercise_name TEXT,\n  duration_minutes INTEGER,\n  calories_burned INTEGER,\n  intensity TEXT, -- 'leve', 'moderado', 'intenso'\n  heart_rate_avg INTEGER,\n  distance_km NUMERIC,\n  sets INTEGER,\n  reps INTEGER,\n  weight_kg NUMERIC,\n  notes TEXT,\n  source TEXT,\n  created_at TIMESTAMPTZ\n)\n```\n\n### workout_plans\nPlanos de treino.\n\n```sql\nworkout_plans (\n  id UUID PRIMARY KEY,\n  user_id UUID,\n  plan_name TEXT,\n  description TEXT,\n  goal TEXT,\n  difficulty TEXT,\n  duration_weeks INTEGER,\n  workouts_per_week INTEGER,\n  exercises JSONB,\n  is_active BOOLEAN,\n  created_at TIMESTAMPTZ\n)\n```\n\n### google_fit_data\nDados sincronizados do Google Fit.\n\n```sql\ngoogle_fit_data (\n  id UUID PRIMARY KEY,\n  user_id UUID,\n  date DATE,\n  \n  -- Atividade\n  steps INTEGER,\n  calories INTEGER,\n  distance_meters INTEGER,\n  active_minutes INTEGER,\n  \n  -- Cardio\n  heart_rate_avg INTEGER,\n  heart_rate_min INTEGER,\n  heart_rate_max INTEGER,\n  heart_rate_resting INTEGER,\n  \n  -- Sono\n  sleep_hours NUMERIC,\n  sleep_efficiency NUMERIC,\n  sleep_stages JSONB,\n  \n  -- Corpo\n  weight_kg NUMERIC,\n  height_cm INTEGER,\n  bmi NUMERIC,\n  body_fat_percentage NUMERIC,\n  muscle_mass_kg NUMERIC,\n  \n  -- HidrataÃ§Ã£o\n  hydration_ml INTEGER,\n  water_intake_ml INTEGER,\n  \n  -- NutriÃ§Ã£o\n  nutrition_calories INTEGER,\n  protein_g NUMERIC,\n  carbs_g NUMERIC,\n  fat_g NUMERIC,\n  \n  -- Metadados\n  sync_timestamp TIMESTAMPTZ,\n  data_quality INTEGER,\n  raw_data JSONB,\n  \n  UNIQUE(user_id, date)\n)\n```\n\n---\n\n## ðŸŽ¯ Metas e GamificaÃ§Ã£o\n\n### user_goals\nMetas do usuÃ¡rio.\n\n```sql\nuser_goals (\n  id UUID PRIMARY KEY,\n  user_id UUID,\n  title TEXT NOT NULL,\n  description TEXT,\n  category TEXT, -- 'peso', 'exercicio', 'nutricao', 'sono'\n  \n  -- Valores\n  target_value NUMERIC,\n  current_value NUMERIC DEFAULT 0,\n  unit TEXT,\n  \n  -- Datas\n  start_date DATE,\n  target_date DATE,\n  completed_at TIMESTAMPTZ,\n  \n  -- ConfiguraÃ§Ãµes\n  difficulty TEXT,\n  is_group_goal BOOLEAN DEFAULT false,\n  evidence_required BOOLEAN DEFAULT false,\n  \n  -- GamificaÃ§Ã£o\n  estimated_points INTEGER,\n  challenge_id UUID,\n  \n  -- Status\n  status TEXT DEFAULT 'active',\n  \n  created_at TIMESTAMPTZ,\n  updated_at TIMESTAMPTZ\n)\n```\n\n### goal_updates\nAtualizaÃ§Ãµes de progresso.\n\n```sql\ngoal_updates (\n  id UUID PRIMARY KEY,\n  goal_id UUID REFERENCES user_goals,\n  user_id UUID,\n  previous_value NUMERIC,\n  new_value NUMERIC,\n  notes TEXT,\n  evidence_url TEXT,\n  created_at TIMESTAMPTZ\n)\n```\n\n### challenges\nDesafios disponÃ­veis.\n\n```sql\nchallenges (\n  id UUID PRIMARY KEY,\n  title TEXT NOT NULL,\n  description TEXT,\n  challenge_type TEXT,\n  difficulty TEXT,\n  \n  -- ConfiguraÃ§Ãµes\n  duration_days INTEGER,\n  start_date DATE,\n  end_date DATE,\n  target_value NUMERIC,\n  target_unit TEXT,\n  \n  -- Recompensas\n  points_reward INTEGER,\n  xp_reward INTEGER,\n  badge_name TEXT,\n  badge_icon TEXT,\n  \n  -- Regras\n  rules TEXT,\n  tips TEXT[],\n  requirements JSONB,\n  \n  -- Status\n  is_active BOOLEAN DEFAULT true,\n  is_featured BOOLEAN DEFAULT false,\n  max_participants INTEGER,\n  \n  created_at TIMESTAMPTZ\n)\n```\n\n### challenge_participations\nParticipaÃ§Ãµes em desafios.\n\n```sql\nchallenge_participations (\n  id UUID PRIMARY KEY,\n  challenge_id UUID REFERENCES challenges,\n  user_id UUID,\n  \n  -- Progresso\n  progress NUMERIC DEFAULT 0,\n  target_value NUMERIC,\n  current_streak INTEGER DEFAULT 0,\n  best_streak INTEGER DEFAULT 0,\n  \n  -- Status\n  is_completed BOOLEAN DEFAULT false,\n  completed_at TIMESTAMPTZ,\n  points_earned INTEGER DEFAULT 0,\n  \n  started_at TIMESTAMPTZ,\n  created_at TIMESTAMPTZ\n)\n```\n\n### user_achievements\nConquistas desbloqueadas.\n\n```sql\nuser_achievements (\n  id UUID PRIMARY KEY,\n  user_id UUID,\n  achievement_name TEXT,\n  achievement_type TEXT,\n  description TEXT,\n  badge_icon TEXT,\n  points_value INTEGER,\n  unlocked_at TIMESTAMPTZ,\n  created_at TIMESTAMPTZ\n)\n```\n\n### user_points\nSistema de pontos.\n\n```sql\nuser_points (\n  id UUID PRIMARY KEY,\n  user_id UUID UNIQUE,\n  total_points INTEGER DEFAULT 0,\n  current_streak INTEGER DEFAULT 0,\n  best_streak INTEGER DEFAULT 0,\n  level INTEGER DEFAULT 1,\n  xp INTEGER DEFAULT 0,\n  xp_to_next_level INTEGER,\n  updated_at TIMESTAMPTZ\n)\n```\n\n### daily_mission_sessions\nSessÃµes de missÃµes diÃ¡rias.\n\n```sql\ndaily_mission_sessions (\n  id UUID PRIMARY KEY,\n  user_id UUID,\n  date DATE,\n  \n  -- MissÃµes\n  missions_completed INTEGER DEFAULT 0,\n  missions_total INTEGER,\n  missions_data JSONB,\n  \n  -- Pontos\n  points_earned INTEGER DEFAULT 0,\n  bonus_earned INTEGER DEFAULT 0,\n  \n  -- Status\n  is_completed BOOLEAN DEFAULT false,\n  \n  created_at TIMESTAMPTZ\n)\n```\n\n---\n\n## ðŸ“š Cursos e ConteÃºdo\n\n### courses\nCursos disponÃ­veis.\n\n```sql\ncourses (\n  id UUID PRIMARY KEY,\n  title TEXT NOT NULL,\n  description TEXT,\n  thumbnail_url TEXT,\n  instructor TEXT,\n  category TEXT,\n  difficulty TEXT,\n  duration_hours NUMERIC,\n  \n  -- Status\n  is_published BOOLEAN DEFAULT false,\n  is_featured BOOLEAN DEFAULT false,\n  is_free BOOLEAN DEFAULT false,\n  \n  -- PreÃ§o\n  price NUMERIC,\n  \n  -- Ordem\n  order_index INTEGER,\n  \n  created_at TIMESTAMPTZ,\n  updated_at TIMESTAMPTZ\n)\n```\n\n### course_modules\nMÃ³dulos de cursos.\n\n```sql\ncourse_modules (\n  id UUID PRIMARY KEY,\n  course_id UUID REFERENCES courses,\n  title TEXT NOT NULL,\n  description TEXT,\n  thumbnail_url TEXT,\n  order_index INTEGER,\n  is_published BOOLEAN DEFAULT true,\n  created_at TIMESTAMPTZ\n)\n```\n\n### lessons\nAulas.\n\n```sql\nlessons (\n  id UUID PRIMARY KEY,\n  module_id UUID REFERENCES course_modules,\n  course_id UUID REFERENCES courses,\n  title TEXT NOT NULL,\n  description TEXT,\n  video_url TEXT,\n  thumbnail_url TEXT,\n  duration_minutes INTEGER,\n  \n  -- ConteÃºdo\n  content TEXT,\n  resources JSONB,\n  \n  -- Status\n  is_free BOOLEAN DEFAULT false,\n  is_published BOOLEAN DEFAULT true,\n  order_index INTEGER,\n  \n  created_at TIMESTAMPTZ\n)\n```\n\n### lesson_progress\nProgresso nas aulas.\n\n```sql\nlesson_progress (\n  id UUID PRIMARY KEY,\n  user_id UUID,\n  lesson_id UUID REFERENCES lessons,\n  course_id UUID,\n  \n  -- Progresso\n  progress_percent NUMERIC DEFAULT 0,\n  is_completed BOOLEAN DEFAULT false,\n  completed_at TIMESTAMPTZ,\n  \n  -- Tempo\n  watch_time_seconds INTEGER DEFAULT 0,\n  last_position_seconds INTEGER DEFAULT 0,\n  \n  created_at TIMESTAMPTZ,\n  updated_at TIMESTAMPTZ\n)\n```\n\n### sessions\nSessÃµes de conteÃºdo (meditaÃ§Ãµes, reflexÃµes).\n\n```sql\nsessions (\n  id UUID PRIMARY KEY,\n  title TEXT NOT NULL,\n  description TEXT,\n  content_type TEXT, -- 'meditacao', 'reflexao', 'exercicio'\n  category TEXT,\n  \n  -- MÃ­dia\n  audio_url TEXT,\n  video_url TEXT,\n  image_url TEXT,\n  \n  -- ConteÃºdo\n  content TEXT,\n  script TEXT,\n  \n  -- DuraÃ§Ã£o\n  duration_minutes INTEGER,\n  \n  -- Status\n  is_premium BOOLEAN DEFAULT false,\n  is_published BOOLEAN DEFAULT true,\n  order_index INTEGER,\n  \n  created_at TIMESTAMPTZ\n)\n```\n\n---\n\n## ðŸ‘¥ Comunidade e Social\n\n### community_posts\nPosts da comunidade.\n\n```sql\ncommunity_posts (\n  id UUID PRIMARY KEY,\n  user_id UUID,\n  \n  -- ConteÃºdo\n  content TEXT,\n  image_url TEXT,\n  post_type TEXT, -- 'texto', 'foto', 'progresso', 'conquista'\n  \n  -- MÃ©tricas\n  likes_count INTEGER DEFAULT 0,\n  comments_count INTEGER DEFAULT 0,\n  \n  -- Privacidade\n  is_public BOOLEAN DEFAULT true,\n  \n  created_at TIMESTAMPTZ,\n  updated_at TIMESTAMPTZ\n)\n```\n\n### comments\nComentÃ¡rios.\n\n```sql\ncomments (\n  id UUID PRIMARY KEY,\n  post_id UUID REFERENCES community_posts,\n  user_id UUID,\n  parent_comment_id UUID, -- para respostas\n  content TEXT,\n  created_at TIMESTAMPTZ\n)\n```\n\n### likes\nCurtidas.\n\n```sql\nlikes (\n  id UUID PRIMARY KEY,\n  post_id UUID,\n  comment_id UUID,\n  user_id UUID,\n  created_at TIMESTAMPTZ,\n  UNIQUE(post_id, user_id),\n  UNIQUE(comment_id, user_id)\n)\n```\n\n### follows\nSeguidores.\n\n```sql\nfollows (\n  id UUID PRIMARY KEY,\n  follower_id UUID,\n  following_id UUID,\n  created_at TIMESTAMPTZ,\n  UNIQUE(follower_id, following_id)\n)\n```\n\n---\n\n## ðŸ¤– IAs e ConfiguraÃ§Ãµes\n\n### ai_configurations\nConfiguraÃ§Ãµes de IA.\n\n```sql\nai_configurations (\n  id UUID PRIMARY KEY,\n  functionality TEXT NOT NULL, -- 'dr_vital_chat', 'chat_daily', etc\n  service TEXT DEFAULT 'lovable',\n  model TEXT DEFAULT 'google/gemini-2.5-flash',\n  max_tokens INTEGER DEFAULT 1024,\n  temperature NUMERIC DEFAULT 0.7,\n  system_prompt TEXT,\n  personality TEXT,\n  level TEXT,\n  is_enabled BOOLEAN DEFAULT true,\n  priority INTEGER DEFAULT 1,\n  cost_per_request NUMERIC DEFAULT 0.01,\n  created_at TIMESTAMPTZ,\n  updated_at TIMESTAMPTZ\n)\n```\n\n### conversations\nConversas com IAs.\n\n```sql\nconversations (\n  id UUID PRIMARY KEY,\n  user_id UUID,\n  agent TEXT, -- 'sofia', 'dr_vital'\n  title TEXT,\n  last_message_at TIMESTAMPTZ,\n  created_at TIMESTAMPTZ\n)\n```\n\n### conversation_messages\nMensagens de conversas.\n\n```sql\nconversation_messages (\n  id UUID PRIMARY KEY,\n  conversation_id UUID REFERENCES conversations,\n  role TEXT, -- 'user', 'assistant'\n  content TEXT,\n  model TEXT, -- modelo usado\n  tokens_used INTEGER,\n  created_at TIMESTAMPTZ\n)\n```\n\n### user_conversations\nHistÃ³rico permanente de conversas.\n\n```sql\nuser_conversations (\n  id UUID PRIMARY KEY,\n  user_id UUID,\n  conversation_id TEXT,\n  message_role TEXT,\n  message_content TEXT,\n  timestamp TIMESTAMPTZ,\n  session_metadata JSONB,\n  analysis_type TEXT,\n  context JSONB,\n  created_at TIMESTAMPTZ\n)\n```\n\n### dr_vital_memory\nMemÃ³ria de longo prazo do Dr. Vital.\n\n```sql\ndr_vital_memory (\n  id UUID PRIMARY KEY,\n  user_id UUID,\n  key TEXT, -- 'long_term_summary', 'allergies', 'chronic_flags'\n  value JSONB,\n  updated_at TIMESTAMPTZ,\n  UNIQUE(user_id, key)\n)\n```\n\n### base_de_conhecimento_sofia\nBase de conhecimento da Sofia.\n\n```sql\nbase_de_conhecimento_sofia (\n  id UUID PRIMARY KEY,\n  categoria TEXT NOT NULL,\n  topico TEXT NOT NULL,\n  conteudo TEXT NOT NULL,\n  fonte TEXT,\n  referencias TEXT[],\n  tags TEXT[],\n  relevancia INTEGER,\n  is_active BOOLEAN DEFAULT true,\n  created_at TIMESTAMPTZ,\n  updated_at TIMESTAMPTZ\n)\n```\n\n### ai_usage_logs\nLogs de uso de IA.\n\n```sql\nai_usage_logs (\n  id UUID PRIMARY KEY,\n  user_id UUID,\n  service_name TEXT,\n  model TEXT,\n  prompt_tokens INTEGER,\n  completion_tokens INTEGER,\n  total_tokens INTEGER,\n  cost NUMERIC,\n  created_at TIMESTAMPTZ\n)\n```\n\n---\n\n## ðŸ”— IntegraÃ§Ãµes Externas\n\n### google_fit_tokens\nTokens do Google Fit.\n\n```sql\ngoogle_fit_tokens (\n  id UUID PRIMARY KEY,\n  user_id UUID UNIQUE,\n  access_token TEXT,\n  refresh_token TEXT,\n  expires_at TIMESTAMPTZ,\n  token_type TEXT DEFAULT 'Bearer',\n  scope TEXT,\n  created_at TIMESTAMPTZ,\n  updated_at TIMESTAMPTZ\n)\n```\n\n### n8n_webhooks\nWebhooks n8n.\n\n```sql\nn8n_webhooks (\n  id UUID PRIMARY KEY,\n  name TEXT,\n  url TEXT,\n  event_type TEXT,\n  is_active BOOLEAN DEFAULT true,\n  created_at TIMESTAMPTZ\n)\n```\n\n### n8n_webhook_logs\nLogs de webhooks.\n\n```sql\nn8n_webhook_logs (\n  id UUID PRIMARY KEY,\n  webhook_id UUID REFERENCES n8n_webhooks,\n  status TEXT,\n  response JSONB,\n  created_at TIMESTAMPTZ\n)\n```\n\n---\n\n## âš™ï¸ Sistema e Admin\n\n### admin_logs\nLogs de aÃ§Ãµes administrativas.\n\n```sql\nadmin_logs (\n  id UUID PRIMARY KEY,\n  admin_id UUID,\n  action TEXT,\n  target_type TEXT,\n  target_id TEXT,\n  details JSONB,\n  ip_address TEXT,\n  created_at TIMESTAMPTZ\n)\n```\n\n### company_configurations\nConfiguraÃ§Ãµes da empresa.\n\n```sql\ncompany_configurations (\n  id UUID PRIMARY KEY,\n  company_name TEXT,\n  mission TEXT,\n  vision TEXT,\n  values TEXT,\n  about_us TEXT,\n  main_services TEXT,\n  differentials TEXT,\n  target_audience TEXT,\n  health_philosophy TEXT,\n  company_culture TEXT,\n  created_at TIMESTAMPTZ,\n  updated_at TIMESTAMPTZ\n)\n```\n\n### daily_responses\nRespostas diÃ¡rias dos usuÃ¡rios.\n\n```sql\ndaily_responses (\n  id UUID PRIMARY KEY,\n  user_id UUID,\n  date DATE,\n  section TEXT, -- 'morning', 'evening', 'saboteurs'\n  question_id TEXT,\n  answer TEXT,\n  text_response TEXT,\n  points_earned INTEGER DEFAULT 0,\n  created_at TIMESTAMPTZ\n)\n```\n\n---\n\n## ðŸ“Š EstatÃ­sticas\n\n| Categoria | Quantidade |\n|-----------|------------|\n| UsuÃ¡rios e Perfis | 5 tabelas |\n| SaÃºde e MediÃ§Ãµes | 7 tabelas |\n| NutriÃ§Ã£o | 8 tabelas |\n| ExercÃ­cios | 4 tabelas |\n| Metas e GamificaÃ§Ã£o | 8 tabelas |\n| Cursos | 5 tabelas |\n| Comunidade | 4 tabelas |\n| IAs | 8 tabelas |\n| IntegraÃ§Ãµes | 3 tabelas |\n| Sistema | 3+ tabelas |\n| **Total Principal** | ~55 tabelas |\n| **Total Geral** | 236 tabelas |\n\n---\n\n## ðŸ” PolÃ­ticas RLS\n\n### PadrÃ£o de PolÃ­ticas\n\n```sql\n-- UsuÃ¡rios veem apenas seus dados\nCREATE POLICY \"Users see own data\" ON table_name\nFOR SELECT USING (auth.uid() = user_id);\n\n-- UsuÃ¡rios inserem apenas seus dados\nCREATE POLICY \"Users insert own data\" ON table_name\nFOR INSERT WITH CHECK (auth.uid() = user_id);\n\n-- UsuÃ¡rios atualizam apenas seus dados\nCREATE POLICY \"Users update own data\" ON table_name\nFOR UPDATE USING (auth.uid() = user_id);\n\n-- Admins tÃªm acesso total\nCREATE POLICY \"Admins full access\" ON table_name\nUSING (\n  auth.jwt()->'app_metadata'->>'role' = 'admin' OR\n  auth.jwt()->'user_metadata'->>'role' = 'admin'\n);\n```\n\n---\n\n*DocumentaÃ§Ã£o gerada em 05/01/2026*\n",
      "sections": [
        "# ðŸ—„ï¸ Schema Completo do Banco de Dados",
        "## ðŸ“‹ Ãndice por Categoria",
        "## ðŸ‘¤ UsuÃ¡rios e Perfis",
        "### profiles",
        "### user_anamnesis",
        "### user_physical_data",
        "## ðŸ¥ SaÃºde e MediÃ§Ãµes",
        "### weight_measurements",
        "### sleep_tracking",
        "### mood_tracking",
        "### heart_rate_data",
        "### medical_documents",
        "### prescriptions",
        "### user_supplements",
        "## ðŸŽ NutriÃ§Ã£o e AlimentaÃ§Ã£o",
        "### nutrition_tracking",
        "### food_analysis",
        "### water_tracking",
        "### nutrition_foods",
        "### nutrition_aliases",
        "### meal_plans",
        "## ðŸ’ª ExercÃ­cios e Atividade",
        "### exercise_tracking",
        "### workout_plans",
        "### google_fit_data",
        "## ðŸŽ¯ Metas e GamificaÃ§Ã£o",
        "### user_goals",
        "### goal_updates",
        "### challenges",
        "### challenge_participations",
        "### user_achievements",
        "### user_points",
        "### daily_mission_sessions",
        "## ðŸ“š Cursos e ConteÃºdo",
        "### courses",
        "### course_modules",
        "### lessons",
        "### lesson_progress",
        "### sessions",
        "## ðŸ‘¥ Comunidade e Social",
        "### community_posts",
        "### comments",
        "### likes",
        "### follows",
        "## ðŸ¤– IAs e ConfiguraÃ§Ãµes",
        "### ai_configurations",
        "### conversations",
        "### conversation_messages",
        "### user_conversations",
        "### dr_vital_memory",
        "### base_de_conhecimento_sofia",
        "### ai_usage_logs",
        "## ðŸ”— IntegraÃ§Ãµes Externas",
        "### google_fit_tokens",
        "### n8n_webhooks",
        "### n8n_webhook_logs",
        "## âš™ï¸ Sistema e Admin",
        "### admin_logs",
        "### company_configurations",
        "### daily_responses",
        "## ðŸ“Š EstatÃ­sticas",
        "## ðŸ” PolÃ­ticas RLS",
        "### PadrÃ£o de PolÃ­ticas"
      ],
      "code_blocks": 98,
      "links": [
        "#usuÃ¡rios-e-perfis",
        "#saÃºde-e-mediÃ§Ãµes",
        "#nutriÃ§Ã£o-e-alimentaÃ§Ã£o",
        "#exercÃ­cios-e-atividade",
        "#metas-e-gamificaÃ§Ã£o",
        "#cursos-e-conteÃºdo",
        "#comunidade-e-social",
        "#ias-e-configuraÃ§Ãµes",
        "#integraÃ§Ãµes-externas",
        "#sistema-e-admin"
      ]
    },
    "ARCHITECTURE.md": {
      "path": "docs/ARCHITECTURE.md",
      "exists": true,
      "lines": 86,
      "size_kb": 2.1142578125,
      "content": "### System Architecture\n\nThis document summarizes the frontend, backend (Supabase), and data flows.\n\n#### High-level\n\n```mermaid\ngraph TD\n  A[React App (Vite, TS, Tailwind)] -->|Supabase JS| B[(Supabase Postgres)]\n  A --> C[Storage Buckets]\n  A --> D[Edge Functions]\n  D --> B\n  D --> C\n```\n\n#### Component overview\n\n```mermaid\ngraph LR\n  subgraph Frontend\n    UI[UI Components]\n    Admin[Admin Manager]\n    Courses[Premium Courses]\n    Goals[Goals & Invites]\n    Missions[Daily Missions]\n    Sessions[Coaching Sessions]\n    Wheels[Wheels (Health/Abundance)]\n    Saboteurs[Saboteur Test]\n    SmartScale[Smart Scale]\n  end\n\n  subgraph Supabase\n    DB[(Postgres)]\n    Storage[(Storage)]\n    Edge[Edge Functions]\n    Auth[Auth]\n  end\n\n  UI --> Auth\n  Admin --> DB\n  Courses --> DB\n  Courses --> Storage\n  Goals --> DB\n  Missions --> DB\n  Sessions --> DB\n  Wheels --> DB\n  Saboteurs --> DB\n  SmartScale --> Edge\n  Edge --> DB\n  Edge --> Storage\n```\n\n#### Sequence: Create Group Goal with Invites\n\n```mermaid\nsequenceDiagram\n  participant U as User\n  participant FE as React App\n  participant DB as Supabase DB\n  participant FN as Edge Function goal-notifications\n\n  U->>FE: fill goal form + invites\n  FE->>DB: insert into user_goals\n  DB-->>FE: goal id\n  FE->>DB: insert rows into user_goal_invitations\n  FE->>FN: invoke(goal_invite, recipientUserId/email)\n  FN->>DB: lookup profiles/auth\n  FN->>U: send email/whatsapp via providers\n```\n\n#### Alias Health\n- tsconfig paths: `@/*` â†’ `./src/*` (only alias; healthy).\n- No other `@components/*` style aliases defined; use relative or `@/components/...`.\n\n#### Key frontend entry points\n- Router in `src/App.tsx` defines `/app/courses`, `/app/goals`, `/app/sessions`, `/app/abundance-wheel`, `/app/saboteur-test`, etc.\n\n#### Backend overview\n- Database defined via SQL migrations in `supabase/migrations/*`.\n- Edge functions under `supabase/functions/*`.\n- Storage buckets: avatars, community-uploads, chat-images, course-thumbnails. Policies applied per-bucket.\n\nSecurity note\n- RLS writes for sessions/lessons restricted to admins; admin detected via JWT `app_metadata.role = 'admin'` or `user_metadata.role = 'admin'`.\n\n",
      "sections": [
        "### System Architecture",
        "#### High-level",
        "#### Component overview",
        "#### Sequence: Create Group Goal with Invites",
        "#### Alias Health",
        "#### Key frontend entry points",
        "#### Backend overview"
      ],
      "code_blocks": 6,
      "links": []
    },
    "AI_SYSTEMS.md": {
      "path": "docs/AI_SYSTEMS.md",
      "exists": true,
      "lines": 489,
      "size_kb": 13.5234375,
      "content": "# ðŸ¤– DocumentaÃ§Ã£o dos Sistemas de IA\n\n**Ãšltima atualizaÃ§Ã£o:** 05 de Janeiro de 2026\n\n---\n\n## ðŸ“‹ Ãndice\n\n1. [VisÃ£o Geral](#visÃ£o-geral)\n2. [Sofia - Assistente Nutricional](#sofia---assistente-nutricional)\n3. [Dr. Vital - Mentor de SaÃºde](#dr-vital---mentor-de-saÃºde)\n4. [ConfiguraÃ§Ã£o de IA](#configuraÃ§Ã£o-de-ia)\n5. [Modelos Suportados](#modelos-suportados)\n6. [Base de Conhecimento](#base-de-conhecimento)\n\n---\n\n## ðŸŽ¯ VisÃ£o Geral\n\nO sistema Dr. Vita conta com duas IAs principais que trabalham em conjunto para fornecer acompanhamento de saÃºde personalizado:\n\n| IA | Especialidade | Personalidade | Foco |\n|----|---------------|---------------|------|\n| **Sofia** | NutriÃ§Ã£o | Carinhosa, empÃ¡tica | AlimentaÃ§Ã£o, anÃ¡lise de refeiÃ§Ãµes |\n| **Dr. Vital** | SaÃºde geral | Profissional, acolhedor | SaÃºde integral, orientaÃ§Ãµes mÃ©dicas |\n\n### Arquitetura de IA\n\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚                    Frontend React                        â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚                                                          â”‚\nâ”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚\nâ”‚   â”‚  SofiaChat  â”‚                 â”‚  DrVitalChat    â”‚   â”‚\nâ”‚   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚\nâ”‚          â”‚                                  â”‚            â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n           â”‚                                  â”‚\n           â–¼                                  â–¼\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚ sofia-enhanced-memoryâ”‚      â”‚     dr-vital-chat         â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚ â€¢ Contexto unificado â”‚      â”‚ â€¢ 20+ tabelas de dados    â”‚\nâ”‚ â€¢ MemÃ³ria persistenteâ”‚      â”‚ â€¢ MemÃ³ria de longo prazo  â”‚\nâ”‚ â€¢ HistÃ³rico conversasâ”‚      â”‚ â€¢ AnÃ¡lise multidimensionalâ”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n           â”‚                               â”‚\n           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                       â–¼\n         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n         â”‚   _shared/user-complete-    â”‚\n         â”‚      context.ts             â”‚\n         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\n         â”‚ â€¢ Busca em 30+ tabelas      â”‚\n         â”‚ â€¢ Calcula completude        â”‚\n         â”‚ â€¢ Gera resumo textual       â”‚\n         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                        â–¼\n         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n         â”‚     MaxNutrition AI Gateway      â”‚\n         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\n         â”‚ â€¢ Gemini 2.5 Pro/Flash      â”‚\n         â”‚ â€¢ GPT-5/Mini/Nano           â”‚\n         â”‚ â€¢ Fallback automÃ¡tico       â”‚\n         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n---\n\n## ðŸ’š Sofia - Assistente Nutricional\n\n### Identidade\n\n**Nome:** Sofia  \n**Papel:** Nutricionista virtual do Instituto dos Sonhos  \n**Personalidade:**\n- Super amorosa, carinhosa e empÃ¡tica\n- Usa emojis naturalmente ðŸ’š\n- Como uma amiga querida que se importa\n- Demonstra alegria genuÃ­na ao ajudar\n\n### Funcionalidades\n\n#### 1. Chat Nutricional\n- Responde dÃºvidas sobre alimentaÃ§Ã£o\n- Sugere melhorias nas refeiÃ§Ãµes\n- Incentiva hÃ¡bitos saudÃ¡veis\n- Respostas curtas (2-4 frases)\n\n#### 2. AnÃ¡lise de Imagens\n```typescript\n// Entrada\n{\n  message: \"Analise minha refeiÃ§Ã£o\",\n  userId: \"uuid\",\n  context: {\n    imageUrl: \"https://...\"\n  }\n}\n\n// SaÃ­da\n{\n  message: \"Que refeiÃ§Ã£o linda, amor! ðŸ’š Vejo arroz integral...\",\n  analysis: {\n    foods: [\"arroz integral\", \"frango grelhado\", \"salada\"],\n    calories: 450,\n    protein: 35,\n    carbs: 45,\n    fat: 12\n  }\n}\n```\n\n#### 3. MemÃ³ria Persistente\n- Lembra conversas anteriores\n- Conhece histÃ³rico do usuÃ¡rio\n- Personaliza respostas baseado em dados\n\n### Edge Functions\n\n| Function | DescriÃ§Ã£o |\n|----------|-----------|\n| `sofia-enhanced-memory` | Chat principal com memÃ³ria |\n| `sofia-image-analysis` | AnÃ¡lise de imagens |\n| `sofia-deterministic` | Respostas padronizadas |\n\n### Tabelas Utilizadas\n\n```sql\n-- HistÃ³rico de conversas\nuser_conversations (\n  user_id, conversation_id, message_role,\n  message_content, timestamp, analysis_type\n)\n\n-- AnÃ¡lises de comida\nfood_analysis (\n  user_id, meal_type, foods_detected,\n  total_calories, macros, image_url\n)\n\n-- Base de conhecimento\nbase_de_conhecimento_sofia (\n  categoria, topico, conteudo, \n  referencias, tags, relevancia\n)\n```\n\n### Exemplo de InteraÃ§Ã£o\n\n```\nðŸ‘¤ UsuÃ¡rio: Bom dia Sofia! O que devo comer no cafÃ© da manhÃ£?\n\nðŸ’š Sofia: Bom dia, amor! ðŸ’š Que alegria falar com vocÃª! \nPara o cafÃ©, que tal ovos mexidos com pÃ£o integral e \numa fruta? Tem proteÃ­na, fibras e energia pro seu dia! âœ¨\n```\n\n---\n\n## ðŸ¥ Dr. Vital - Mentor de SaÃºde\n\n### Identidade\n\n**Nome:** Dr. Vital  \n**Papel:** MÃ©dico virtual especialista do Instituto dos Sonhos  \n**Personalidade:**\n- Profissional e acolhedor\n- Linguagem simples e humana\n- NÃ£o faz diagnÃ³sticos ou prescriÃ§Ãµes\n- OrientaÃ§Ãµes gerais de saÃºde\n\n### Funcionalidades\n\n#### 1. Consulta Virtual\n- AnÃ¡lise completa do paciente\n- OrientaÃ§Ãµes personalizadas\n- IdentificaÃ§Ã£o de padrÃµes\n- SugestÃµes de acompanhamento\n\n#### 2. Dados do Paciente Acessados\n\n```typescript\n// Contexto completo disponÃ­vel\n{\n  // Dados bÃ¡sicos\n  profile: ProfileData,\n  anamnesis: AnamnesisData,\n  physicalData: PhysicalData,\n  \n  // HistÃ³rico e mediÃ§Ãµes\n  weight_trend: WeightMeasurement[],\n  nutrition_tracking: NutritionRecord[],\n  food_analysis: FoodAnalysis[],\n  exercise_history: ExerciseRecord[],\n  water_tracking: WaterRecord[],\n  sleep_tracking: SleepRecord[],\n  mood_tracking: MoodRecord[],\n  \n  // Metas e engajamento\n  all_goals: Goal[],\n  daily_responses: DailyResponse[],\n  missions: Mission[],\n  achievements: Achievement[],\n  \n  // Medicamentos e documentos\n  prescriptions: Prescription[],\n  supplements: Supplement[],\n  medical_documents: MedicalDocument[],\n  \n  // Dispositivos\n  heart_rate_data: HeartRateData[],\n  google_fit_data: GoogleFitData[],\n  \n  // AnÃ¡lises\n  weekly_analyses: WeeklyAnalysis[],\n  \n  // MemÃ³ria\n  long_term_memory: MemorySummary\n}\n```\n\n#### 3. RelatÃ³rios Semanais\n\n```typescript\n// dr-vital-weekly-report\n{\n  period: \"2026-01-01 a 2026-01-07\",\n  weight_analysis: {\n    start: 85.2,\n    end: 84.8,\n    change: -0.4,\n    trend: \"descendo\"\n  },\n  nutrition_score: 78,\n  exercise_days: 5,\n  sleep_average: 7.2,\n  mood_average: 7.5,\n  goals_progress: [\n    { name: \"Perder 5kg\", progress: 40 }\n  ],\n  ai_insights: \"VocÃª estÃ¡ no caminho certo...\"\n}\n```\n\n### Edge Functions\n\n| Function | DescriÃ§Ã£o |\n|----------|-----------|\n| `dr-vital-chat` | Chat principal |\n| `dr-vital-enhanced` | VersÃ£o aprimorada |\n| `dr-vital-weekly-report` | RelatÃ³rios semanais |\n\n### Tabelas Utilizadas\n\n```sql\n-- MemÃ³ria de longo prazo\ndr_vital_memory (\n  user_id, key, value, updated_at\n)\n-- Keys: long_term_summary, allergies, chronic_flags, preferences\n\n-- Conversas\nconversations (\n  user_id, agent, title, last_message_at\n)\n\nconversation_messages (\n  conversation_id, role, content, model\n)\n\n-- AnÃ¡lises semanais\nweekly_analyses (\n  user_id, period, analysis_data, ai_insights\n)\n```\n\n### Exemplo de InteraÃ§Ã£o\n\n```\nðŸ‘¤ UsuÃ¡rio: Como estÃ¡ minha evoluÃ§Ã£o de peso?\n\nðŸ©º Dr. Vital: OlÃ¡! Analisando seus dados dos Ãºltimos 30 dias, \nvejo que vocÃª perdeu 2.1kg, uma mÃ©dia saudÃ¡vel de 0.5kg/semana. \n\nSua composiÃ§Ã£o corporal tambÃ©m melhorou: a gordura corporal \nreduziu de 28% para 26.5%, enquanto a massa muscular se manteve.\n\nContinue focando na hidrataÃ§Ã£o (vocÃª tem tomado em mÃ©dia 1.8L/dia) \ne nos exercÃ­cios - suas 4 sessÃµes semanais estÃ£o fazendo diferenÃ§a!\n\nAlguma dÃºvida sobre seu progresso?\n```\n\n---\n\n## âš™ï¸ ConfiguraÃ§Ã£o de IA\n\n### Tabela ai_configurations\n\n```sql\nCREATE TABLE ai_configurations (\n  id UUID PRIMARY KEY,\n  functionality VARCHAR NOT NULL,  -- 'dr_vital_chat', 'chat_daily', etc.\n  service VARCHAR DEFAULT 'lovable', -- 'lovable', 'openai', 'google'\n  model VARCHAR DEFAULT 'google/gemini-2.5-flash',\n  max_tokens INTEGER DEFAULT 1024,\n  temperature NUMERIC DEFAULT 0.7,\n  system_prompt TEXT,\n  is_enabled BOOLEAN DEFAULT true,\n  priority INTEGER DEFAULT 1,\n  cost_per_request NUMERIC DEFAULT 0.01\n);\n```\n\n### Funcionalidades ConfigurÃ¡veis\n\n| functionality | DescriÃ§Ã£o | Modelo PadrÃ£o |\n|---------------|-----------|---------------|\n| `dr_vital_chat` | Chat Dr. Vital | gemini-2.5-pro |\n| `chat_daily` | Chat Sofia | gemini-2.5-flash |\n| `food_analysis` | AnÃ¡lise de alimentos | gemini-2.5-flash |\n| `image_analysis` | AnÃ¡lise de imagens | gemini-2.5-pro |\n| `weekly_report` | RelatÃ³rios semanais | gemini-2.5-flash |\n\n---\n\n## ðŸ§  Modelos Suportados\n\n### MaxNutrition AI (Principal)\n\n| Modelo | Uso Recomendado | Tokens |\n|--------|-----------------|--------|\n| `google/gemini-2.5-pro` | AnÃ¡lises complexas, imagens | 8192 |\n| `google/gemini-2.5-flash` | Chat rÃ¡pido, respostas curtas | 4096 |\n| `google/gemini-2.5-flash-lite` | ClassificaÃ§Ã£o, resumos | 2048 |\n| `google/gemini-3-pro-preview` | PrÃ³xima geraÃ§Ã£o | 8192 |\n| `openai/gpt-5` | RaciocÃ­nio complexo | 8192 |\n| `openai/gpt-5-mini` | EquilÃ­brio custo/qualidade | 4096 |\n| `openai/gpt-5-nano` | Alta velocidade, tarefas simples | 2048 |\n\n### Fallback Chain\n\n```\nMaxNutrition AI â†’ OpenAI â†’ Google AI â†’ Resposta PadrÃ£o\n```\n\n---\n\n## ðŸ“š Base de Conhecimento\n\n### Protocolos Nutricionais (391 total)\n\n| Categoria | Quantidade |\n|-----------|------------|\n| CombinaÃ§Ãµes visuais | 20 |\n| Sintomas com alimentos | 34 |\n| Estados emocionais | 36 |\n| Atividades fÃ­sicas | 32 |\n| Faixas etÃ¡rias | 14 |\n| Categorias de gÃªnero | 4 |\n| Objetivos fitness | 24 |\n| Alimentos medicinais | 35 |\n| DoenÃ§as com abordagem nutricional | 31 |\n| SubstituiÃ§Ãµes inteligentes | 52 |\n| Funcionalidades avanÃ§adas | 70+ |\n\n### Tabelas de Conhecimento\n\n```sql\n-- Conhecimento da Sofia\nbase_de_conhecimento_sofia (\n  id, categoria, topico, conteudo,\n  referencias, tags, relevancia, is_active\n)\n\n-- Conhecimento da empresa\ncompany_knowledge_base (\n  id, category, title, content,\n  tags, priority, is_active\n)\n\n-- PrincÃ­pios ativos\nactive_principles (\n  id, principle_name, category, description,\n  food_sources, health_benefits, contraindications\n)\n\n-- CombinaÃ§Ãµes ideais\ncombinacoes_ideais (\n  id, alimento_principal, alimento_combinado,\n  beneficio, sinergia_nutricional, referencias_cientificas\n)\n```\n\n---\n\n## ðŸ”„ Fluxo de Dados\n\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚                       COLETA DE DADOS                        â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚                                                              â”‚\nâ”‚  Manual          Dispositivos          AnÃ¡lises             â”‚\nâ”‚  â”Œâ”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚\nâ”‚  â”‚Formsâ”‚         â”‚Google   â”‚          â”‚ Sofia  â”‚            â”‚\nâ”‚  â”‚Dailyâ”‚         â”‚  Fit    â”‚          â”‚ Image  â”‚            â”‚\nâ”‚  â”‚Checkâ”‚         â”‚ Xiaomi  â”‚          â”‚Analysisâ”‚            â”‚\nâ”‚  â””â”€â”€â”¬â”€â”€â”˜         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜            â”‚\nâ”‚     â”‚                 â”‚                    â”‚                 â”‚\nâ””â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n      â”‚                 â”‚                    â”‚\n      â–¼                 â–¼                    â–¼\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚                    BANCO DE DADOS                            â”‚\nâ”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚\nâ”‚  â”‚ profiles, user_anamnesis, weight_measurements,       â”‚   â”‚\nâ”‚  â”‚ nutrition_tracking, food_analysis, exercise_tracking,â”‚   â”‚\nâ”‚  â”‚ sleep_tracking, mood_tracking, google_fit_data, ...  â”‚   â”‚\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                                  â”‚\n                                  â–¼\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚                 PROCESSAMENTO DE IA                          â”‚\nâ”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚\nâ”‚  â”‚            user-complete-context.ts                  â”‚    â”‚\nâ”‚  â”‚  â€¢ Busca dados de 30+ tabelas                       â”‚    â”‚\nâ”‚  â”‚  â€¢ Calcula completude (0-100%)                      â”‚    â”‚\nâ”‚  â”‚  â€¢ Gera resumo contextual                           â”‚    â”‚\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚\nâ”‚                         â–¼                                    â”‚\nâ”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚\nâ”‚  â”‚               System Prompt + Contexto               â”‚    â”‚\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚\nâ”‚                         â–¼                                    â”‚\nâ”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚\nâ”‚  â”‚              MaxNutrition AI Gateway                      â”‚    â”‚\nâ”‚  â”‚  Gemini 2.5 Pro â†’ GPT-5 â†’ Fallback                  â”‚    â”‚\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                          â”‚\n                          â–¼\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚                   RESPOSTA PERSONALIZADA                     â”‚\nâ”‚  â€¢ Baseada em TODOS os dados do usuÃ¡rio                     â”‚\nâ”‚  â€¢ Considera histÃ³rico e tendÃªncias                         â”‚\nâ”‚  â€¢ MemÃ³ria de conversas anteriores                          â”‚\nâ”‚  â€¢ Estilo e tom personalizados                              â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n---\n\n## ðŸ“ˆ MÃ©tricas e Monitoramento\n\n### Logs de Uso\n\n```sql\nai_usage_logs (\n  id, user_id, service_name, model,\n  prompt_tokens, completion_tokens, total_tokens,\n  cost, created_at\n)\n\nai_system_logs (\n  id, user_id, service_name, operation,\n  log_type, status, error_message,\n  execution_time_ms, details\n)\n```\n\n### AnÃ¡lise Emocional\n\n```sql\nchat_emotional_analysis (\n  id, user_id, conversation_id, week_start,\n  emotions_detected, sentiment_score,\n  stress_level, energy_level, pain_level,\n  goals_mentioned, concerns_mentioned\n)\n```\n\n---\n\n*DocumentaÃ§Ã£o gerada em 05/01/2026*\n",
      "sections": [
        "# ðŸ¤– DocumentaÃ§Ã£o dos Sistemas de IA",
        "## ðŸ“‹ Ãndice",
        "## ðŸŽ¯ VisÃ£o Geral",
        "### Arquitetura de IA",
        "## ðŸ’š Sofia - Assistente Nutricional",
        "### Identidade",
        "### Funcionalidades",
        "#### 1. Chat Nutricional",
        "#### 2. AnÃ¡lise de Imagens",
        "#### 3. MemÃ³ria Persistente",
        "### Edge Functions",
        "### Tabelas Utilizadas",
        "### Exemplo de InteraÃ§Ã£o",
        "## ðŸ¥ Dr. Vital - Mentor de SaÃºde",
        "### Identidade",
        "### Funcionalidades",
        "#### 1. Consulta Virtual",
        "#### 2. Dados do Paciente Acessados",
        "#### 3. RelatÃ³rios Semanais",
        "### Edge Functions",
        "### Tabelas Utilizadas",
        "### Exemplo de InteraÃ§Ã£o",
        "## âš™ï¸ ConfiguraÃ§Ã£o de IA",
        "### Tabela ai_configurations",
        "### Funcionalidades ConfigurÃ¡veis",
        "## ðŸ§  Modelos Suportados",
        "### MaxNutrition AI (Principal)",
        "### Fallback Chain",
        "## ðŸ“š Base de Conhecimento",
        "### Protocolos Nutricionais (391 total)",
        "### Tabelas de Conhecimento",
        "## ðŸ”„ Fluxo de Dados",
        "## ðŸ“ˆ MÃ©tricas e Monitoramento",
        "### Logs de Uso",
        "### AnÃ¡lise Emocional"
      ],
      "code_blocks": 28,
      "links": [
        "#visÃ£o-geral",
        "#sofia---assistente-nutricional",
        "#dr-vital---mentor-de-saÃºde",
        "#configuraÃ§Ã£o-de-ia",
        "#modelos-suportados",
        "#base-de-conhecimento"
      ]
    },
    "QUICK_REFERENCE.md": {
      "path": "docs/QUICK_REFERENCE.md",
      "exists": true,
      "lines": 277,
      "size_kb": 7.6396484375,
      "content": "# âš¡ ReferÃªncia RÃ¡pida - MaxNutrition Storage\n\n## ðŸŽ¯ Onde os Dados EstÃ£o Salvos (1 minuto)\n\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚                    MAXNUTRITION STORAGE                     â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n\nðŸŒ SUPABASE CLOUD (99% dos dados)\n   â”œâ”€â”€ ðŸ“Š PostgreSQL: 209 tabelas\n   â”œâ”€â”€ â˜ï¸  Storage: Imagens, PDFs, documentos\n   â””â”€â”€ âš¡ Edge Functions: 73 funÃ§Ãµes serverless\n\nðŸ’» BROWSER (1% dos dados)\n   â”œâ”€â”€ ðŸ’¾ localStorage: 8 keys (preferÃªncias)\n   â”œâ”€â”€ ðŸ”„ sessionStorage: 1 key (temporÃ¡rio)\n   â””â”€â”€ ðŸ“¦ PWA Cache: 3 caches (assets)\n\nðŸ³ DOCKER (Dev apenas)\n   â””â”€â”€ Volumes locais (nÃ£o usado em produÃ§Ã£o)\n```\n\n## ðŸ“Š Top 20 Tabelas Mais Usadas\n\n| # | Tabela | Uso |\n|---|--------|-----|\n| 1 | `profiles` | Perfil do usuÃ¡rio |\n| 2 | `user_physical_data` | Dados fÃ­sicos (altura, peso, IMC) |\n| 3 | `food_analysis` | AnÃ¡lises de alimentos |\n| 4 | `sofia_food_analysis` | AnÃ¡lises da IA Sofia |\n| 5 | `medical_documents` | Documentos mÃ©dicos |\n| 6 | `medical_exam_analyses` | AnÃ¡lises de exames |\n| 7 | `weight_measurements` | MediÃ§Ãµes de peso |\n| 8 | `advanced_daily_tracking` | Tracking diÃ¡rio completo |\n| 9 | `exercise_sessions` | SessÃµes de exercÃ­cio |\n| 10 | `workout_history` | HistÃ³rico de treinos |\n| 11 | `challenges` | Desafios |\n| 12 | `challenge_participations` | ParticipaÃ§Ãµes em desafios |\n| 13 | `user_goals` | Metas do usuÃ¡rio |\n| 14 | `user_sessions` | SessÃµes do usuÃ¡rio |\n| 15 | `daily_responses` | Respostas diÃ¡rias |\n| 16 | `nutrition_tracking` | Tracking nutricional |\n| 17 | `sleep_tracking` | Tracking de sono |\n| 18 | `water_tracking` | Tracking de Ã¡gua |\n| 19 | `mood_tracking` | Tracking de humor |\n| 20 | `user_achievements` | Conquistas |\n\n## ðŸ”‘ localStorage Keys\n\n| Key | Tipo | Uso |\n|-----|------|-----|\n| `maxnutrition_selected_character` | string | Personagem selecionado (Sofia/Dr. Vital) |\n| `user_goals` | JSON | Cache de metas do usuÃ¡rio |\n| `sofia_insights_last_generated` | timestamp | Ãšltima geraÃ§Ã£o de insights |\n| `hasSeenWelcomeModal` | boolean | Flag de modal de boas-vindas |\n| `daily_chest_claimed` | timestamp | Controle de baÃº diÃ¡rio |\n| `voice_config` | JSON | ConfiguraÃ§Ã£o de voz |\n| `emailConfig` | JSON | ConfiguraÃ§Ã£o de email |\n| `n8nConfig` | JSON | ConfiguraÃ§Ã£o n8n |\n\n## â˜ï¸ Storage Buckets\n\n| Bucket | ConteÃºdo | Tamanho TÃ­pico |\n|--------|----------|----------------|\n| `avatars` | Avatares de usuÃ¡rio | 100KB - 500KB |\n| `medical-documents` | Exames, PDFs mÃ©dicos | 500KB - 5MB |\n| `food-images` | Fotos de alimentos | 200KB - 2MB |\n| `profile-photos` | Fotos de perfil | 100KB - 1MB |\n\n## âš¡ Top 10 Edge Functions\n\n| # | Function | Uso |\n|---|----------|-----|\n| 1 | `sofia-image-analysis` | AnÃ¡lise de imagens de alimentos |\n| 2 | `analyze-medical-exam` | AnÃ¡lise de exames mÃ©dicos |\n| 3 | `dr-vital-chat` | Chat com Dr. Vital |\n| 4 | `whatsapp-webhook-unified` | Webhook WhatsApp unificado |\n| 5 | `food-analysis` | AnÃ¡lise de alimentos |\n| 6 | `dr-vital-weekly-report` | RelatÃ³rio semanal |\n| 7 | `whatsapp-ai-assistant` | Assistente WhatsApp |\n| 8 | `nutrition-calc` | CÃ¡lculo nutricional |\n| 9 | `google-fit-sync` | SincronizaÃ§Ã£o Google Fit |\n| 10 | `generate-medical-report` | GeraÃ§Ã£o de relatÃ³rios |\n\n## ðŸ” Comandos Mais Usados\n\n```bash\n# AnÃ¡lise completa\npython3 scripts/analyze-storage.py\n\n# Menu interativo\n./scripts/storage-commands.sh\n\n# Listar Edge Functions\n./scripts/storage-commands.sh functions\n\n# Gerar relatÃ³rio de uso\n./scripts/storage-commands.sh report\n\n# Procurar uso de tabela\ngrep -r \"from('profiles')\" src/\n\n# Ver migrations\nls -lh supabase/migrations/\n\n# Gerar tipos TypeScript\nnpx supabase gen types typescript --local\n```\n\n## ðŸ“ Estrutura de Pastas Importante\n\n```\nprojeto/\nâ”œâ”€â”€ src/\nâ”‚   â”œâ”€â”€ integrations/supabase/\nâ”‚   â”‚   â”œâ”€â”€ client.ts          â† Cliente Supabase (ÃšNICO)\nâ”‚   â”‚   â””â”€â”€ types.ts           â† Tipos (AUTO-GERADO)\nâ”‚   â”œâ”€â”€ hooks/                 â† Hooks customizados\nâ”‚   â”œâ”€â”€ components/            â† Componentes React\nâ”‚   â””â”€â”€ pages/                 â† PÃ¡ginas\nâ”œâ”€â”€ supabase/\nâ”‚   â”œâ”€â”€ functions/             â† Edge Functions (73)\nâ”‚   â””â”€â”€ migrations/            â† Migrations SQL\nâ”œâ”€â”€ docs/\nâ”‚   â”œâ”€â”€ STORAGE_*.md           â† DocumentaÃ§Ã£o de storage\nâ”‚   â””â”€â”€ *.md                   â† Outras docs\nâ””â”€â”€ scripts/\n    â”œâ”€â”€ analyze-storage.py     â† Script de anÃ¡lise\n    â””â”€â”€ storage-commands.sh    â† Comandos Ãºteis\n```\n\n## ðŸš¨ Erros Comuns\n\n| Erro | Causa | SoluÃ§Ã£o |\n|------|-------|---------|\n| `column \"role\" does not exist` | Tentando acessar `profiles.role` | Use `supabase.rpc('is_admin_user')` |\n| `data is not iterable` | Esqueceu que Supabase retorna array | Use `data?.[0]` ou `.single()` |\n| `storage bucket not found` | Bucket nÃ£o existe | Criar bucket no Dashboard |\n| `RLS policy violation` | Sem permissÃ£o | Verificar policies RLS |\n\n## ðŸ” SeguranÃ§a RÃ¡pida\n\n```typescript\n// âœ… CORRETO - Verificar admin\nconst { data: isAdmin } = await supabase.rpc('is_admin_user');\n\n// âœ… CORRETO - Query com RLS\nconst { data } = await supabase\n  .from('profiles')\n  .select('*')\n  .eq('id', userId);\n\n// âœ… CORRETO - Upload com policy\nconst { data } = await supabase.storage\n  .from('avatars')\n  .upload(`${userId}/avatar.png`, file);\n\n// âŒ ERRADO - Sem verificaÃ§Ã£o\nconst { data } = await supabase\n  .from('profiles')\n  .select('*'); // Retorna TODOS os perfis!\n```\n\n## ðŸ“Š Fluxos Principais\n\n### 1. AnÃ¡lise de Alimento (Sofia)\n\n```\nUsuÃ¡rio â†’ Foto â†’ Upload Storage â†’ Edge Function\n  â†“\nYOLO detecta â†’ Gemini refina â†’ Salva no banco\n  â†“\nApp mostra resultado\n```\n\n### 2. AnÃ¡lise de Exame (Dr. Vital)\n\n```\nUsuÃ¡rio â†’ PDF/Imagem â†’ Upload Storage â†’ Edge Function\n  â†“\nYOLO + Gemini analisam â†’ Salva no banco\n  â†“\nApp mostra relatÃ³rio\n```\n\n### 3. Tracking DiÃ¡rio\n\n```\nUsuÃ¡rio â†’ Registra dados â†’ App valida\n  â†“\nSalva no banco â†’ Cache local\n  â†“\nSincroniza em tempo real\n```\n\n## ðŸŽ¯ Checklist DiÃ¡rio\n\n- [ ] Verificar logs de erro\n- [ ] Monitorar uso de Edge Functions\n- [ ] Verificar performance de queries\n\n## ðŸ“š Links RÃ¡pidos\n\n| Preciso de... | VÃ¡ para... |\n|---------------|------------|\n| **VisÃ£o geral** | [STORAGE_SUMMARY.md](STORAGE_SUMMARY.md) |\n| **Detalhes** | [STORAGE_ANALYSIS_REPORT.md](STORAGE_ANALYSIS_REPORT.md) |\n| **Diagramas** | [STORAGE_DIAGRAM.md](STORAGE_DIAGRAM.md) |\n| **Como usar** | [STORAGE_README.md](STORAGE_README.md) |\n| **Ãndice** | [INDEX.md](INDEX.md) |\n\n## ðŸ’¡ Dicas RÃ¡pidas\n\n1. **Sempre use `@/` para imports**\n   ```typescript\n   import { supabase } from '@/integrations/supabase/client';\n   ```\n\n2. **Supabase retorna arrays**\n   ```typescript\n   const { data } = await supabase.from('profiles').select('*');\n   const profile = data?.[0]; // Acesse como array\n   ```\n\n3. **Use .single() quando espera 1 resultado**\n   ```typescript\n   const { data } = await supabase\n     .from('profiles')\n     .select('*')\n     .eq('id', userId)\n     .single(); // Retorna objeto, nÃ£o array\n   ```\n\n4. **YOLO Ã© essencial**\n   - Sempre tente YOLO primeiro\n   - Fallback para Gemini se falhar\n   - 90% mais barato, 10x mais rÃ¡pido\n\n5. **Cache Ã© seu amigo**\n   - localStorage para preferÃªncias\n   - PWA cache para assets\n   - Redis para queries (futuro)\n\n## ðŸ”„ Workflow TÃ­pico\n\n```\n1. Ler documentaÃ§Ã£o (vocÃª estÃ¡ aqui)\n   â†“\n2. Verificar tabela existe (STORAGE_ANALYSIS_REPORT.md)\n   â†“\n3. Implementar cÃ³digo (AI_CODING_GUIDELINES.md)\n   â†“\n4. Testar localmente\n   â†“\n5. Deploy\n   â†“\n6. Monitorar logs\n```\n\n## ðŸ“ž Suporte RÃ¡pido\n\n| Problema | SoluÃ§Ã£o |\n|----------|---------|\n| **NÃ£o sei onde estÃ¡ X** | Execute `python3 scripts/analyze-storage.py` |\n| **Erro de coluna** | Consulte [COMMON_ERRORS.md](COMMON_ERRORS.md) |\n| **Query lenta** | Adicione Ã­ndice, use cache |\n| **Storage cheio** | Limpe arquivos antigos, comprima imagens |\n\n---\n\n**ðŸ’¡ Dica:** Salve esta pÃ¡gina nos favoritos para consulta rÃ¡pida!\n\n**ðŸ“š DocumentaÃ§Ã£o Completa:** [INDEX.md](INDEX.md)\n\n**ðŸ”„ Ãšltima atualizaÃ§Ã£o:** Janeiro 2026\n",
      "sections": [
        "# âš¡ ReferÃªncia RÃ¡pida - MaxNutrition Storage",
        "## ðŸŽ¯ Onde os Dados EstÃ£o Salvos (1 minuto)",
        "## ðŸ“Š Top 20 Tabelas Mais Usadas",
        "## ðŸ”‘ localStorage Keys",
        "## â˜ï¸ Storage Buckets",
        "## âš¡ Top 10 Edge Functions",
        "## ðŸ” Comandos Mais Usados",
        "# AnÃ¡lise completa",
        "# Menu interativo",
        "# Listar Edge Functions",
        "# Gerar relatÃ³rio de uso",
        "# Procurar uso de tabela",
        "# Ver migrations",
        "# Gerar tipos TypeScript",
        "## ðŸ“ Estrutura de Pastas Importante",
        "## ðŸš¨ Erros Comuns",
        "## ðŸ” SeguranÃ§a RÃ¡pida",
        "## ðŸ“Š Fluxos Principais",
        "### 1. AnÃ¡lise de Alimento (Sofia)",
        "### 2. AnÃ¡lise de Exame (Dr. Vital)",
        "### 3. Tracking DiÃ¡rio",
        "## ðŸŽ¯ Checklist DiÃ¡rio",
        "## ðŸ“š Links RÃ¡pidos",
        "## ðŸ’¡ Dicas RÃ¡pidas",
        "## ðŸ”„ Workflow TÃ­pico",
        "## ðŸ“ž Suporte RÃ¡pido"
      ],
      "code_blocks": 22,
      "links": [
        "STORAGE_SUMMARY.md",
        "STORAGE_ANALYSIS_REPORT.md",
        "STORAGE_DIAGRAM.md",
        "STORAGE_README.md",
        "INDEX.md",
        "COMMON_ERRORS.md",
        "INDEX.md"
      ]
    },
    "COMMON_ERRORS.md": {
      "path": "docs/COMMON_ERRORS.md",
      "exists": true,
      "lines": 480,
      "size_kb": 9.2939453125,
      "content": "# ðŸ› Erros Comuns e SoluÃ§Ãµes\n\n> Guia rÃ¡pido para resolver os erros mais frequentes no projeto Instituto dos Sonhos.\n\n---\n\n## ðŸ“ Erros de ImportaÃ§Ã£o\n\n### 1. MÃ³dulo nÃ£o encontrado\n\n```typescript\n// âŒ ERRO\nCannot find module './exercise-database' or its corresponding type declarations\n\n// ðŸ” CAUSA\nNome do arquivo incorreto\n\n// âœ… SOLUÃ‡ÃƒO\n// Verificar nome exato do arquivo\nimport { exercises } from './exercises-database'; // Com 's'\n\n// Nomes comuns que causam confusÃ£o:\n// exercises-database.ts (CORRETO)\n// exercise-database.ts (ERRADO - sem 's')\n```\n\n### 2. Export nÃ£o encontrado\n\n```typescript\n// âŒ ERRO\n'UnifiedTimerProps' is not exported from './UnifiedTimer'\n\n// ðŸ” CAUSA\nInterface sem 'export'\n\n// âœ… SOLUÃ‡ÃƒO\n// No arquivo de origem, adicionar export:\nexport interface UnifiedTimerProps {\n  variant?: 'default' | 'compact';\n}\n```\n\n### 3. Path relativo muito longo\n\n```typescript\n// âŒ ERRO (mÃ¡ prÃ¡tica, pode quebrar)\nimport { Button } from '../../../components/ui/button';\n\n// âœ… SOLUÃ‡ÃƒO\nimport { Button } from '@/components/ui/button';\n```\n\n### 4. Importando cliente Supabase errado\n\n```typescript\n// âŒ ERRO\nimport { createClient } from '@supabase/supabase-js';\nconst supabase = createClient(url, key);\n\n// âœ… SOLUÃ‡ÃƒO\nimport { supabase } from '@/integrations/supabase/client';\n```\n\n---\n\n## ðŸ—ƒï¸ Erros de Banco de Dados\n\n### 5. Coluna nÃ£o existe\n\n```typescript\n// âŒ ERRO\ncolumn \"category\" does not exist\n\n// ðŸ” CAUSA\nNome da coluna incorreto\n\n// âœ… SOLUÃ‡ÃƒO - Mapeamento de colunas corretas:\nchallenges.category        â†’ challenges.challenge_type\nprofiles.role             â†’ Usar RPC is_admin_user\nprofiles.height_cm        â†’ profiles.height\nprofiles.date_of_birth    â†’ profiles.birth_date\nuser_goals.profiles       â†’ Fazer query separada\ndaily_health_tracking     â†’ advanced_daily_tracking\n```\n\n### 6. RelaÃ§Ã£o/Join nÃ£o existe\n\n```typescript\n// âŒ ERRO\nCould not find a relationship between 'user_goals' and 'profiles'\n\n// ðŸ” CAUSA\nTentando fazer join que nÃ£o existe no schema\n\n// âœ… SOLUÃ‡ÃƒO - Fazer queries separadas\n// ERRADO\nconst { data } = await supabase\n  .from('user_goals')\n  .select('*, profiles(*)');\n\n// CORRETO\nconst { data: goals } = await supabase\n  .from('user_goals')\n  .select('*')\n  .eq('user_id', userId);\n\nconst { data: profile } = await supabase\n  .from('profiles')\n  .select('*')\n  .eq('id', userId)\n  .single();\n```\n\n### 7. Acessando array como objeto\n\n```typescript\n// âŒ ERRO\nCannot read property 'altura_cm' of undefined\n// ou\ndata.altura_cm is undefined\n\n// ðŸ” CAUSA\nSupabase select() retorna array, nÃ£o objeto\n\n// âœ… SOLUÃ‡ÃƒO\nconst { data } = await supabase\n  .from('user_physical_data')\n  .select('*');\n\n// ERRADO\nconst altura = data.altura_cm;\n\n// CORRETO\nconst altura = data?.[0]?.altura_cm;\n\n// OU usar .single() quando espera 1 registro\nconst { data } = await supabase\n  .from('user_physical_data')\n  .select('*')\n  .eq('user_id', userId)\n  .single();\n\nconst altura = data?.altura_cm; // Agora Ã© objeto\n```\n\n### 8. VerificaÃ§Ã£o de admin insegura\n\n```typescript\n// âŒ ERRO (inseguro e pode nÃ£o funcionar)\nconst { data } = await supabase\n  .from('profiles')\n  .select('role')\n  .eq('id', userId);\n\nconst isAdmin = data?.[0]?.role === 'admin';\n\n// ðŸ” CAUSA\n1. Coluna 'role' nÃ£o existe em profiles\n2. Mesmo se existisse, seria inseguro (manipulÃ¡vel no frontend)\n\n// âœ… SOLUÃ‡ÃƒO\n// Usar RPC seguro\nconst { data: isAdmin } = await supabase.rpc('is_admin_user');\n\n// Ou hook\nimport { useAdminMode } from '@/hooks/useAdminMode';\nconst { isAdmin, isChecking } = useAdminMode(user);\n```\n\n---\n\n## ðŸ§© Erros de Componentes\n\n### 9. Prop nÃ£o existe\n\n```typescript\n// âŒ ERRO\nProperty 'compact' does not exist on type 'UnifiedTimerProps'\n\n// ðŸ” CAUSA\nUsando props booleanas ao invÃ©s de variants\n\n// âœ… SOLUÃ‡ÃƒO\n// ERRADO\n<UnifiedTimer compact={true} />\n\n// CORRETO\n<UnifiedTimer variant=\"compact\" />\n\n// Interface correta:\ninterface UnifiedTimerProps {\n  variant?: 'default' | 'compact' | 'minimal';\n}\n```\n\n### 10. Classe CSS invÃ¡lida\n\n```typescript\n// âŒ ERRO\nCores nÃ£o seguem o tema, ficam estranhas no dark mode\n\n// ðŸ” CAUSA\nUsando cores hardcoded\n\n// âœ… SOLUÃ‡ÃƒO\n// ERRADO\n<div className=\"bg-white text-black\">\n<div className=\"bg-[#1a1a2e]\">\n\n// CORRETO - Usar tokens semÃ¢nticos\n<div className=\"bg-background text-foreground\">\n<div className=\"bg-card\">\n<div className=\"bg-primary text-primary-foreground\">\n<div className=\"bg-muted text-muted-foreground\">\n```\n\n### 11. cn() nÃ£o importado\n\n```typescript\n// âŒ ERRO\ncn is not defined\n\n// âœ… SOLUÃ‡ÃƒO\nimport { cn } from '@/lib/utils';\n\n<div className={cn(\n  \"base-classes\",\n  isActive && \"active-classes\"\n)}>\n```\n\n---\n\n## ðŸ”Œ Erros de Edge Functions\n\n### 12. CORS Error\n\n```typescript\n// âŒ ERRO\nAccess to fetch has been blocked by CORS policy\n\n// ðŸ” CAUSA\nEdge function sem headers CORS\n\n// âœ… SOLUÃ‡ÃƒO\nconst corsHeaders = {\n  'Access-Control-Allow-Origin': '*',\n  'Access-Control-Allow-Headers': 'authorization, x-client-info, apikey, content-type',\n};\n\nserve(async (req) => {\n  // SEMPRE handle OPTIONS primeiro\n  if (req.method === 'OPTIONS') {\n    return new Response(null, { headers: corsHeaders });\n  }\n\n  // SEMPRE incluir corsHeaders na resposta\n  return new Response(\n    JSON.stringify(data),\n    { headers: { ...corsHeaders, 'Content-Type': 'application/json' } }\n  );\n});\n```\n\n### 13. VariÃ¡vel de ambiente nÃ£o encontrada\n\n```typescript\n// âŒ ERRO\nVITE_SUPABASE_URL is undefined\n\n// ðŸ” CAUSA\nUsando VITE_* em Edge Function (Deno)\n\n// âœ… SOLUÃ‡ÃƒO\n// ERRADO\nconst url = Deno.env.get('VITE_SUPABASE_URL');\n\n// CORRETO\nconst url = Deno.env.get('SUPABASE_URL');\nconst key = Deno.env.get('SUPABASE_SERVICE_ROLE_KEY');\nconst openaiKey = Deno.env.get('OPENAI_API_KEY');\n```\n\n### 14. Import invÃ¡lido em Edge Function\n\n```typescript\n// âŒ ERRO\nModule not found '@/lib/utils'\n\n// ðŸ” CAUSA\nEdge Functions nÃ£o tÃªm acesso ao cÃ³digo de src/\n\n// âœ… SOLUÃ‡ÃƒO\n// ERRADO\nimport { cn } from '@/lib/utils';\nimport { supabase } from '@/integrations/supabase/client';\n\n// CORRETO - Usar esm.sh ou deno.land\nimport { createClient } from 'https://esm.sh/@supabase/supabase-js@2.55.0';\nimport { format } from 'https://esm.sh/date-fns@3.0.0';\n\n// Para cÃ³digo compartilhado, usar _shared/\nimport { corsHeaders } from '../_shared/cors.ts';\n```\n\n---\n\n## ðŸª Erros de Hooks\n\n### 15. Query executando sem dados necessÃ¡rios\n\n```typescript\n// âŒ ERRO\nQuery executa antes do userId estar disponÃ­vel, causando erro\n\n// âœ… SOLUÃ‡ÃƒO - Usar enabled\nconst { data } = useQuery({\n  queryKey: ['user-data', userId],\n  queryFn: async () => {\n    const { data, error } = await supabase\n      .from('profiles')\n      .select('*')\n      .eq('id', userId)\n      .single();\n    \n    if (error) throw error;\n    return data;\n  },\n  enabled: !!userId, // SÃ“ executa quando userId existe\n});\n```\n\n### 16. DependÃªncia faltando no useEffect\n\n```typescript\n// âŒ ERRO\nReact Hook useEffect has a missing dependency: 'userId'\n\n// âœ… SOLUÃ‡ÃƒO\nuseEffect(() => {\n  if (userId) {\n    fetchData();\n  }\n}, [userId]); // Incluir todas dependÃªncias\n```\n\n### 17. Mutation sem invalidaÃ§Ã£o de cache\n\n```typescript\n// âŒ ERRO\nDados nÃ£o atualizam apÃ³s mutation\n\n// âœ… SOLUÃ‡ÃƒO\nconst queryClient = useQueryClient();\n\nconst mutation = useMutation({\n  mutationFn: async (newData) => {\n    await supabase.from('table').insert(newData);\n  },\n  onSuccess: () => {\n    // Invalidar cache para refetch\n    queryClient.invalidateQueries({ queryKey: ['table-data'] });\n  },\n});\n```\n\n---\n\n## ðŸ” Erros de AutenticaÃ§Ã£o\n\n### 18. UsuÃ¡rio nÃ£o autenticado\n\n```typescript\n// âŒ ERRO\nRow level security policy violation\n\n// ðŸ” CAUSA\nTentando acessar dados sem estar logado\n\n// âœ… SOLUÃ‡ÃƒO\nconst { data: { user } } = await supabase.auth.getUser();\n\nif (!user) {\n  // Redirecionar para login ou mostrar erro\n  navigate('/login');\n  return;\n}\n\n// Agora pode fazer operaÃ§Ãµes\nconst { data } = await supabase\n  .from('user_physical_data')\n  .select('*')\n  .eq('user_id', user.id);\n```\n\n### 19. Token expirado\n\n```typescript\n// âŒ ERRO\nJWT expired\n\n// âœ… SOLUÃ‡ÃƒO - Supabase gerencia automaticamente, mas verificar:\nuseEffect(() => {\n  const { data: { subscription } } = supabase.auth.onAuthStateChange(\n    (event, session) => {\n      if (event === 'TOKEN_REFRESHED') {\n        console.log('Token refreshed');\n      }\n      if (event === 'SIGNED_OUT') {\n        navigate('/login');\n      }\n    }\n  );\n\n  return () => subscription.unsubscribe();\n}, []);\n```\n\n---\n\n## ðŸ“Š Erros de TypeScript\n\n### 20. Tipo any implÃ­cito\n\n```typescript\n// âŒ ERRO\nParameter 'data' implicitly has an 'any' type\n\n// âœ… SOLUÃ‡ÃƒO\n// Definir tipos explÃ­citos\ninterface UserData {\n  id: string;\n  name: string;\n  email: string;\n}\n\nconst processData = (data: UserData) => {\n  // ...\n};\n```\n\n### 21. Propriedade pode ser undefined\n\n```typescript\n// âŒ ERRO\nObject is possibly 'undefined'\n\n// âœ… SOLUÃ‡ÃƒO - Usar optional chaining e nullish coalescing\n// ERRADO\nconst name = user.profile.name;\n\n// CORRETO\nconst name = user?.profile?.name ?? 'UsuÃ¡rio';\n\n// Ou com early return\nif (!user?.profile) {\n  return null;\n}\nconst name = user.profile.name;\n```\n\n---\n\n## ðŸŽ¯ Resumo RÃ¡pido\n\n| Erro | SoluÃ§Ã£o RÃ¡pida |\n|------|----------------|\n| Module not found | Verificar nome exato do arquivo |\n| Export not found | Adicionar `export` antes da interface |\n| Column not exist | Consultar `types.ts` ou `DATABASE_QUICK_REF.md` |\n| CORS error | Adicionar corsHeaders em Edge Functions |\n| Array access error | Usar `data?.[0]?.campo` |\n| Admin check fail | Usar `supabase.rpc('is_admin_user')` |\n| Query before data | Adicionar `enabled: !!userId` |\n| Prop not exist | Usar `variant` ao invÃ©s de boolean |\n\n---\n\n*Ãšltima atualizaÃ§Ã£o: Janeiro 2026*\n",
      "sections": [
        "# ðŸ› Erros Comuns e SoluÃ§Ãµes",
        "## ðŸ“ Erros de ImportaÃ§Ã£o",
        "### 1. MÃ³dulo nÃ£o encontrado",
        "### 2. Export nÃ£o encontrado",
        "### 3. Path relativo muito longo",
        "### 4. Importando cliente Supabase errado",
        "## ðŸ—ƒï¸ Erros de Banco de Dados",
        "### 5. Coluna nÃ£o existe",
        "### 6. RelaÃ§Ã£o/Join nÃ£o existe",
        "### 7. Acessando array como objeto",
        "### 8. VerificaÃ§Ã£o de admin insegura",
        "## ðŸ§© Erros de Componentes",
        "### 9. Prop nÃ£o existe",
        "### 10. Classe CSS invÃ¡lida",
        "### 11. cn() nÃ£o importado",
        "## ðŸ”Œ Erros de Edge Functions",
        "### 12. CORS Error",
        "### 13. VariÃ¡vel de ambiente nÃ£o encontrada",
        "### 14. Import invÃ¡lido em Edge Function",
        "## ðŸª Erros de Hooks",
        "### 15. Query executando sem dados necessÃ¡rios",
        "### 16. DependÃªncia faltando no useEffect",
        "### 17. Mutation sem invalidaÃ§Ã£o de cache",
        "## ðŸ” Erros de AutenticaÃ§Ã£o",
        "### 18. UsuÃ¡rio nÃ£o autenticado",
        "### 19. Token expirado",
        "## ðŸ“Š Erros de TypeScript",
        "### 20. Tipo any implÃ­cito",
        "### 21. Propriedade pode ser undefined",
        "## ðŸŽ¯ Resumo RÃ¡pido"
      ],
      "code_blocks": 42,
      "links": []
    },
    "YOLO_INTEGRACAO_COMPLETA.md": {
      "path": "docs/YOLO_INTEGRACAO_COMPLETA.md",
      "exists": true,
      "lines": 521,
      "size_kb": 10.9423828125,
      "content": "# ðŸ¦¾ YOLO - IntegraÃ§Ã£o Completa com Instituto dos Sonhos\n\n> **DocumentaÃ§Ã£o Oficial** | Ãšltima atualizaÃ§Ã£o: Janeiro 2026\n> \n> âš ï¸ **NUNCA DESCONECTAR O YOLO** - Este serviÃ§o Ã© crÃ­tico para reduÃ§Ã£o de custos e qualidade das anÃ¡lises.\n\n---\n\n## ðŸ“Š Resumo Executivo\n\n| Item | Valor |\n|------|-------|\n| **IP da VPS** | `45.67.221.216` |\n| **Porta** | `8002` |\n| **URL Completa** | `http://45.67.221.216:8002` |\n| **Container** | `yolo11-service` |\n| **Modelo** | `yolo11s-seg.pt` |\n| **Ultralytics** | `8.3.252` (atualizado Jan/2026) |\n| **ConfianÃ§a** | `0.35` |\n| **Task** | `segment` |\n\n---\n\n## ðŸŽ¯ O QUE O YOLO FAZ NO APP\n\n### 1. ðŸ½ï¸ AnÃ¡lise de Alimentos (Sofia)\n```\nðŸ“¸ Foto de comida â†’ ðŸ¦¾ YOLO detecta objetos â†’ ðŸ¤– Gemini refina â†’ ðŸ“Š CÃ¡lculos nutricionais\n```\n\n**BenefÃ­cios:**\n- âš¡ **10x mais rÃ¡pido** (YOLO: 0.8s vs Gemini sozinho: 3-8s)\n- ðŸ’° **90% menos custos** (YOLO Ã© local, nÃ£o paga por chamada)\n- ðŸŽ¯ **Maior precisÃ£o** (detecÃ§Ã£o dupla: YOLO + Gemini)\n\n### 2. ðŸ¥ AnÃ¡lise de Exames (Dr. Vital)\n```\nðŸ“¸ Foto de exame â†’ ðŸ¦¾ YOLO detecta texto/tabelas â†’ ðŸ¤– Gemini/GPT interpreta â†’ ðŸ“‹ RelatÃ³rio humanizado\n```\n\n**BenefÃ­cios:**\n- ðŸ“ Detecta Ã¡reas de texto e tabelas\n- ðŸ” Melhora OCR com prÃ©-processamento\n- ðŸ’¡ Contexto visual para o Gemini/GPT\n\n**Status Atual:** âš ï¸ YOLO ainda nÃ£o integrado no Dr. Vital (apenas Sofia)\n\n**PrÃ³ximo Passo:** Adicionar `tryYoloDetect()` na edge function `analyze-medical-exam`\n\n---\n\n## ðŸ”„ FLUXO DETALHADO\n\n### Fluxo Sofia (AnÃ¡lise de Alimentos)\n\n```mermaid\ngraph LR\n    A[ðŸ“¸ UsuÃ¡rio tira foto] --> B[ðŸ¦¾ YOLO VPS]\n    B --> C{Detectou alimentos?}\n    C -->|Sim| D[ðŸ“‹ Lista de objetos]\n    C -->|NÃ£o| E[ðŸ¤– Gemini direto]\n    D --> F[ðŸ¤– Gemini com contexto YOLO]\n    E --> G[ðŸ“Š CÃ¡lculos nutricionais]\n    F --> G\n    G --> H[âœ… Resultado para usuÃ¡rio]\n```\n\n**Edge Function:** `sofia-image-analysis`\n\n```typescript\n// 1. Tenta YOLO primeiro (rÃ¡pido e gratuito)\nconst yoloResult = await tryYoloDetect(imageUrl);\n\n// 2. Se YOLO detectou, envia contexto para Gemini\nif (yoloResult && yoloResult.foods.length > 0) {\n  const prompt = `YOLO detectou: ${yoloResult.foods.join(', ')}. \n                  Analise a imagem e confirme/refine os alimentos.`;\n  // Gemini recebe contexto = resposta mais precisa\n}\n\n// 3. Se YOLO falhou, Gemini analisa sozinho (fallback)\n```\n\n### Fluxo Dr. Vital (AnÃ¡lise de Exames)\n\n```mermaid\ngraph LR\n    A[ðŸ“¸ Upload de exame] --> B[ðŸ¦¾ YOLO VPS]\n    B --> C[ðŸ“‹ Detecta regiÃµes de texto]\n    C --> D[ðŸ¤– Gemini Premium]\n    D --> E[ðŸ“Š AnÃ¡lise humanizada]\n    E --> F[âœ… RelatÃ³rio para paciente]\n```\n\n**Edge Function:** `analyze-medical-exam`\n\n---\n\n## âš™ï¸ CONFIGURAÃ‡ÃƒO\n\n### VariÃ¡veis de Ambiente (Supabase Edge Functions)\n\n```bash\n# OBRIGATÃ“RIAS\nYOLO_ENABLED=true\nYOLO_SERVICE_URL=http://45.67.221.216:8002\n\n# OPCIONAIS (valores padrÃ£o)\nYOLO_CONF=0.35\nYOLO_MAX_RETRIES=3\nYOLO_USE_ADAPTIVE_CONFIDENCE=true\n```\n\n### Como Configurar no Supabase\n\n1. Acesse: https://supabase.com/dashboard/project/hlrkoyywjpckdotimtik\n2. VÃ¡ em **Settings** â†’ **Edge Functions**\n3. Adicione as variÃ¡veis acima\n4. Clique em **Save**\n\n---\n\n## ðŸŒ ENDPOINTS DA API YOLO\n\n### Health Check\n```bash\nGET http://45.67.221.216:8002/health\n\n# Resposta:\n{\n  \"status\": \"ok\",\n  \"model\": \"yolo11s-seg.pt\",\n  \"task\": \"segment\",\n  \"confidence\": 0.35\n}\n```\n\n### DetecÃ§Ã£o de Objetos\n```bash\nPOST http://45.67.221.216:8002/detect\nContent-Type: application/json\n\n{\n  \"image_url\": \"https://exemplo.com/foto.jpg\",\n  \"confidence\": 0.35,\n  \"task\": \"segment\"\n}\n\n# Resposta:\n{\n  \"objects\": [\n    {\n      \"class_name\": \"pizza\",\n      \"score\": 0.85,\n      \"bbox\": [x, y, width, height],\n      \"area_px\": 15000\n    }\n  ],\n  \"model\": \"yolo11s-seg.pt\",\n  \"processing_time\": 0.83\n}\n```\n\n### Classes Suportadas\n```bash\nGET http://45.67.221.216:8002/classes\n```\n\n### Benchmark\n```bash\nGET http://45.67.221.216:8002/benchmark\n```\n\n---\n\n## ðŸ• CLASSES DE ALIMENTOS MAPEADAS\n\nO YOLO detecta 80+ classes COCO, mapeadas para portuguÃªs:\n\n| Classe YOLO | Nome PT-BR |\n|-------------|------------|\n| pizza | pizza |\n| sandwich | sanduÃ­che |\n| hot dog | cachorro-quente |\n| banana | banana |\n| apple | maÃ§Ã£ |\n| orange | laranja |\n| broccoli | brÃ³colis |\n| carrot | cenoura |\n| cake | bolo |\n| donut | rosquinha |\n| cup | copo |\n| bottle | garrafa |\n| bowl | tigela |\n| ... | ... |\n\n**Salgados Brasileiros (mapeamento especial):**\n- `drumstick` â†’ coxinha\n- `meat pie` â†’ torta de carne\n- `empanada` â†’ empada\n- `cheese bread` â†’ pÃ£o de queijo\n\n---\n\n## ðŸ› ï¸ MANUTENÃ‡ÃƒO DA VPS\n\n### Verificar Status\n```bash\nssh root@45.67.221.216\n\n# Ver container\ndocker ps | grep yolo\n\n# Ver logs\ndocker logs yolo11-service --tail 50\n\n# Health check\ncurl http://localhost:8002/health\n```\n\n### Reiniciar ServiÃ§o\n```bash\ndocker restart yolo11-service\n```\n\n### Atualizar Ultralytics\n```bash\n# Dentro do container\ndocker exec yolo11-service pip install --upgrade ultralytics\n\n# Reiniciar para aplicar\ndocker restart yolo11-service\n```\n\n### Verificar VersÃ£o\n```bash\ndocker exec yolo11-service pip show ultralytics | grep Version\n```\n\n---\n\n## ðŸ“ˆ MÃ‰TRICAS DE PERFORMANCE\n\n| MÃ©trica | Valor |\n|---------|-------|\n| Tempo mÃ©dio de resposta | **0.8s** |\n| PrecisÃ£o em alimentos | **85-95%** |\n| Uptime | **99.9%** |\n| Custo por chamada | **R$ 0,00** (local) |\n\n### Comparativo de Custos\n\n| MÃ©todo | Custo por 1000 anÃ¡lises |\n|--------|-------------------------|\n| Gemini sozinho | ~R$ 50,00 |\n| YOLO + Gemini | ~R$ 5,00 |\n| **Economia** | **90%** |\n\n---\n\n## ðŸš¨ TROUBLESHOOTING\n\n### YOLO nÃ£o responde\n```bash\n# 1. Verificar se container estÃ¡ rodando\ndocker ps | grep yolo\n\n# 2. Se nÃ£o estiver, iniciar\ndocker start yolo11-service\n\n# 3. Ver logs de erro\ndocker logs yolo11-service --tail 100\n```\n\n### DetecÃ§Ã£o muito lenta\n```bash\n# Verificar uso de recursos\ndocker stats yolo11-service\n\n# Se memÃ³ria alta, reiniciar\ndocker restart yolo11-service\n```\n\n### Erro de conexÃ£o na Edge Function\n1. Verificar se `YOLO_ENABLED=true`\n2. Verificar se `YOLO_SERVICE_URL` estÃ¡ correto\n3. Testar conectividade: `curl http://45.67.221.216:8002/health`\n\n---\n\n## ðŸ”’ SEGURANÃ‡A\n\n- Container isolado no Docker\n- Acesso apenas via API (porta 8002)\n- Sem dados sensÃ­veis armazenados\n- Logs limitados para performance\n- Firewall configurado na VPS\n\n---\n\n## ðŸ“‹ CHECKLIST DE VERIFICAÃ‡ÃƒO\n\nAntes de qualquer deploy, verificar:\n\n- [ ] YOLO respondendo: `curl http://45.67.221.216:8002/health`\n- [ ] VariÃ¡veis configuradas no Supabase\n- [ ] Edge functions usando YOLO_SERVICE_URL correto\n- [ ] Fallback para Gemini funcionando (se YOLO falhar)\n\n---\n\n## ðŸŽ¯ PARA LOVABLE E CURSOR\n\n### Regras Importantes\n\n1. **NUNCA remover** a integraÃ§Ã£o YOLO das edge functions\n2. **SEMPRE manter** o fallback para Gemini\n3. **NUNCA alterar** a URL do YOLO sem autorizaÃ§Ã£o\n4. **SEMPRE testar** apÃ³s mudanÃ§as nas edge functions\n\n### CÃ³digo de ReferÃªncia\n\n```typescript\n// âœ… CORRETO - Usar YOLO primeiro, Gemini depois\nconst yoloResult = await tryYoloDetect(imageUrl);\nif (yoloResult) {\n  // Usar contexto YOLO no prompt do Gemini\n}\n\n// âŒ ERRADO - Ignorar YOLO\nconst result = await callGeminiDirectly(imageUrl);\n```\n\n### VariÃ¡veis que NUNCA mudar\n\n```bash\nYOLO_SERVICE_URL=http://45.67.221.216:8002  # FIXO\nYOLO_ENABLED=true                            # SEMPRE true em produÃ§Ã£o\n```\n\n---\n\n## ðŸ“ž Suporte\n\nSe o YOLO parar de funcionar:\n\n1. Verificar VPS: `ssh root@45.67.221.216`\n2. Reiniciar container: `docker restart yolo11-service`\n3. Verificar logs: `docker logs yolo11-service`\n4. Se persistir, contatar administrador\n\n---\n\n**ðŸŽ‰ YOLO Ã© essencial para o Instituto dos Sonhos!**\n\nReduz custos, aumenta velocidade e melhora qualidade das anÃ¡lises.\n\n**NUNCA DESCONECTAR!** ðŸš€\n\n\n---\n\n## ðŸ“Š ANÃLISE DO FLUXO ATUAL\n\n### âœ… Sofia (AnÃ¡lise de Alimentos) - YOLO INTEGRADO\n\n```\nEdge Function: sofia-image-analysis\n\nFluxo:\n1. ðŸ“¸ Imagem recebida\n2. ðŸ¦¾ tryYoloDetect(imageUrl) - YOLO primeiro\n3. ðŸ“‹ Se detectou: lista de alimentos\n4. ðŸ¤– Gemini recebe contexto YOLO\n5. ðŸ“Š CÃ¡lculos nutricionais\n6. âœ… Resultado\n\nVariÃ¡veis:\n- YOLO_ENABLED=true (pode ser false para fallback)\n- YOLO_SERVICE_URL=http://45.67.221.216:8002\n```\n\n### âš ï¸ Dr. Vital (AnÃ¡lise de Exames) - YOLO NÃƒO INTEGRADO\n\n```\nEdge Function: analyze-medical-exam\n\nFluxo Atual:\n1. ðŸ“¸ Imagem recebida\n2. ðŸ”„ ConversÃ£o para base64\n3. ðŸ¤– MaxNutrition AI Gateway (Gemini/GPT) direto\n4. ðŸ“‹ RelatÃ³rio humanizado\n\nProblema:\n- NÃ£o usa YOLO para prÃ©-processamento\n- Custo maior (100% via IA paga)\n- Sem detecÃ§Ã£o prÃ©via de regiÃµes de texto\n```\n\n---\n\n## ðŸš€ PLANO DE MELHORIA - Dr. Vital com YOLO\n\n### BenefÃ­cios Esperados\n\n| MÃ©trica | Sem YOLO | Com YOLO |\n|---------|----------|----------|\n| Tempo de resposta | 5-10s | 3-6s |\n| Custo por anÃ¡lise | R$ 0,15 | R$ 0,05 |\n| PrecisÃ£o OCR | 85% | 92% |\n\n### Como YOLO pode ajudar em exames:\n\n1. **DetecÃ§Ã£o de RegiÃµes de Texto**\n   - YOLO detecta onde estÃ£o as tabelas\n   - Gemini foca nessas Ã¡reas\n\n2. **PrÃ©-processamento de Imagem**\n   - Identificar orientaÃ§Ã£o do documento\n   - Detectar se Ã© foto ou scan\n\n3. **ClassificaÃ§Ã£o de Tipo de Exame**\n   - Hemograma vs Lipidograma vs Glicemia\n   - Ajustar prompt especÃ­fico\n\n### ImplementaÃ§Ã£o Sugerida\n\n```typescript\n// Em analyze-medical-exam/index.ts\n\n// 1. Adicionar configuraÃ§Ã£o YOLO\nconst yoloEnabled = (Deno.env.get('YOLO_ENABLED') || 'true').toLowerCase() === 'true';\nconst yoloServiceUrl = Deno.env.get('YOLO_SERVICE_URL') || 'http://45.67.221.216:8002';\n\n// 2. FunÃ§Ã£o para detectar regiÃµes de texto\nasync function tryYoloDetectExam(imageUrl: string): Promise<{\n  hasText: boolean;\n  textRegions: Array<{bbox: number[], confidence: number}>;\n  documentType: string;\n} | null> {\n  if (!yoloEnabled) return null;\n  \n  try {\n    const resp = await fetch(`${yoloServiceUrl}/detect`, {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({ \n        image_url: imageUrl, \n        confidence: 0.3,\n        task: 'detect'\n      })\n    });\n    \n    if (!resp.ok) return null;\n    \n    const data = await resp.json();\n    // Processar detecÃ§Ãµes para identificar texto/tabelas\n    return {\n      hasText: data.objects?.length > 0,\n      textRegions: data.objects || [],\n      documentType: 'exam'\n    };\n  } catch (error) {\n    console.log('âš ï¸ YOLO falhou, continuando sem prÃ©-processamento');\n    return null;\n  }\n}\n\n// 3. Usar no fluxo principal\nconst yoloResult = await tryYoloDetectExam(imageUrl);\nif (yoloResult) {\n  // Adicionar contexto ao prompt\n  systemPrompt += `\\n\\nYOLO detectou ${yoloResult.textRegions.length} regiÃµes de interesse.`;\n}\n```\n\n---\n\n## ðŸ“‹ RESUMO EXECUTIVO\n\n### O que estÃ¡ funcionando:\n- âœ… YOLO VPS rodando (Ultralytics 8.3.252)\n- âœ… Sofia usando YOLO para alimentos\n- âœ… Health check OK\n- âœ… DetecÃ§Ã£o em ~0.8s\n\n### O que precisa melhorar:\n- âš ï¸ Dr. Vital nÃ£o usa YOLO ainda\n- âš ï¸ DocumentaÃ§Ã£o precisa ser mantida atualizada\n\n### PrÃ³ximos passos:\n1. Integrar YOLO no `analyze-medical-exam`\n2. Treinar modelo customizado para exames brasileiros\n3. Adicionar cache de detecÃ§Ãµes\n\n---\n\n## ðŸ“ž Contatos e Suporte\n\n**VPS YOLO:**\n- IP: 45.67.221.216\n- Porta: 8002\n- Container: yolo11-service\n\n**Comandos de emergÃªncia:**\n```bash\n# Verificar status\ncurl http://45.67.221.216:8002/health\n\n# Reiniciar\nssh root@45.67.221.216 \"docker restart yolo11-service\"\n\n# Ver logs\nssh root@45.67.221.216 \"docker logs yolo11-service --tail 50\"\n```\n\n---\n\n*DocumentaÃ§Ã£o gerada em Janeiro 2026*\n*VersÃ£o: 2.1.0*\n",
      "sections": [
        "# ðŸ¦¾ YOLO - IntegraÃ§Ã£o Completa com Instituto dos Sonhos",
        "## ðŸ“Š Resumo Executivo",
        "## ðŸŽ¯ O QUE O YOLO FAZ NO APP",
        "### 1. ðŸ½ï¸ AnÃ¡lise de Alimentos (Sofia)",
        "### 2. ðŸ¥ AnÃ¡lise de Exames (Dr. Vital)",
        "## ðŸ”„ FLUXO DETALHADO",
        "### Fluxo Sofia (AnÃ¡lise de Alimentos)",
        "### Fluxo Dr. Vital (AnÃ¡lise de Exames)",
        "## âš™ï¸ CONFIGURAÃ‡ÃƒO",
        "### VariÃ¡veis de Ambiente (Supabase Edge Functions)",
        "# OBRIGATÃ“RIAS",
        "# OPCIONAIS (valores padrÃ£o)",
        "### Como Configurar no Supabase",
        "## ðŸŒ ENDPOINTS DA API YOLO",
        "### Health Check",
        "# Resposta:",
        "### DetecÃ§Ã£o de Objetos",
        "# Resposta:",
        "### Classes Suportadas",
        "### Benchmark",
        "## ðŸ• CLASSES DE ALIMENTOS MAPEADAS",
        "## ðŸ› ï¸ MANUTENÃ‡ÃƒO DA VPS",
        "### Verificar Status",
        "# Ver container",
        "# Ver logs",
        "# Health check",
        "### Reiniciar ServiÃ§o",
        "### Atualizar Ultralytics",
        "# Dentro do container",
        "# Reiniciar para aplicar",
        "### Verificar VersÃ£o",
        "## ðŸ“ˆ MÃ‰TRICAS DE PERFORMANCE",
        "### Comparativo de Custos",
        "## ðŸš¨ TROUBLESHOOTING",
        "### YOLO nÃ£o responde",
        "# 1. Verificar se container estÃ¡ rodando",
        "# 2. Se nÃ£o estiver, iniciar",
        "# 3. Ver logs de erro",
        "### DetecÃ§Ã£o muito lenta",
        "# Verificar uso de recursos",
        "# Se memÃ³ria alta, reiniciar",
        "### Erro de conexÃ£o na Edge Function",
        "## ðŸ”’ SEGURANÃ‡A",
        "## ðŸ“‹ CHECKLIST DE VERIFICAÃ‡ÃƒO",
        "## ðŸŽ¯ PARA LOVABLE E CURSOR",
        "### Regras Importantes",
        "### CÃ³digo de ReferÃªncia",
        "### VariÃ¡veis que NUNCA mudar",
        "## ðŸ“ž Suporte",
        "## ðŸ“Š ANÃLISE DO FLUXO ATUAL",
        "### âœ… Sofia (AnÃ¡lise de Alimentos) - YOLO INTEGRADO",
        "### âš ï¸ Dr. Vital (AnÃ¡lise de Exames) - YOLO NÃƒO INTEGRADO",
        "## ðŸš€ PLANO DE MELHORIA - Dr. Vital com YOLO",
        "### BenefÃ­cios Esperados",
        "### Como YOLO pode ajudar em exames:",
        "### ImplementaÃ§Ã£o Sugerida",
        "## ðŸ“‹ RESUMO EXECUTIVO",
        "### O que estÃ¡ funcionando:",
        "### O que precisa melhorar:",
        "### PrÃ³ximos passos:",
        "## ðŸ“ž Contatos e Suporte",
        "# Verificar status",
        "# Reiniciar",
        "# Ver logs"
      ],
      "code_blocks": 44,
      "links": []
    }
  },
  "summary": {
    "total_documents_analyzed": 16,
    "total_lines_of_documentation": 9244,
    "total_size_kb": 220.31640625,
    "documents_by_priority": {
      "high": [
        "01_ESTRUTURA_PROJETO.md",
        "02_DATABASE_SCHEMA.md",
        "03_COMPONENTS_CATALOG.md",
        "05_EDGE_FUNCTIONS.md",
        "07_AI_SYSTEMS.md",
        "DATABASE_SCHEMA.md",
        "AI_SYSTEMS.md"
      ],
      "medium": [
        "04_HOOKS_REFERENCE.md",
        "06_NAVIGATION_FLOWS.md",
        "08_GAMIFICATION.md"
      ],
      "low": [
        "09_ENVIRONMENT_VARS.md",
        "10_DEPLOY_GUIDE.md",
        "ARCHITECTURE.md",
        "QUICK_REFERENCE.md",
        "COMMON_ERRORS.md",
        "YOLO_INTEGRACAO_COMPLETA.md"
      ]
    },
    "key_findings": {
      "total_tables": 0,
      "total_rpcs": 0,
      "total_components": 14,
      "total_hooks": 46,
      "total_edge_functions": 1
    }
  },
  "structure": {
    "folders": [
      "â”œâ”€â”€ ðŸ“ src/                           # CÃ³digo fonte principal",
      "â”‚   â”œâ”€â”€ ðŸ“ components/                # Componentes React (742)",
      "â”‚   â”œâ”€â”€ ðŸ“ hooks/                     # Hooks customizados (165)",
      "## ðŸ“ src/components/ - Componentes React",
      "src/components/",
      "## ðŸ“ src/hooks/ - Hooks Customizados",
      "src/hooks/",
      "## ðŸ“ src/pages/ - PÃ¡ginas da AplicaÃ§Ã£o",
      "src/pages/",
      "content: [\"./index.html\", \"./src/**/*.{ts,tsx}\"],",
      "â”‚   src/pages/    â”‚ â† PÃ¡ginas da aplicaÃ§Ã£o",
      "â”‚ src/components/ â”‚ â† Componentes React",
      "â”‚   src/hooks/    â”‚ â† LÃ³gica de negÃ³cio"
    ],
    "key_directories": [],
    "file_patterns": []
  },
  "database": {
    "tables": [],
    "rpcs": [],
    "policies": []
  },
  "components": {
    "ui_components": [
      "CardContent",
      "DialogContent",
      "DialogTitle",
      "CardHeader",
      "HTMLButtonElement",
      "DialogHeader",
      "LevelProgress",
      "Card",
      "CardDescription",
      "Button",
      "CardTitle",
      "DialogTrigger",
      "Dialog",
      "SofiaChat"
    ],
    "feature_components": [],
    "total_count": 14
  },
  "hooks": {
    "custom_hooks": [
      "useSwipeGesture",
      "useGamificationUnified",
      "useIsMobile",
      "useRealRanking",
      "useHealthData",
      "useExerciseProgress",
      "useFeedPosts",
      "useAdminMode",
      "useCallback",
      "useUserStreak",
      "useTrackingData",
      "useExerciseLibrary",
      "useDirectMessages",
      "useMediaUpload",
      "useState",
      "useAdminPermissions",
      "useNutritionData",
      "useAuth",
      "useHaptics",
      "useChallenges",
      "useFlashChallenge",
      "useUserProfile",
      "useLongPress",
      "useSofiaAnalysis",
      "useDailyMissions",
      "useDebouncedState",
      "useExamAccess",
      "useReducedMotion",
      "useToast",
      "useMutation",
      "useHealthScore",
      "useMealPlanHistory",
      "useDrVital",
      "useGoogleFitData",
      "useExercisesLibrary",
      "useFoodHistory",
      "useExerciseProgram",
      "useNetworkStatus",
      "useMyHook",
      "useCamera",
      "useUserPoints",
      "useEffect",
      "useFollow",
      "useQuery",
      "useUserXP",
      "useStories"
    ],
    "categories": []
  },
  "edge_functions": {
    "functions": [
      "// supabase/functions/my-function/index.ts"
    ],
    "endpoints": []
  },
  "navigation": {},
  "ai_systems": {},
  "gamification": {},
  "environment": {},
  "deployment": {}
}